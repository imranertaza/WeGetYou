/*! v6.35.0-SNAPSHOT - 2021-05-17 17:05:17 */
function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){"use strict";var T,e,t,a,r,i,o,n,s,A=function(e,l){if(!(this instanceof A))return new A(e,l);var t={direction:"horizontal",touchEventsTarget:"container",initialSlide:0,speed:300,autoplay:!1,autoplayDisableOnInteraction:!0,autoplayStopOnLast:!1,iOSEdgeSwipeDetection:!1,iOSEdgeSwipeThreshold:20,freeMode:!1,freeModeMomentum:!0,freeModeMomentumRatio:1,freeModeMomentumBounce:!0,freeModeMomentumBounceRatio:1,freeModeMomentumVelocityRatio:1,freeModeSticky:!1,freeModeMinimumVelocity:.02,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",coverflow:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},flip:{slideShadows:!0,limitRotation:!0},cube:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94},fade:{crossFade:!1},parallax:!1,zoom:!1,zoomMax:3,zoomMin:1,zoomToggle:!0,scrollbar:null,scrollbarHide:!0,scrollbarDraggable:!1,scrollbarSnapOnRelease:!1,keyboardControl:!1,mousewheelControl:!1,mousewheelReleaseOnEdges:!1,mousewheelInvert:!1,mousewheelForceToAxis:!1,mousewheelSensitivity:1,mousewheelEventsTarged:"container",hashnav:!1,hashnavWatchState:!1,history:!1,replaceState:!1,breakpoints:void 0,spaceBetween:0,slidesPerView:1,slidesPerColumn:1,slidesPerColumnFill:"column",slidesPerGroup:1,centeredSlides:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,onlyExternal:!1,threshold:0,touchMoveStopPropagation:!0,touchReleaseOnEdges:!1,uniqueNavElements:!0,pagination:null,paginationElement:"span",paginationClickable:!1,paginationHide:!1,paginationBulletRender:null,paginationProgressRender:null,paginationFractionRender:null,paginationCustomRender:null,paginationType:"bullets",resistance:!0,resistanceRatio:.85,nextButton:null,prevButton:null,watchSlidesProgress:!1,watchSlidesVisibility:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,lazyLoading:!1,lazyLoadingInPrevNext:!1,lazyLoadingInPrevNextAmount:1,lazyLoadingOnTransitionStart:!1,preloadImages:!0,updateOnImagesReady:!0,loop:!1,loopAdditionalSlides:0,loopedSlides:null,control:void 0,controlInverse:!1,controlBy:"slide",normalizeSlideIndex:!0,allowSwipeToPrev:!0,allowSwipeToNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",passiveListeners:!0,containerModifierClass:"swiper-container-",slideClass:"swiper-slide",slideActiveClass:"swiper-slide-active",slideDuplicateActiveClass:"swiper-slide-duplicate-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",slideNextClass:"swiper-slide-next",slideDuplicateNextClass:"swiper-slide-duplicate-next",slidePrevClass:"swiper-slide-prev",slideDuplicatePrevClass:"swiper-slide-duplicate-prev",wrapperClass:"swiper-wrapper",bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active",buttonDisabledClass:"swiper-button-disabled",paginationCurrentClass:"swiper-pagination-current",paginationTotalClass:"swiper-pagination-total",paginationHiddenClass:"swiper-pagination-hidden",paginationProgressbarClass:"swiper-pagination-progressbar",paginationClickableClass:"swiper-pagination-clickable",paginationModifierClass:"swiper-pagination-",lazyLoadingClass:"swiper-lazy",lazyStatusLoadingClass:"swiper-lazy-loading",lazyStatusLoadedClass:"swiper-lazy-loaded",lazyPreloaderClass:"swiper-lazy-preloader",notificationClass:"swiper-notification",preloaderClass:"preloader",zoomContainerClass:"swiper-zoom-container",observer:!1,observeParents:!1,a11y:!1,prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",paginationBulletMessage:"Go to slide {{index}}",runCallbacksOnInit:!0};l&&l.virtualTranslate;l=l||{};var a={};for(var r in l)if("object"!=typeof l[r]||null===l[r]||(l[r].nodeType||l[r]===window||l[r]===document||"undefined"!=typeof Dom7&&l[r]instanceof Dom7||"undefined"!=typeof jQuery&&l[r]instanceof jQuery))a[r]=l[r];else for(var i in a[r]={},l[r])a[r][i]=l[r][i];for(var o in t)if(void 0===l[o])l[o]=t[o];else if("object"==typeof l[o])for(var n in t[o])void 0===l[o][n]&&(l[o][n]=t[o][n]);var w=this;if(w.params=l,w.originalParams=a,w.classNames=[],void 0!==T&&"undefined"!=typeof Dom7&&(T=Dom7),(void 0!==T||(T="undefined"==typeof Dom7?window.Dom7||window.Zepto||window.jQuery:Dom7))&&(w.$=T,w.currentBreakpoint=void 0,w.getActiveBreakpoint=function(){if(!w.params.breakpoints)return!1;var e,t=!1,a=[];for(e in w.params.breakpoints)w.params.breakpoints.hasOwnProperty(e)&&a.push(e);a.sort(function(e,t){return parseInt(e,10)>parseInt(t,10)});for(var r=0;r<a.length;r++)(e=a[r])>=window.innerWidth&&!t&&(t=e);return t||"max"},w.setBreakpoint=function(){var e=w.getActiveBreakpoint();if(e&&w.currentBreakpoint!==e){var t=e in w.params.breakpoints?w.params.breakpoints[e]:w.originalParams,a=w.params.loop&&t.slidesPerView!==w.params.slidesPerView;for(var r in t)w.params[r]=t[r];w.currentBreakpoint=e,a&&w.destroyLoop&&w.reLoop(!0)}},w.params.breakpoints&&w.setBreakpoint(),w.container=T(e),0!==w.container.length)){if(1<w.container.length){var s=[];return w.container.each(function(){s.push(new A(this,l))}),s}(w.container[0].swiper=w).container.data("swiper",w),w.classNames.push(w.params.containerModifierClass+w.params.direction),w.params.freeMode&&w.classNames.push(w.params.containerModifierClass+"free-mode"),w.support.flexbox||(w.classNames.push(w.params.containerModifierClass+"no-flexbox"),w.params.slidesPerColumn=1),w.params.autoHeight&&w.classNames.push(w.params.containerModifierClass+"autoheight"),(w.params.parallax||w.params.watchSlidesVisibility)&&(w.params.watchSlidesProgress=!0),w.params.touchReleaseOnEdges&&(w.params.resistanceRatio=0),"slide"!==w.params.effect&&w.classNames.push(w.params.containerModifierClass+w.params.effect),w.params.grabCursor&&w.support.touch&&(w.params.grabCursor=!1),w.wrapper=w.container.children("."+w.params.wrapperClass),w.params.pagination&&(w.paginationContainer=T(w.params.pagination),w.params.uniqueNavElements&&"string"==typeof w.params.pagination&&1<w.paginationContainer.length&&1===w.container.find(w.params.pagination).length&&(w.paginationContainer=w.container.find(w.params.pagination)),"bullets"===w.params.paginationType&&w.params.paginationClickable?w.paginationContainer.addClass(w.params.paginationModifierClass+"clickable"):w.params.paginationClickable=!1,w.paginationContainer.addClass(w.params.paginationModifierClass+w.params.paginationType)),(w.params.nextButton||w.params.prevButton)&&(w.params.nextButton&&(w.nextButton=T(w.params.nextButton),w.params.uniqueNavElements&&"string"==typeof w.params.nextButton&&1<w.nextButton.length&&1===w.container.find(w.params.nextButton).length&&(w.nextButton=w.container.find(w.params.nextButton))),w.params.prevButton&&(w.prevButton=T(w.params.prevButton),w.params.uniqueNavElements&&"string"==typeof w.params.prevButton&&1<w.prevButton.length&&1===w.container.find(w.params.prevButton).length&&(w.prevButton=w.container.find(w.params.prevButton)))),w.isHorizontal=function(){return"horizontal"===w.params.direction},w.rtl=w.isHorizontal()&&("rtl"===w.container[0].dir.toLowerCase()||"rtl"===w.container.css("direction")),w.rtl&&w.classNames.push(w.params.containerModifierClass+"rtl"),w.rtl&&(w.wrongRTL="-webkit-box"===w.wrapper.css("display")),1<w.params.slidesPerColumn&&w.classNames.push(w.params.containerModifierClass+"multirow"),w.device.android&&w.classNames.push(w.params.containerModifierClass+"android"),w.container.addClass(w.classNames.join(" ")),w.translate=0,w.progress=0,w.velocity=0,w.lockSwipeToNext=function(){(w.params.allowSwipeToNext=!1)===w.params.allowSwipeToPrev&&w.params.grabCursor&&w.unsetGrabCursor()},w.lockSwipeToPrev=function(){(w.params.allowSwipeToPrev=!1)===w.params.allowSwipeToNext&&w.params.grabCursor&&w.unsetGrabCursor()},w.lockSwipes=function(){w.params.allowSwipeToNext=w.params.allowSwipeToPrev=!1,w.params.grabCursor&&w.unsetGrabCursor()},w.unlockSwipeToNext=function(){(w.params.allowSwipeToNext=!0)===w.params.allowSwipeToPrev&&w.params.grabCursor&&w.setGrabCursor()},w.unlockSwipeToPrev=function(){(w.params.allowSwipeToPrev=!0)===w.params.allowSwipeToNext&&w.params.grabCursor&&w.setGrabCursor()},w.unlockSwipes=function(){w.params.allowSwipeToNext=w.params.allowSwipeToPrev=!0,w.params.grabCursor&&w.setGrabCursor()},w.setGrabCursor=function(e){w.container[0].style.cursor="move",w.container[0].style.cursor=e?"-webkit-grabbing":"-webkit-grab",w.container[0].style.cursor=e?"-moz-grabbin":"-moz-grab",w.container[0].style.cursor=e?"grabbing":"grab"},w.unsetGrabCursor=function(){w.container[0].style.cursor=""},w.params.grabCursor&&w.setGrabCursor(),w.imagesToLoad=[],w.imagesLoaded=0,w.loadImage=function(e,t,a,r,i,o){},w.preloadImages=function(){},w.autoplayTimeoutId=void 0,w.autoplaying=!1,w.autoplayPaused=!1,w.startAutoplay=function(){},w.stopAutoplay=function(e){},w.pauseAutoplay=function(e){},w.minTranslate=function(){return-w.snapGrid[0]},w.maxTranslate=function(){return-w.snapGrid[w.snapGrid.length-1]},w.updateAutoHeight=function(){},w.updateContainerSize=function(){var e,t;e=void 0!==w.params.width?w.params.width:w.container[0].clientWidth,t=void 0!==w.params.height?w.params.height:w.container[0].clientHeight,0===e&&w.isHorizontal()||0===t&&!w.isHorizontal()||(e=e-parseInt(w.container.css("padding-left"),10)-parseInt(w.container.css("padding-right"),10),t=t-parseInt(w.container.css("padding-top"),10)-parseInt(w.container.css("padding-bottom"),10),w.width=e,w.height=t,w.size=w.isHorizontal()?w.width:w.height)},w.updateSlidesSize=function(){w.slides=w.wrapper.children("."+w.params.slideClass),w.snapGrid=[],w.slidesGrid=[],w.slidesSizesGrid=[];var e,t=w.params.spaceBetween,a=-w.params.slidesOffsetBefore,r=0,i=0;if(void 0!==w.size){var o,n;"string"==typeof t&&0<=t.indexOf("%")&&(t=parseFloat(t.replace("%",""))/100*w.size),w.virtualSize=-t,w.rtl?w.slides.css({marginLeft:"",marginTop:""}):w.slides.css({marginRight:"",marginBottom:""}),1<w.params.slidesPerColumn&&(o=Math.floor(w.slides.length/w.params.slidesPerColumn)===w.slides.length/w.params.slidesPerColumn?w.slides.length:Math.ceil(w.slides.length/w.params.slidesPerColumn)*w.params.slidesPerColumn,"auto"!==w.params.slidesPerView&&"row"===w.params.slidesPerColumnFill&&(o=Math.max(o,w.params.slidesPerView*w.params.slidesPerColumn)));var s,l=w.params.slidesPerColumn,d=o/l,c=d-(w.params.slidesPerColumn*d-w.slides.length);for(e=0;e<w.slides.length;e++){n=0;var p,u,f,h=w.slides.eq(e);if(1<w.params.slidesPerColumn)"column"===w.params.slidesPerColumnFill?(f=e-(u=Math.floor(e/l))*l,(c<u||u===c&&f===l-1)&&++f>=l&&(f=0,u++),p=u+f*o/l,h.css({"-webkit-box-ordinal-group":p,"-moz-box-ordinal-group":p,"-ms-flex-order":p,"-webkit-order":p,order:p})):u=e-(f=Math.floor(e/d))*d,h.css("margin-"+(w.isHorizontal()?"top":"left"),0!==f&&w.params.spaceBetween&&w.params.spaceBetween+"px").attr("data-swiper-column",u).attr("data-swiper-row",f);"none"!==h.css("display")&&("auto"===w.params.slidesPerView?(n=w.isHorizontal()?h.outerWidth(!0):h.outerHeight(!0),w.params.roundLengths&&(n=g(n))):(n=(w.size-(w.params.slidesPerView-1)*t)/w.params.slidesPerView,w.params.roundLengths&&(n=g(n)),w.isHorizontal()?w.slides[e].style.width=n+"px":w.slides[e].style.height=n+"px"),w.slides[e].swiperSlideSize=n,w.slidesSizesGrid.push(n),w.params.centeredSlides?(a=a+n/2+r/2+t,0===r&&0!==e&&(a=a-w.size/2-t),0===e&&(a=a-w.size/2-t),Math.abs(a)<.001&&(a=0),i%w.params.slidesPerGroup==0&&w.snapGrid.push(a),w.slidesGrid.push(a)):(i%w.params.slidesPerGroup==0&&w.snapGrid.push(a),w.slidesGrid.push(a),a=a+n+t),w.virtualSize+=n+t,r=n,i++)}if(w.virtualSize=Math.max(w.virtualSize,w.size)+w.params.slidesOffsetAfter,w.rtl&&w.wrongRTL&&("slide"===w.params.effect||"coverflow"===w.params.effect)&&w.wrapper.css({width:w.virtualSize+w.params.spaceBetween+"px"}),w.support.flexbox&&!w.params.setWrapperSize||(w.isHorizontal()?w.wrapper.css({width:w.virtualSize+w.params.spaceBetween+"px"}):w.wrapper.css({height:w.virtualSize+w.params.spaceBetween+"px"})),1<w.params.slidesPerColumn&&(w.virtualSize=(n+w.params.spaceBetween)*o,w.virtualSize=Math.ceil(w.virtualSize/w.params.slidesPerColumn)-w.params.spaceBetween,w.isHorizontal()?w.wrapper.css({width:w.virtualSize+w.params.spaceBetween+"px"}):w.wrapper.css({height:w.virtualSize+w.params.spaceBetween+"px"}),w.params.centeredSlides)){for(s=[],e=0;e<w.snapGrid.length;e++)w.snapGrid[e]<w.virtualSize+w.snapGrid[0]&&s.push(w.snapGrid[e]);w.snapGrid=s}if(!w.params.centeredSlides){for(s=[],e=0;e<w.snapGrid.length;e++)w.snapGrid[e]<=w.virtualSize-w.size&&s.push(w.snapGrid[e]);w.snapGrid=s,1<Math.floor(w.virtualSize-w.size)-Math.floor(w.snapGrid[w.snapGrid.length-1])&&w.snapGrid.push(w.virtualSize-w.size)}0===w.snapGrid.length&&(w.snapGrid=[0]),0!==w.params.spaceBetween&&(w.isHorizontal()?w.rtl?w.slides.css({marginLeft:t+"px"}):w.slides.css({marginRight:t+"px"}):w.slides.css({marginBottom:t+"px"})),w.params.watchSlidesProgress&&w.updateSlidesOffset()}},w.updateSlidesOffset=function(){for(var e=0;e<w.slides.length;e++)w.slides[e].swiperSlideOffset=w.isHorizontal()?w.slides[e].offsetLeft:w.slides[e].offsetTop},w.currentSlidesPerView=function(){var e,t,a=1;if(w.params.centeredSlides){var r,i=w.slides[w.activeIndex].swiperSlideSize;for(e=w.activeIndex+1;e<w.slides.length;e++)w.slides[e]&&!r&&(a++,(i+=w.slides[e].swiperSlideSize)>w.size&&(r=!0));for(t=w.activeIndex-1;0<=t;t--)w.slides[t]&&!r&&(a++,(i+=w.slides[t].swiperSlideSize)>w.size&&(r=!0))}else for(e=w.activeIndex+1;e<w.slides.length;e++)w.slidesGrid[e]-w.slidesGrid[w.activeIndex]<w.size&&a++;return a},w.updateSlidesProgress=function(e){if(void 0===e&&(e=w.translate||0),0!==w.slides.length){void 0===w.slides[0].swiperSlideOffset&&w.updateSlidesOffset();var t=-e;w.rtl&&(t=e),w.slides.removeClass(w.params.slideVisibleClass);for(var a=0;a<w.slides.length;a++){var r=w.slides[a],i=(t+(w.params.centeredSlides?w.minTranslate():0)-r.swiperSlideOffset)/(r.swiperSlideSize+w.params.spaceBetween);if(w.params.watchSlidesVisibility){var o=-(t-r.swiperSlideOffset),n=o+w.slidesSizesGrid[a];(0<=o&&o<w.size||0<n&&n<=w.size||o<=0&&n>=w.size)&&w.slides.eq(a).addClass(w.params.slideVisibleClass)}r.progress=w.rtl?-i:i}}},w.updateProgress=function(e){void 0===e&&(e=w.translate||0);var t=w.maxTranslate()-w.minTranslate(),a=w.isBeginning,r=w.isEnd;0===t?(w.progress=0,w.isBeginning=w.isEnd=!0):(w.progress=(e-w.minTranslate())/t,w.isBeginning=w.progress<=0,w.isEnd=1<=w.progress),w.isBeginning&&!a&&w.emit("onReachBeginning",w),w.isEnd&&!r&&w.emit("onReachEnd",w),w.params.watchSlidesProgress&&w.updateSlidesProgress(e),w.emit("onProgress",w,w.progress)},w.updateActiveIndex=function(){var e,t,a,r=w.rtl?w.translate:-w.translate;for(t=0;t<w.slidesGrid.length;t++)void 0!==w.slidesGrid[t+1]?r>=w.slidesGrid[t]&&r<w.slidesGrid[t+1]-(w.slidesGrid[t+1]-w.slidesGrid[t])/2?e=t:r>=w.slidesGrid[t]&&r<w.slidesGrid[t+1]&&(e=t+1):r>=w.slidesGrid[t]&&(e=t);w.params.normalizeSlideIndex&&(e<0||void 0===e)&&(e=0),(a=Math.floor(e/w.params.slidesPerGroup))>=w.snapGrid.length&&(a=w.snapGrid.length-1),e!==w.activeIndex&&(w.snapIndex=a,w.previousIndex=w.activeIndex,w.activeIndex=e,w.updateClasses(),w.updateRealIndex())},w.updateRealIndex=function(){w.realIndex=parseInt(w.slides.eq(w.activeIndex).attr("data-swiper-slide-index")||w.activeIndex,10)},w.updateClasses=function(){w.slides.removeClass(w.params.slideActiveClass+" "+w.params.slideNextClass+" "+w.params.slidePrevClass+" "+w.params.slideDuplicateActiveClass+" "+w.params.slideDuplicateNextClass+" "+w.params.slideDuplicatePrevClass);var e=w.slides.eq(w.activeIndex);e.addClass(w.params.slideActiveClass),l.loop&&(e.hasClass(w.params.slideDuplicateClass)?w.wrapper.children("."+w.params.slideClass+":not(."+w.params.slideDuplicateClass+')[data-swiper-slide-index="'+w.realIndex+'"]').addClass(w.params.slideDuplicateActiveClass):w.wrapper.children("."+w.params.slideClass+"."+w.params.slideDuplicateClass+'[data-swiper-slide-index="'+w.realIndex+'"]').addClass(w.params.slideDuplicateActiveClass));var t=e.next("."+w.params.slideClass).addClass(w.params.slideNextClass);w.params.loop&&0===t.length&&(t=w.slides.eq(0)).addClass(w.params.slideNextClass);var a=e.prev("."+w.params.slideClass).addClass(w.params.slidePrevClass);if(w.params.loop&&0===a.length&&(a=w.slides.eq(-1)).addClass(w.params.slidePrevClass),l.loop&&(t.hasClass(w.params.slideDuplicateClass)?w.wrapper.children("."+w.params.slideClass+":not(."+w.params.slideDuplicateClass+')[data-swiper-slide-index="'+t.attr("data-swiper-slide-index")+'"]').addClass(w.params.slideDuplicateNextClass):w.wrapper.children("."+w.params.slideClass+"."+w.params.slideDuplicateClass+'[data-swiper-slide-index="'+t.attr("data-swiper-slide-index")+'"]').addClass(w.params.slideDuplicateNextClass),a.hasClass(w.params.slideDuplicateClass)?w.wrapper.children("."+w.params.slideClass+":not(."+w.params.slideDuplicateClass+')[data-swiper-slide-index="'+a.attr("data-swiper-slide-index")+'"]').addClass(w.params.slideDuplicatePrevClass):w.wrapper.children("."+w.params.slideClass+"."+w.params.slideDuplicateClass+'[data-swiper-slide-index="'+a.attr("data-swiper-slide-index")+'"]').addClass(w.params.slideDuplicatePrevClass)),w.paginationContainer&&0<w.paginationContainer.length){var r,i=w.params.loop?Math.ceil((w.slides.length-2*w.loopedSlides)/w.params.slidesPerGroup):w.snapGrid.length;if(w.params.loop?((r=Math.ceil((w.activeIndex-w.loopedSlides)/w.params.slidesPerGroup))>w.slides.length-1-2*w.loopedSlides&&(r-=w.slides.length-2*w.loopedSlides),i-1<r&&(r-=i),r<0&&"bullets"!==w.params.paginationType&&(r=i+r)):r=void 0!==w.snapIndex?w.snapIndex:w.activeIndex||0,"bullets"===w.params.paginationType&&w.bullets&&0<w.bullets.length&&(w.bullets.removeClass(w.params.bulletActiveClass),1<w.paginationContainer.length?w.bullets.each(function(){T(this).index()===r&&T(this).addClass(w.params.bulletActiveClass)}):w.bullets.eq(r).addClass(w.params.bulletActiveClass)),"fraction"===w.params.paginationType&&(w.paginationContainer.find("."+w.params.paginationCurrentClass).text(r+1),w.paginationContainer.find("."+w.params.paginationTotalClass).text(i)),"progress"===w.params.paginationType){var o=(r+1)/i,n=o,s=1;w.isHorizontal()||(s=o,n=1),w.paginationContainer.find("."+w.params.paginationProgressbarClass).transform("translate3d(0,0,0) scaleX("+n+") scaleY("+s+")").transition(w.params.speed)}"custom"===w.params.paginationType&&w.params.paginationCustomRender&&(w.paginationContainer.html(w.params.paginationCustomRender(w,r+1,i)),w.emit("onPaginationRendered",w,w.paginationContainer[0]))}w.params.loop||(w.params.prevButton&&w.prevButton&&0<w.prevButton.length&&(w.isBeginning?(w.prevButton.addClass(w.params.buttonDisabledClass),w.params.a11y&&w.a11y&&w.a11y.disable(w.prevButton)):(w.prevButton.removeClass(w.params.buttonDisabledClass),w.params.a11y&&w.a11y&&w.a11y.enable(w.prevButton))),w.params.nextButton&&w.nextButton&&0<w.nextButton.length&&(w.isEnd?(w.nextButton.addClass(w.params.buttonDisabledClass),w.params.a11y&&w.a11y&&w.a11y.disable(w.nextButton)):(w.nextButton.removeClass(w.params.buttonDisabledClass),w.params.a11y&&w.a11y&&w.a11y.enable(w.nextButton))))},w.updatePagination=function(){if(w.params.pagination&&w.paginationContainer&&0<w.paginationContainer.length){var e="";if("bullets"===w.params.paginationType){for(var t=w.params.loop?Math.ceil((w.slides.length-2*w.loopedSlides)/w.params.slidesPerGroup):w.snapGrid.length,a=0;a<t;a++)w.params.paginationBulletRender?e+=w.params.paginationBulletRender(w,a,w.params.bulletClass):e+="<"+w.params.paginationElement+' class="'+w.params.bulletClass+'"></'+w.params.paginationElement+">";w.paginationContainer.html(e),w.bullets=w.paginationContainer.find("."+w.params.bulletClass),w.params.paginationClickable&&w.params.a11y&&w.a11y&&w.a11y.initPagination()}"fraction"===w.params.paginationType&&(e=w.params.paginationFractionRender?w.params.paginationFractionRender(w,w.params.paginationCurrentClass,w.params.paginationTotalClass):'<span class="'+w.params.paginationCurrentClass+'"></span> / <span class="'+w.params.paginationTotalClass+'"></span>',w.paginationContainer.html(e)),"progress"===w.params.paginationType&&(e=w.params.paginationProgressRender?w.params.paginationProgressRender(w,w.params.paginationProgressbarClass):'<span class="'+w.params.paginationProgressbarClass+'"></span>',w.paginationContainer.html(e)),"custom"!==w.params.paginationType&&w.emit("onPaginationRendered",w,w.paginationContainer[0])}},w.update=function(e){var t;w&&(w.updateContainerSize(),w.updateSlidesSize(),w.updateProgress(),w.updatePagination(),w.updateClasses(),w.params.scrollbar&&w.scrollbar&&w.scrollbar.set(),e?(w.controller&&w.controller.spline&&(w.controller.spline=void 0),w.params.freeMode?(a(),w.params.autoHeight&&w.updateAutoHeight()):(("auto"===w.params.slidesPerView||1<w.params.slidesPerView)&&w.isEnd&&!w.params.centeredSlides?w.slideTo(w.slides.length-1,0,!1,!0):w.slideTo(w.activeIndex,0,!1,!0))||a()):w.params.autoHeight&&w.updateAutoHeight());function a(){w.rtl,w.translate;t=Math.min(Math.max(w.translate,w.maxTranslate()),w.minTranslate()),w.setWrapperTranslate(t),w.updateActiveIndex(),w.updateClasses()}},w.onResize=function(e){w.params.onBeforeResize&&w.params.onBeforeResize(w),w.params.breakpoints&&w.setBreakpoint();var t=w.params.allowSwipeToPrev,a=w.params.allowSwipeToNext;w.params.allowSwipeToPrev=w.params.allowSwipeToNext=!0,w.updateContainerSize(),w.updateSlidesSize(),("auto"===w.params.slidesPerView||w.params.freeMode||e)&&w.updatePagination(),w.params.scrollbar&&w.scrollbar&&w.scrollbar.set(),w.controller&&w.controller.spline&&(w.controller.spline=void 0);var r=!1;if(w.params.freeMode){var i=Math.min(Math.max(w.translate,w.maxTranslate()),w.minTranslate());w.setWrapperTranslate(i),w.updateActiveIndex(),w.updateClasses(),w.params.autoHeight&&w.updateAutoHeight()}else w.updateClasses(),r=("auto"===w.params.slidesPerView||1<w.params.slidesPerView)&&w.isEnd&&!w.params.centeredSlides?w.slideTo(w.slides.length-1,0,!1,!0):w.slideTo(w.activeIndex,0,!1,!0);w.params.lazyLoading&&!r&&w.lazy&&w.lazy.load(),w.params.allowSwipeToPrev=t,w.params.allowSwipeToNext=a,w.params.onAfterResize&&w.params.onAfterResize(w)},w.touchEventsDesktop={start:"mousedown",move:"mousemove",end:"mouseup"},window.navigator.pointerEnabled?w.touchEventsDesktop={start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled&&(w.touchEventsDesktop={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}),w.touchEvents={start:w.support.touch||!w.params.simulateTouch?"touchstart":w.touchEventsDesktop.start,move:w.support.touch||!w.params.simulateTouch?"touchmove":w.touchEventsDesktop.move,end:w.support.touch||!w.params.simulateTouch?"touchend":w.touchEventsDesktop.end},(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)&&("container"===w.params.touchEventsTarget?w.container:w.wrapper).addClass("swiper-wp8-"+w.params.direction),w.initEvents=function(e){var t=e?"off":"on",a=e?"removeEventListener":"addEventListener",r="container"===w.params.touchEventsTarget?w.container[0]:w.wrapper[0],i=w.support.touch?r:document,o=!!w.params.nested;if(w.browser.ie)r[a](w.touchEvents.start,w.onTouchStart,!1),i[a](w.touchEvents.move,w.onTouchMove,o),i[a](w.touchEvents.end,w.onTouchEnd,!1);else{if(w.support.touch){var n=!("touchstart"!==w.touchEvents.start||!w.support.passiveListener||!w.params.passiveListeners)&&{passive:!0,capture:!1};r[a](w.touchEvents.start,w.onTouchStart,n),r[a](w.touchEvents.move,w.onTouchMove,o),r[a](w.touchEvents.end,w.onTouchEnd,n)}(l.simulateTouch&&!w.device.ios&&!w.device.android||l.simulateTouch&&!w.support.touch&&w.device.ios)&&(r[a]("mousedown",w.onTouchStart,!1),document[a]("mousemove",w.onTouchMove,o),document[a]("mouseup",w.onTouchEnd,!1))}window[a]("resize",w.onResize),w.params.nextButton&&w.nextButton&&0<w.nextButton.length&&(w.nextButton[t]("click",w.onClickNext),w.params.a11y&&w.a11y&&w.nextButton[t]("keydown",w.a11y.onEnterKey)),w.params.prevButton&&w.prevButton&&0<w.prevButton.length&&(w.prevButton[t]("click",w.onClickPrev),w.params.a11y&&w.a11y&&w.prevButton[t]("keydown",w.a11y.onEnterKey)),w.params.pagination&&w.params.paginationClickable&&(w.paginationContainer[t]("click","."+w.params.bulletClass,w.onClickIndex),w.params.a11y&&w.a11y&&w.paginationContainer[t]("keydown","."+w.params.bulletClass,w.a11y.onEnterKey)),(w.params.preventClicks||w.params.preventClicksPropagation)&&r[a]("click",w.preventClicks,!0)},w.attachEvents=function(){w.initEvents()},w.detachEvents=function(){w.initEvents(!0)},w.allowClick=!0,w.preventClicks=function(e){w.allowClick||(w.params.preventClicks&&e.preventDefault(),w.params.preventClicksPropagation&&w.animating&&(e.stopPropagation(),e.stopImmediatePropagation()))},w.onClickNext=function(e){e.preventDefault(),w.isEnd&&!w.params.loop||w.slideNext()},w.onClickPrev=function(e){e.preventDefault(),w.isBeginning&&!w.params.loop||w.slidePrev()},w.onClickIndex=function(e){e.preventDefault();var t=T(this).index()*w.params.slidesPerGroup;w.params.loop&&(t+=w.loopedSlides),w.slideTo(t)},w.updateClickedSlide=function(e){var t=j(e,"."+w.params.slideClass),a=!1;if(t)for(var r=0;r<w.slides.length;r++)w.slides[r]===t&&(a=!0);if(!t||!a)return w.clickedSlide=void 0,void(w.clickedIndex=void 0);if(w.clickedSlide=t,w.clickedIndex=T(t).index(),w.params.slideToClickedSlide&&void 0!==w.clickedIndex&&w.clickedIndex!==w.activeIndex){var i,o=w.clickedIndex,n="auto"===w.params.slidesPerView?w.currentSlidesPerView():w.params.slidesPerView;if(w.params.loop){if(w.animating)return;i=parseInt(T(w.clickedSlide).attr("data-swiper-slide-index"),10),w.params.centeredSlides?o<w.loopedSlides-n/2||o>w.slides.length-w.loopedSlides+n/2?(w.fixLoop(),o=w.wrapper.children("."+w.params.slideClass+'[data-swiper-slide-index="'+i+'"]:not(.'+w.params.slideDuplicateClass+")").eq(0).index(),setTimeout(function(){w.slideTo(o)},0)):w.slideTo(o):o>w.slides.length-n?(w.fixLoop(),o=w.wrapper.children("."+w.params.slideClass+'[data-swiper-slide-index="'+i+'"]:not(.'+w.params.slideDuplicateClass+")").eq(0).index(),setTimeout(function(){w.slideTo(o)},0)):w.slideTo(o)}else w.slideTo(o)}};var b,y,$,k,d,C,x,c,E,S,p,u,f="input, select, textarea, button, video",I=Date.now(),F=[];for(var h in w.animating=!1,w.touches={startX:0,startY:0,currentX:0,currentY:0,diff:0},w.onTouchStart=function(e){if(e.originalEvent&&(e=e.originalEvent),(p="touchstart"===e.type)||!("which"in e)||3!==e.which)if(w.params.noSwiping&&j(e,"."+w.params.noSwipingClass))w.allowClick=!0;else if(!w.params.swipeHandler||j(e,w.params.swipeHandler)){var t=w.touches.currentX="touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,a=w.touches.currentY="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY;if(!(w.device.ios&&w.params.iOSEdgeSwipeDetection&&t<=w.params.iOSEdgeSwipeThreshold)){if($=!(y=!(b=!0)),u=d=void 0,w.touches.startX=t,w.touches.startY=a,k=Date.now(),w.allowClick=!0,w.updateContainerSize(),w.swipeDirection=void 0,0<w.params.threshold&&(c=!1),"touchstart"!==e.type){var r=!0;T(e.target).is(f)&&(r=!1),document.activeElement&&T(document.activeElement).is(f)&&document.activeElement.blur(),r&&e.preventDefault()}w.emit("onTouchStart",w,e)}}},w.onTouchMove=function(e){if(e.originalEvent&&(e=e.originalEvent),!p||"mousemove"!==e.type){if(e.preventedByNestedSwiper)return w.touches.startX="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,void(w.touches.startY="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY);if(w.params.onlyExternal)return w.allowClick=!1,void(b&&(w.touches.startX=w.touches.currentX="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,w.touches.startY=w.touches.currentY="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,k=Date.now()));if(p&&w.params.touchReleaseOnEdges&&!w.params.loop)if(w.isHorizontal()){if(w.touches.currentX<w.touches.startX&&w.translate<=w.maxTranslate()||w.touches.currentX>w.touches.startX&&w.translate>=w.minTranslate())return}else if(w.touches.currentY<w.touches.startY&&w.translate<=w.maxTranslate()||w.touches.currentY>w.touches.startY&&w.translate>=w.minTranslate())return;if(p&&document.activeElement&&e.target===document.activeElement&&T(e.target).is(f))return y=!0,void(w.allowClick=!1);if($&&w.emit("onTouchMove",w,e),!(e.targetTouches&&1<e.targetTouches.length)){var t;if(w.touches.currentX="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,w.touches.currentY="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,void 0===d)w.isHorizontal()&&w.touches.currentY===w.touches.startY||!w.isHorizontal()&&w.touches.currentX===w.touches.startX?d=!1:(t=180*Math.atan2(Math.abs(w.touches.currentY-w.touches.startY),Math.abs(w.touches.currentX-w.touches.startX))/Math.PI,d=w.isHorizontal()?t>w.params.touchAngle:90-t>w.params.touchAngle);if(d&&w.emit("onTouchMoveOpposite",w,e),void 0===u&&(w.touches.currentX===w.touches.startX&&w.touches.currentY===w.touches.startY||(u=!0)),b)if(d)b=!1;else if(u){w.allowClick=!1,w.emit("onSliderMove",w,e),e.preventDefault(),w.params.touchMoveStopPropagation&&!w.params.nested&&e.stopPropagation(),y||(l.loop&&w.fixLoop(),x=w.getWrapperTranslate(),w.setWrapperTransition(0),w.animating&&w.wrapper.trigger("webkitTransitionEnd transitionend oTransitionEnd MSTransitionEnd msTransitionEnd"),w.params.autoplay&&w.autoplaying&&(w.params.autoplayDisableOnInteraction?w.stopAutoplay():w.pauseAutoplay()),S=!1,!w.params.grabCursor||!0!==w.params.allowSwipeToNext&&!0!==w.params.allowSwipeToPrev||w.setGrabCursor(!0)),y=!0;var a=w.touches.diff=w.isHorizontal()?w.touches.currentX-w.touches.startX:w.touches.currentY-w.touches.startY;a*=w.params.touchRatio,w.rtl&&(a=-a),w.swipeDirection=0<a?"prev":"next",C=a+x;var r=!0;if(0<a&&C>w.minTranslate()?(r=!1,w.params.resistance&&(C=w.minTranslate()-1+Math.pow(-w.minTranslate()+x+a,w.params.resistanceRatio))):a<0&&C<w.maxTranslate()&&(r=!1,w.params.resistance&&(C=w.maxTranslate()+1-Math.pow(w.maxTranslate()-x-a,w.params.resistanceRatio))),r&&(e.preventedByNestedSwiper=!0),!w.params.allowSwipeToNext&&"next"===w.swipeDirection&&C<x&&(C=x),!w.params.allowSwipeToPrev&&"prev"===w.swipeDirection&&x<C&&(C=x),0<w.params.threshold){if(!(Math.abs(a)>w.params.threshold||c))return void(C=x);if(!c)return c=!0,w.touches.startX=w.touches.currentX,w.touches.startY=w.touches.currentY,C=x,void(w.touches.diff=w.isHorizontal()?w.touches.currentX-w.touches.startX:w.touches.currentY-w.touches.startY)}w.params.followFinger&&((w.params.freeMode||w.params.watchSlidesProgress)&&w.updateActiveIndex(),w.params.freeMode&&(0===F.length&&F.push({position:w.touches[w.isHorizontal()?"startX":"startY"],time:k}),F.push({position:w.touches[w.isHorizontal()?"currentX":"currentY"],time:(new window.Date).getTime()})),w.updateProgress(C),w.setWrapperTranslate(C))}}}},w.onTouchEnd=function(e){if(e.originalEvent&&(e=e.originalEvent),$&&w.emit("onTouchEnd",w,e),$=!1,b){w.params.grabCursor&&y&&b&&(!0===w.params.allowSwipeToNext||!0===w.params.allowSwipeToPrev)&&w.setGrabCursor(!1);var t,a=Date.now(),r=a-k;if(w.allowClick&&(w.updateClickedSlide(e),w.emit("onTap",w,e),r<300&&300<a-I&&(E&&clearTimeout(E),E=setTimeout(function(){w&&(w.params.paginationHide&&0<w.paginationContainer.length&&!T(e.target).hasClass(w.params.bulletClass)&&w.paginationContainer.toggleClass(w.params.paginationHiddenClass),w.emit("onClick",w,e))},300)),r<300&&a-I<300&&(E&&clearTimeout(E),w.emit("onDoubleTap",w,e))),I=Date.now(),setTimeout(function(){w&&(w.allowClick=!0)},0),b&&y&&w.swipeDirection&&0!==w.touches.diff&&C!==x)if(b=y=!1,t=w.params.followFinger?w.rtl?w.translate:-w.translate:-C,w.params.freeMode){if(t<-w.minTranslate())return void w.slideTo(w.activeIndex);if(t>-w.maxTranslate())return void(w.slides.length<w.snapGrid.length?w.slideTo(w.snapGrid.length-1):w.slideTo(w.slides.length-1));if(w.params.freeModeMomentum){if(1<F.length){var i=F.pop(),o=F.pop(),n=i.position-o.position,s=i.time-o.time;w.velocity=n/s,w.velocity=w.velocity/2,Math.abs(w.velocity)<w.params.freeModeMinimumVelocity&&(w.velocity=0),(150<s||300<(new window.Date).getTime()-i.time)&&(w.velocity=0)}else w.velocity=0;w.velocity=w.velocity*w.params.freeModeMomentumVelocityRatio,F.length=0;var l=1e3*w.params.freeModeMomentumRatio,d=w.velocity*l,c=w.translate+d;w.rtl&&(c=-c);var p,u=!1,f=20*Math.abs(w.velocity)*w.params.freeModeMomentumBounceRatio;if(c<w.maxTranslate())w.params.freeModeMomentumBounce?(c+w.maxTranslate()<-f&&(c=w.maxTranslate()-f),p=w.maxTranslate(),S=u=!0):c=w.maxTranslate();else if(c>w.minTranslate())w.params.freeModeMomentumBounce?(c-w.minTranslate()>f&&(c=w.minTranslate()+f),p=w.minTranslate(),S=u=!0):c=w.minTranslate();else if(w.params.freeModeSticky){var h,m=0;for(m=0;m<w.snapGrid.length;m+=1)if(w.snapGrid[m]>-c){h=m;break}c=Math.abs(w.snapGrid[h]-c)<Math.abs(w.snapGrid[h-1]-c)||"next"===w.swipeDirection?w.snapGrid[h]:w.snapGrid[h-1],w.rtl||(c=-c)}if(0!==w.velocity)l=w.rtl?Math.abs((-c-w.translate)/w.velocity):Math.abs((c-w.translate)/w.velocity);else if(w.params.freeModeSticky)return void w.slideReset();w.params.freeModeMomentumBounce&&u?(w.updateProgress(p),w.setWrapperTransition(l),w.setWrapperTranslate(c),w.onTransitionStart(),w.animating=!0,w.wrapper.transitionEnd(function(){w&&S&&(w.emit("onMomentumBounce",w),w.setWrapperTransition(w.params.speed),w.setWrapperTranslate(p),w.wrapper.transitionEnd(function(){w&&w.onTransitionEnd()}))})):w.velocity?(w.updateProgress(c),w.setWrapperTransition(l),w.setWrapperTranslate(c),w.onTransitionStart(),w.animating||(w.animating=!0,w.wrapper.transitionEnd(function(){w&&w.onTransitionEnd()}))):w.updateProgress(c),w.updateActiveIndex()}(!w.params.freeModeMomentum||r>=w.params.longSwipesMs)&&(w.updateProgress(),w.updateActiveIndex())}else{var g,j=0,v=w.slidesSizesGrid[0];for(g=0;g<w.slidesGrid.length;g+=w.params.slidesPerGroup)void 0!==w.slidesGrid[g+w.params.slidesPerGroup]?t>=w.slidesGrid[g]&&t<w.slidesGrid[g+w.params.slidesPerGroup]&&(j=g,v=w.slidesGrid[g+w.params.slidesPerGroup]-w.slidesGrid[g]):t>=w.slidesGrid[g]&&(j=g,v=w.slidesGrid[w.slidesGrid.length-1]-w.slidesGrid[w.slidesGrid.length-2]);var P=(t-w.slidesGrid[j])/v;if(r>w.params.longSwipesMs){if(!w.params.longSwipes)return void w.slideTo(w.activeIndex);"next"===w.swipeDirection&&(P>=w.params.longSwipesRatio?w.slideTo(j+w.params.slidesPerGroup):w.slideTo(j)),"prev"===w.swipeDirection&&(P>1-w.params.longSwipesRatio?w.slideTo(j+w.params.slidesPerGroup):w.slideTo(j))}else{if(!w.params.shortSwipes)return void w.slideTo(w.activeIndex);"next"===w.swipeDirection&&w.slideTo(j+w.params.slidesPerGroup),"prev"===w.swipeDirection&&w.slideTo(j)}}else b=y=!1}},w._slideTo=function(e,t){return w.slideTo(e,t,!0,!0)},w.slideTo=function(e,t,a,r){void 0===a&&(a=!0),void 0===e&&(e=0),e<0&&(e=0),w.snapIndex=Math.floor(e/w.params.slidesPerGroup),w.snapIndex>=w.snapGrid.length&&(w.snapIndex=w.snapGrid.length-1);var i=-w.snapGrid[w.snapIndex];if(w.params.autoplay&&w.autoplaying&&(r||!w.params.autoplayDisableOnInteraction?w.pauseAutoplay(t):w.stopAutoplay()),w.updateProgress(i),w.params.normalizeSlideIndex)for(var o=0;o<w.slidesGrid.length;o++)-Math.floor(100*i)>=Math.floor(100*w.slidesGrid[o])&&(e=o);return!(!w.params.allowSwipeToNext&&i<w.translate&&i<w.minTranslate())&&(!(!w.params.allowSwipeToPrev&&i>w.translate&&i>w.maxTranslate()&&(w.activeIndex||0)!==e)&&(void 0===t&&(t=w.params.speed),w.previousIndex=w.activeIndex||0,w.activeIndex=e,w.updateRealIndex(),w.rtl&&-i===w.translate||!w.rtl&&i===w.translate?(w.params.autoHeight&&w.updateAutoHeight(),w.updateClasses(),"slide"!==w.params.effect&&w.setWrapperTranslate(i),!1):(w.updateClasses(),w.onTransitionStart(a),0===t||w.browser.lteIE9?(w.setWrapperTranslate(i),w.setWrapperTransition(0),w.onTransitionEnd(a)):(w.setWrapperTranslate(i),w.setWrapperTransition(t),w.animating||(w.animating=!0,w.wrapper.transitionEnd(function(){w&&w.onTransitionEnd(a)}))),!0)))},w.onTransitionStart=function(e){void 0===e&&(e=!0),w.params.autoHeight&&w.updateAutoHeight(),w.lazy&&w.lazy.onTransitionStart(),e&&(w.emit("onTransitionStart",w),w.activeIndex!==w.previousIndex&&(w.emit("onSlideChangeStart",w),w.activeIndex>w.previousIndex?w.emit("onSlideNextStart",w):w.emit("onSlidePrevStart",w)))},w.onTransitionEnd=function(e){w.animating=!1,w.setWrapperTransition(0),void 0===e&&(e=!0),w.lazy&&w.lazy.onTransitionEnd(),e&&(w.emit("onTransitionEnd",w),w.activeIndex!==w.previousIndex&&(w.emit("onSlideChangeEnd",w),w.activeIndex>w.previousIndex?w.emit("onSlideNextEnd",w):w.emit("onSlidePrevEnd",w))),w.params.history&&w.history&&w.history.setHistory(w.params.history,w.activeIndex),w.params.hashnav&&w.hashnav&&w.hashnav.setHash()},w.slideNext=function(e,t,a){if(w.params.loop){if(w.animating)return!1;w.fixLoop();w.container[0].clientLeft;return w.slideTo(w.activeIndex+w.params.slidesPerGroup,t,e,a)}return w.slideTo(w.activeIndex+w.params.slidesPerGroup,t,e,a)},w._slideNext=function(e){return w.slideNext(!0,e,!0)},w.slidePrev=function(e,t,a){if(w.params.loop){if(w.animating)return!1;w.fixLoop();w.container[0].clientLeft;return w.slideTo(w.activeIndex-1,t,e,a)}return w.slideTo(w.activeIndex-1,t,e,a)},w._slidePrev=function(e){return w.slidePrev(!0,e,!0)},w.slideReset=function(e,t,a){return w.slideTo(w.activeIndex,t,e)},w.disableTouchControl=function(){return w.params.onlyExternal=!0},w.enableTouchControl=function(){return!(w.params.onlyExternal=!1)},w.setWrapperTransition=function(e,t){w.wrapper.transition(e),"slide"!==w.params.effect&&w.effects[w.params.effect]&&w.effects[w.params.effect].setTransition(e),w.params.parallax&&w.parallax&&w.parallax.setTransition(e),w.params.scrollbar&&w.scrollbar&&w.scrollbar.setTransition(e),w.params.control&&w.controller&&w.controller.setTransition(e,t),w.emit("onSetTransition",w,e)},w.setWrapperTranslate=function(e,t,a){var r=0,i=0;w.isHorizontal()?r=w.rtl?-e:e:i=e,w.params.roundLengths&&(r=g(r),i=g(i)),w.params.virtualTranslate||(w.support.transforms3d?w.wrapper.transform("translate3d("+r+"px, "+i+"px, 0px)"):w.wrapper.transform("translate("+r+"px, "+i+"px)")),w.translate=w.isHorizontal()?r:i;var o=w.maxTranslate()-w.minTranslate();(0===o?0:(e-w.minTranslate())/o)!==w.progress&&w.updateProgress(e),t&&w.updateActiveIndex(),"slide"!==w.params.effect&&w.effects[w.params.effect]&&w.effects[w.params.effect].setTranslate(w.translate),w.params.parallax&&w.parallax&&w.parallax.setTranslate(w.translate),w.params.scrollbar&&w.scrollbar&&w.scrollbar.setTranslate(w.translate),w.params.control&&w.controller&&w.controller.setTranslate(w.translate,a),w.emit("onSetTranslate",w,w.translate)},w.getTranslate=function(e,t){var a,r,i,o;return void 0===t&&(t="x"),w.params.virtualTranslate?w.rtl?-w.translate:w.translate:(i=window.getComputedStyle(e,null),window.WebKitCSSMatrix?(6<(r=i.transform||i.webkitTransform).split(",").length&&(r=r.split(", ").map(function(e){return e.replace(",",".")}).join(", ")),o=new window.WebKitCSSMatrix("none"===r?"":r)):a=(o=i.MozTransform||i.OTransform||i.MsTransform||i.msTransform||i.transform||i.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,")).toString().split(","),"x"===t&&(r=window.WebKitCSSMatrix?o.m41:16===a.length?parseFloat(a[12]):parseFloat(a[4])),"y"===t&&(r=window.WebKitCSSMatrix?o.m42:16===a.length?parseFloat(a[13]):parseFloat(a[5])),w.rtl&&r&&(r=-r),r||0)},w.getWrapperTranslate=function(e){return void 0===e&&(e=w.isHorizontal()?"x":"y"),w.getTranslate(w.wrapper[0],e)},w.observers=[],w.initObservers=function(){if(w.params.observeParents)for(var e=w.container.parents(),t=0;t<e.length;t++)v(e[t]);v(w.container[0],{childList:!1}),v(w.wrapper[0],{attributes:!1})},w.disconnectObservers=function(){for(var e=0;e<w.observers.length;e++)w.observers[e].disconnect();w.observers=[]},w.effects={},w.controller={LinearSpline:function(e,t){var a,r,i,o,n,s=function(e,t){for(r=-1,a=e.length;1<a-r;)e[i=a+r>>1]<=t?r=i:a=i;return a};this.x=e,this.y=t,this.lastIndex=e.length-1;this.x.length;this.interpolate=function(e){return e?(n=s(this.x,e),o=n-1,(e-this.x[o])*(this.y[n]-this.y[o])/(this.x[n]-this.x[o])+this.y[o]):0}},getInterpolateFunction:function(e){w.controller.spline||(w.controller.spline=w.params.loop?new w.controller.LinearSpline(w.slidesGrid,e.slidesGrid):new w.controller.LinearSpline(w.snapGrid,e.snapGrid))},setTranslate:function(t,e){var a,r,i=w.params.control;function o(e){t=e.rtl&&"horizontal"===e.params.direction?-w.translate:w.translate,"slide"===w.params.controlBy&&(w.controller.getInterpolateFunction(e),r=-w.controller.spline.interpolate(-t)),r&&"container"!==w.params.controlBy||(a=(e.maxTranslate()-e.minTranslate())/(w.maxTranslate()-w.minTranslate()),r=(t-w.minTranslate())*a+e.minTranslate()),w.params.controlInverse&&(r=e.maxTranslate()-r),e.updateProgress(r),e.setWrapperTranslate(r,!1,w),e.updateActiveIndex()}if(Array.isArray(i))for(var n=0;n<i.length;n++)i[n]!==e&&i[n]instanceof A&&o(i[n]);else i instanceof A&&e!==i&&o(i)},setTransition:function(t,e){var a,r=w.params.control;function i(e){e.setWrapperTransition(t,w),0!==t&&(e.onTransitionStart(),e.wrapper.transitionEnd(function(){r&&(e.params.loop&&"slide"===w.params.controlBy&&e.fixLoop(),e.onTransitionEnd())}))}if(Array.isArray(r))for(a=0;a<r.length;a++)r[a]!==e&&r[a]instanceof A&&i(r[a]);else r instanceof A&&e!==r&&i(r)}},w._plugins=[],w.plugins){var m=w.plugins[h](w,w.params[h]);m&&w._plugins.push(m)}return w.callPlugins=function(e){for(var t=0;t<w._plugins.length;t++)e in w._plugins[t]&&w._plugins[t][e](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},w.emitterEventListeners={},w.emit=function(e){var t;if(w.params[e]&&w.params[e](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),w.emitterEventListeners[e])for(t=0;t<w.emitterEventListeners[e].length;t++)w.emitterEventListeners[e][t](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);w.callPlugins&&w.callPlugins(e,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},w.on=function(e,t){return e=P(e),w.emitterEventListeners[e]||(w.emitterEventListeners[e]=[]),w.emitterEventListeners[e].push(t),w},w.off=function(e,t){var a;if(e=P(e),void 0===t)return w.emitterEventListeners[e]=[],w;if(w.emitterEventListeners[e]&&0!==w.emitterEventListeners[e].length){for(a=0;a<w.emitterEventListeners[e].length;a++)w.emitterEventListeners[e][a]===t&&w.emitterEventListeners[e].splice(a,1);return w}},w.once=function(e,t){e=P(e);var a=function(){t(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]),w.off(e,a)};return w.on(e,a),w},w.a11y={makeFocusable:function(e){return e.attr("tabIndex","0"),e},addRole:function(e,t){return e.attr("role",t),e},addLabel:function(e,t){return e.attr("aria-label",t),e},disable:function(e){return e.attr("aria-disabled",!0),e},enable:function(e){return e.attr("aria-disabled",!1),e},onEnterKey:function(e){13===e.keyCode&&(T(e.target).is(w.params.nextButton)?(w.onClickNext(e),w.isEnd?w.a11y.notify(w.params.lastSlideMessage):w.a11y.notify(w.params.nextSlideMessage)):T(e.target).is(w.params.prevButton)&&(w.onClickPrev(e),w.isBeginning?w.a11y.notify(w.params.firstSlideMessage):w.a11y.notify(w.params.prevSlideMessage)),T(e.target).is("."+w.params.bulletClass)&&T(e.target)[0].click())},liveRegion:T('<span class="'+w.params.notificationClass+'" aria-live="assertive" aria-atomic="true"></span>'),notify:function(e){var t=w.a11y.liveRegion;0!==t.length&&(t.html(""),t.html(e))},init:function(){w.params.nextButton&&w.nextButton&&0<w.nextButton.length&&(w.a11y.makeFocusable(w.nextButton),w.a11y.addRole(w.nextButton,"button"),w.a11y.addLabel(w.nextButton,w.params.nextSlideMessage)),w.params.prevButton&&w.prevButton&&0<w.prevButton.length&&(w.a11y.makeFocusable(w.prevButton),w.a11y.addRole(w.prevButton,"button"),w.a11y.addLabel(w.prevButton,w.params.prevSlideMessage)),T(w.container).append(w.a11y.liveRegion)},initPagination:function(){w.params.pagination&&w.params.paginationClickable&&w.bullets&&w.bullets.length&&w.bullets.each(function(){var e=T(this);w.a11y.makeFocusable(e),w.a11y.addRole(e,"button"),w.a11y.addLabel(e,w.params.paginationBulletMessage.replace(/{{index}}/,e.index()+1))})},destroy:function(){w.a11y.liveRegion&&0<w.a11y.liveRegion.length&&w.a11y.liveRegion.remove()}},w.init=function(){w.params.loop&&w.createLoop(),w.updateContainerSize(),w.updateSlidesSize(),w.updatePagination(),w.params.scrollbar&&w.scrollbar&&(w.scrollbar.set(),w.params.scrollbarDraggable&&w.scrollbar.enableDraggable()),"slide"!==w.params.effect&&w.effects[w.params.effect]&&(w.params.loop||w.updateProgress(),w.effects[w.params.effect].setTranslate()),w.params.loop?w.slideTo(w.params.initialSlide+w.loopedSlides,0,w.params.runCallbacksOnInit):(w.slideTo(w.params.initialSlide,0,w.params.runCallbacksOnInit),0===w.params.initialSlide&&(w.parallax&&w.params.parallax&&w.parallax.setTranslate(),w.lazy&&w.params.lazyLoading&&(w.lazy.load(),w.lazy.initialImageLoaded=!0))),w.attachEvents(),w.params.observer&&w.support.observer&&w.initObservers(),w.params.preloadImages&&!w.params.lazyLoading&&w.preloadImages(),w.params.zoom&&w.zoom&&w.zoom.init(),w.params.autoplay&&w.startAutoplay(),w.params.keyboardControl&&w.enableKeyboardControl&&w.enableKeyboardControl(),w.params.mousewheelControl&&w.enableMousewheelControl&&w.enableMousewheelControl(),w.params.hashnavReplaceState&&(w.params.replaceState=w.params.hashnavReplaceState),w.params.history&&w.history&&w.history.init(),w.params.hashnav&&w.hashnav&&w.hashnav.init(),w.params.a11y&&w.a11y&&w.a11y.init(),w.emit("onInit",w)},w.cleanupStyles=function(){w.container.removeClass(w.classNames.join(" ")).removeAttr("style"),w.wrapper.removeAttr("style"),w.slides&&w.slides.length&&w.slides.removeClass([w.params.slideVisibleClass,w.params.slideActiveClass,w.params.slideNextClass,w.params.slidePrevClass].join(" ")).removeAttr("style").removeAttr("data-swiper-column").removeAttr("data-swiper-row"),w.paginationContainer&&w.paginationContainer.length&&w.paginationContainer.removeClass(w.params.paginationHiddenClass),w.bullets&&w.bullets.length&&w.bullets.removeClass(w.params.bulletActiveClass),w.params.prevButton&&T(w.params.prevButton).removeClass(w.params.buttonDisabledClass),w.params.nextButton&&T(w.params.nextButton).removeClass(w.params.buttonDisabledClass),w.params.scrollbar&&w.scrollbar&&(w.scrollbar.track&&w.scrollbar.track.length&&w.scrollbar.track.removeAttr("style"),w.scrollbar.drag&&w.scrollbar.drag.length&&w.scrollbar.drag.removeAttr("style"))},w.destroy=function(e,t){w.detachEvents(),w.stopAutoplay(),w.params.scrollbar&&w.scrollbar&&w.params.scrollbarDraggable&&w.scrollbar.disableDraggable(),w.params.loop&&w.destroyLoop(),t&&w.cleanupStyles(),w.disconnectObservers(),w.params.zoom&&w.zoom&&w.zoom.destroy(),w.params.keyboardControl&&w.disableKeyboardControl&&w.disableKeyboardControl(),w.params.mousewheelControl&&w.disableMousewheelControl&&w.disableMousewheelControl(),w.params.a11y&&w.a11y&&w.a11y.destroy(),w.params.history&&!w.params.replaceState&&window.removeEventListener("popstate",w.history.setHistoryPopState),w.params.hashnav&&w.hashnav&&w.hashnav.destroy(),w.emit("onDestroy"),!1!==e&&(w=null)},w.init(),w}function g(e){return Math.floor(e)}function j(e,a){var t=T(e.target);if(!t.is(a))if("string"==typeof a)t=t.parents(a);else if(a.nodeType){var r;return t.parents().each(function(e,t){t===a&&(r=a)}),r?a:void 0}if(0!==t.length)return t[0]}function v(e,t){t=t||{};var a=new(window.MutationObserver||window.WebkitMutationObserver)(function(e){e.forEach(function(e){w.onResize(!0),w.emit("onObserverUpdate",w,e)})});a.observe(e,{attributes:void 0===t.attributes||t.attributes,childList:void 0===t.childList||t.childList,characterData:void 0===t.characterData||t.characterData}),w.observers.push(a)}function P(e){return 0!==e.indexOf("on")&&(e=e[0]!==e[0].toUpperCase()?"on"+e[0].toUpperCase()+e.substring(1):"on"+e),e}};A.prototype={isSafari:(s=window.navigator.userAgent.toLowerCase(),0<=s.indexOf("safari")&&s.indexOf("chrome")<0&&s.indexOf("android")<0),isUiWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(window.navigator.userAgent),isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},browser:{ie:window.navigator.pointerEnabled||window.navigator.msPointerEnabled,ieTouch:window.navigator.msPointerEnabled&&1<window.navigator.msMaxTouchPoints||window.navigator.pointerEnabled&&1<window.navigator.maxTouchPoints,lteIE9:(n=document.createElement("div"),n.innerHTML="\x3c!--[if lte IE 9]><i></i><![endif]--\x3e",1===n.getElementsByTagName("i").length)},device:(t=window.navigator.userAgent,a=t.match(/(Android);?[\s\/]+([\d.]+)?/),r=t.match(/(iPad).*OS\s([\d_]+)/),i=t.match(/(iPod)(.*OS\s([\d_]+))?/),o=!r&&t.match(/(iPhone\sOS|iOS)\s([\d_]+)/),{ios:r||o||i,android:a}),support:{touch:window.Modernizr&&!0===Modernizr.touch||!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),transforms3d:window.Modernizr&&!0===Modernizr.csstransforms3d||(e=document.createElement("div").style,"webkitPerspective"in e||"MozPerspective"in e||"OPerspective"in e||"MsPerspective"in e||"perspective"in e),flexbox:function(){for(var e=document.createElement("div").style,t="alignItems webkitAlignItems webkitBoxAlign msFlexAlign mozBoxAlign webkitFlexDirection msFlexDirection mozBoxDirection mozBoxOrient webkitBoxDirection webkitBoxOrient".split(" "),a=0;a<t.length;a++)if(t[a]in e)return!0}(),observer:"MutationObserver"in window||"WebkitMutationObserver"in window,passiveListener:function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveListener",null,t)}catch(e){}return e}(),gestures:"ongesturestart"in window},plugins:{}};for(var l,d=["jQuery","Zepto","Dom7"],c=0;c<d.length;c++)window[d[c]]&&p(window[d[c]]);function p(e){e.fn.swiper=function(t){var a;return e(this).each(function(){var e=new A(this,t);a||(a=e)}),a}}(l="undefined"==typeof Dom7?window.Dom7||window.Zepto||window.jQuery:Dom7)&&("transitionEnd"in l.fn||(l.fn.transitionEnd=function(t){var a,r=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],i=this;function o(e){if(e.target===this)for(t.call(this,e),a=0;a<r.length;a++)i.off(r[a],o)}if(t)for(a=0;a<r.length;a++)i.on(r[a],o);return this}),"transform"in l.fn||(l.fn.transform=function(e){for(var t=0;t<this.length;t++){var a=this[t].style;a.webkitTransform=a.MsTransform=a.msTransform=a.MozTransform=a.OTransform=a.transform=e}return this}),"transition"in l.fn||(l.fn.transition=function(e){"string"!=typeof e&&(e+="ms");for(var t=0;t<this.length;t++){var a=this[t].style;a.webkitTransitionDuration=a.MsTransitionDuration=a.msTransitionDuration=a.MozTransitionDuration=a.OTransitionDuration=a.transitionDuration=e}return this}),"outerWidth"in l.fn||(l.fn.outerWidth=function(e){return 0<this.length?e?this[0].offsetWidth+parseFloat(this.css("margin-right"))+parseFloat(this.css("margin-left")):this[0].offsetWidth:null})),window.Swiper=A}(),"undefined"!=typeof module?module.exports=window.Swiper:"function"==typeof define&&define.amd&&define([],function(){"use strict";return window.Swiper}),function(e,t){"function"==typeof define&&define.amd?define(["exports"],t):"undefined"!=typeof exports?t(exports):t(e.dragscroll={})}(this,function(e){var s,l,d=window,c=document,p="mousemove",u="mouseup",f="mousedown",t="EventListener",h="add"+t,a="remove"+t,r=[];e.reset=function(e,t){for(e=0;e<r.length;)(t=(t=r[e++]).container||t)[a](f,t.md,0),d[a](u,t.mu,0),d[a](p,t.mm,0);for(r=[].slice.call(c.getElementsByClassName("dragscroll")),e=0;e<r.length;)!function(t,a,r,i,o,n){(n=t.container||t)[h](f,n.md=function(e){t.hasAttribute("nochilddrag")&&c.elementFromPoint(e.pageX,e.pageY)!=n||(i=1,a=e.clientX,r=e.clientY,e.preventDefault())},0),d[h](u,n.mu=function(){i=0},0),d[h](p,n.mm=function(e){i&&((o=t.scroller||t).scrollLeft-=s=-a+(a=e.clientX),o.scrollTop-=l=-r+(r=e.clientY),t==c.body&&((o=c.documentElement).scrollLeft-=s,o.scrollTop-=l))},0)}(r[e++])}}),function(s){s.fn.isOnScreen=function(e){var t=this.outerHeight(),a=this.outerWidth();if(!a||!t)return!1;var r=s(window),i={top:r.scrollTop(),left:r.scrollLeft()};i.right=i.left+r.width(),i.bottom=i.top+r.height();var o=this.offset();o.right=o.left+a,o.bottom=o.top+t;var n={top:i.bottom-o.top,left:i.right-o.left,bottom:o.bottom-i.top,right:o.right-i.left};return"function"==typeof e?e.call(this,n):0<n.top&&0<n.left&&0<n.right&&0<n.bottom}}(jQuery),function(d){function c(e,t){var a=e.find(".digit");if(a.is(":animated"))return!1;if(e.data("digit")==t)return!1;e.data("digit",t);var r=d("<span>",{class:"digit",css:{top:"-2.1em",opacity:0},html:t});a.before(r).removeClass("static").animate({top:"2.5em",opacity:0},"fast",function(){a.remove()}),r.delay(100).animate({top:0,opacity:1},"fast",function(){r.addClass("static")})}d.fn.countdown=function(e){var t,a,r,i,o,n,s=d.extend({callback:function(){},timestamp:0,currentServerTime:0},e);function l(e,t,a){c(o.eq(e),Math.floor(a/10)%10),c(o.eq(t),a%10)}return(n=this).addClass("countdownHolder"),d.each(["Days","Hours","Minutes","Seconds"],function(e){d('<span class="count'+this+'"><span class="position"><span class="digit static">0</span></span><span class="position"><span class="digit static">0</span></span></span>').appendTo(n),"Seconds"!=this&&n.append('<span class="countDiv countDiv'+e+'"></span>')}),o=this.find(".position"),function e(){(t=Math.floor((s.timestamp-s.currentServerTime)/1e3))<0&&(t=0),l(2,3,a=Math.floor(t/3600)),t-=3600*a,l(4,5,r=Math.floor(t/60)),l(6,7,i=t-=60*r),s.callback(void 0,a,r,i),s.currentServerTime=new Date(s.currentServerTime.getTime()+1e3),setTimeout(e,1e3)}(),this}}(jQuery),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.PerfectScrollbar=t()}(this,function(){"use strict";function j(e){return getComputedStyle(e)}function u(e,t){for(var a in t){var r=t[a];"number"==typeof r&&(r+="px"),e.style[a]=r}return e}function f(e){var t=document.createElement("div");return t.className=e,t}var a="undefined"!=typeof Element&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function s(e,t){if(!a)throw new Error("No element matching method supported");return a.call(e,t)}function r(e){e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)}function i(e,t){return Array.prototype.filter.call(e.children,function(e){return s(e,t)})}var v={main:"ps",element:{thumb:function(e){return"ps__thumb-"+e},rail:function(e){return"ps__rail-"+e},consuming:"ps__child--consume"},state:{focus:"ps--focus",clicking:"ps--clicking",active:function(e){return"ps--active-"+e},scrolling:function(e){return"ps--scrolling-"+e}}},o={x:null,y:null};function P(e,t){var a=e.element.classList,r=v.state.scrolling(t);a.contains(r)?clearTimeout(o[t]):a.add(r)}function w(e,t){o[t]=setTimeout(function(){return e.isAlive&&e.element.classList.remove(v.state.scrolling(t))},e.settings.scrollingThreshold)}var n=function(e){this.element=e,this.handlers={}},e={isEmpty:{configurable:!0}};n.prototype.bind=function(e,t){void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e].push(t),this.element.addEventListener(e,t,!1)},n.prototype.unbind=function(t,a){var r=this;this.handlers[t]=this.handlers[t].filter(function(e){return!(!a||e===a)||(r.element.removeEventListener(t,e,!1),!1)})},n.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)},e.isEmpty.get=function(){var t=this;return Object.keys(this.handlers).every(function(e){return 0===t.handlers[e].length})},Object.defineProperties(n.prototype,e);var h=function(){this.eventElements=[]};function m(e){if("function"==typeof window.CustomEvent)return new CustomEvent(e);var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,void 0),t}h.prototype.eventElement=function(t){var e=this.eventElements.filter(function(e){return e.element===t})[0];return e||(e=new n(t),this.eventElements.push(e)),e},h.prototype.bind=function(e,t,a){this.eventElement(e).bind(t,a)},h.prototype.unbind=function(e,t,a){var r=this.eventElement(e);r.unbind(t,a),r.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(r),1)},h.prototype.unbindAll=function(){this.eventElements.forEach(function(e){return e.unbindAll()}),this.eventElements=[]},h.prototype.once=function(e,t,a){var r=this.eventElement(e),i=function(e){r.unbind(t,i),a(e)};r.bind(t,i)};var t=function(e,t,a,r,i){var o;if(void 0===r&&(r=!0),void 0===i&&(i=!1),"top"===t)o=["contentHeight","containerHeight","scrollTop","y","up","down"];else{if("left"!==t)throw new Error("A proper axis should be provided");o=["contentWidth","containerWidth","scrollLeft","x","left","right"]}!function(e,t,a,r,i){var o=a[0],n=a[1],s=a[2],l=a[3],d=a[4],c=a[5];void 0===r&&(r=!0);void 0===i&&(i=!1);var p=e.element;e.reach[l]=null,p[s]<1&&(e.reach[l]="start");p[s]>e[o]-e[n]-1&&(e.reach[l]="end");t&&(p.dispatchEvent(m("ps-scroll-"+l)),t<0?p.dispatchEvent(m("ps-scroll-"+d)):0<t&&p.dispatchEvent(m("ps-scroll-"+c)),r&&(P(u=e,f=l),w(u,f)));var u,f;e.reach[l]&&(t||i)&&p.dispatchEvent(m("ps-"+l+"-reach-"+e.reach[l]))}(e,a,o,r,i)};function g(e){return parseInt(e,10)||0}var b={isWebKit:"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style,supportsTouch:"undefined"!=typeof window&&("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:"undefined"!=typeof navigator&&navigator.msMaxTouchPoints,isChrome:"undefined"!=typeof navigator&&/Chrome/i.test(navigator&&navigator.userAgent)},y=function(e){var t=e.element,a=Math.floor(t.scrollTop);e.containerWidth=t.clientWidth,e.containerHeight=t.clientHeight,e.contentWidth=t.scrollWidth,e.contentHeight=t.scrollHeight,t.contains(e.scrollbarXRail)||(i(t,v.element.rail("x")).forEach(function(e){return r(e)}),t.appendChild(e.scrollbarXRail)),t.contains(e.scrollbarYRail)||(i(t,v.element.rail("y")).forEach(function(e){return r(e)}),t.appendChild(e.scrollbarYRail)),!e.settings.suppressScrollX&&e.containerWidth+e.settings.scrollXMarginOffset<e.contentWidth?(e.scrollbarXActive=!0,e.railXWidth=e.containerWidth-e.railXMarginWidth,e.railXRatio=e.containerWidth/e.railXWidth,e.scrollbarXWidth=l(e,g(e.railXWidth*e.containerWidth/e.contentWidth)),e.scrollbarXLeft=g((e.negativeScrollAdjustment+t.scrollLeft)*(e.railXWidth-e.scrollbarXWidth)/(e.contentWidth-e.containerWidth))):e.scrollbarXActive=!1,!e.settings.suppressScrollY&&e.containerHeight+e.settings.scrollYMarginOffset<e.contentHeight?(e.scrollbarYActive=!0,e.railYHeight=e.containerHeight-e.railYMarginHeight,e.railYRatio=e.containerHeight/e.railYHeight,e.scrollbarYHeight=l(e,g(e.railYHeight*e.containerHeight/e.contentHeight)),e.scrollbarYTop=g(a*(e.railYHeight-e.scrollbarYHeight)/(e.contentHeight-e.containerHeight))):e.scrollbarYActive=!1,e.scrollbarXLeft>=e.railXWidth-e.scrollbarXWidth&&(e.scrollbarXLeft=e.railXWidth-e.scrollbarXWidth),e.scrollbarYTop>=e.railYHeight-e.scrollbarYHeight&&(e.scrollbarYTop=e.railYHeight-e.scrollbarYHeight),function(e,t){var a={width:t.railXWidth},r=Math.floor(e.scrollTop);t.isRtl?a.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth:a.left=e.scrollLeft;t.isScrollbarXUsingBottom?a.bottom=t.scrollbarXBottom-r:a.top=t.scrollbarXTop+r;u(t.scrollbarXRail,a);var i={top:r,height:t.railYHeight};t.isScrollbarYUsingRight?t.isRtl?i.right=t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth:i.right=t.scrollbarYRight-e.scrollLeft:t.isRtl?i.left=t.negativeScrollAdjustment+e.scrollLeft+2*t.containerWidth-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth:i.left=t.scrollbarYLeft+e.scrollLeft;u(t.scrollbarYRail,i),u(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth}),u(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}(t,e),e.scrollbarXActive?t.classList.add(v.state.active("x")):(t.classList.remove(v.state.active("x")),e.scrollbarXWidth=0,e.scrollbarXLeft=0,t.scrollLeft=0),e.scrollbarYActive?t.classList.add(v.state.active("y")):(t.classList.remove(v.state.active("y")),e.scrollbarYHeight=0,e.scrollbarYTop=0,t.scrollTop=0)};function l(e,t){return e.settings.minScrollbarLength&&(t=Math.max(t,e.settings.minScrollbarLength)),e.settings.maxScrollbarLength&&(t=Math.min(t,e.settings.maxScrollbarLength)),t}function d(t,e){var a=e[0],r=e[1],i=e[2],o=e[3],n=e[4],s=e[5],l=e[6],d=e[7],c=e[8],p=t.element,u=null,f=null,h=null;function m(e){p[l]=u+h*(e[i]-f),P(t,d),y(t),e.stopPropagation(),e.preventDefault()}function g(){w(t,d),t[c].classList.remove(v.state.clicking),t.event.unbind(t.ownerDocument,"mousemove",m)}t.event.bind(t[n],"mousedown",function(e){u=p[l],f=e[i],h=(t[r]-t[a])/(t[o]-t[s]),t.event.bind(t.ownerDocument,"mousemove",m),t.event.once(t.ownerDocument,"mouseup",g),t[c].classList.add(v.state.clicking),e.stopPropagation(),e.preventDefault()})}var $={"click-rail":function(a){a.event.bind(a.scrollbarY,"mousedown",function(e){return e.stopPropagation()}),a.event.bind(a.scrollbarYRail,"mousedown",function(e){var t=e.pageY-window.pageYOffset-a.scrollbarYRail.getBoundingClientRect().top>a.scrollbarYTop?1:-1;a.element.scrollTop+=t*a.containerHeight,y(a),e.stopPropagation()}),a.event.bind(a.scrollbarX,"mousedown",function(e){return e.stopPropagation()}),a.event.bind(a.scrollbarXRail,"mousedown",function(e){var t=e.pageX-window.pageXOffset-a.scrollbarXRail.getBoundingClientRect().left>a.scrollbarXLeft?1:-1;a.element.scrollLeft+=t*a.containerWidth,y(a),e.stopPropagation()})},"drag-thumb":function(e){d(e,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"]),d(e,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"])},keyboard:function(o){var n=o.element;o.event.bind(o.ownerDocument,"keydown",function(e){if(!(e.isDefaultPrevented&&e.isDefaultPrevented()||e.defaultPrevented)&&(s(n,":hover")||s(o.scrollbarX,":focus")||s(o.scrollbarY,":focus"))){var t,a=document.activeElement?document.activeElement:o.ownerDocument.activeElement;if(a){if("IFRAME"===a.tagName)a=a.contentDocument.activeElement;else for(;a.shadowRoot;)a=a.shadowRoot.activeElement;if(s(t=a,"input,[contenteditable]")||s(t,"select,[contenteditable]")||s(t,"textarea,[contenteditable]")||s(t,"button,[contenteditable]"))return}var r=0,i=0;switch(e.which){case 37:r=e.metaKey?-o.contentWidth:e.altKey?-o.containerWidth:-30;break;case 38:i=e.metaKey?o.contentHeight:e.altKey?o.containerHeight:30;break;case 39:r=e.metaKey?o.contentWidth:e.altKey?o.containerWidth:30;break;case 40:i=e.metaKey?-o.contentHeight:e.altKey?-o.containerHeight:-30;break;case 32:i=e.shiftKey?o.containerHeight:-o.containerHeight;break;case 33:i=o.containerHeight;break;case 34:i=-o.containerHeight;break;case 36:i=o.contentHeight;break;case 35:i=-o.contentHeight;break;default:return}o.settings.suppressScrollX&&0!==r||o.settings.suppressScrollY&&0!==i||(n.scrollTop-=i,n.scrollLeft+=r,y(o),function(e,t){var a=Math.floor(n.scrollTop);if(0===e){if(!o.scrollbarYActive)return!1;if(0===a&&0<t||a>=o.contentHeight-o.containerHeight&&t<0)return!o.settings.wheelPropagation}var r=n.scrollLeft;if(0===t){if(!o.scrollbarXActive)return!1;if(0===r&&e<0||r>=o.contentWidth-o.containerWidth&&0<e)return!o.settings.wheelPropagation}return!0}(r,i)&&e.preventDefault())}})},wheel:function(m){var g=m.element;function e(e){var t,a,r,i=(a=(t=e).deltaX,r=-1*t.deltaY,void 0!==a&&void 0!==r||(a=-1*t.wheelDeltaX/6,r=t.wheelDeltaY/6),t.deltaMode&&1===t.deltaMode&&(a*=10,r*=10),a!=a&&r!=r&&(a=0,r=t.wheelDelta),t.shiftKey?[-r,-a]:[a,r]),o=i[0],n=i[1];if(!function(e,t,a){if(!b.isWebKit&&g.querySelector("select:focus"))return!0;if(!g.contains(e))return!1;for(var r=e;r&&r!==g;){if(r.classList.contains(v.element.consuming))return!0;var i=j(r);if([i.overflow,i.overflowX,i.overflowY].join("").match(/(scroll|auto)/)){var o=r.scrollHeight-r.clientHeight;if(0<o&&!(0===r.scrollTop&&0<a||r.scrollTop===o&&a<0))return!0;var n=r.scrollWidth-r.clientWidth;if(0<n&&!(0===r.scrollLeft&&t<0||r.scrollLeft===n&&0<t))return!0}r=r.parentNode}return!1}(e.target,o,n)){var s,l,d,c,p,u,f,h=!1;m.settings.useBothWheelAxes?m.scrollbarYActive&&!m.scrollbarXActive?(n?g.scrollTop-=n*m.settings.wheelSpeed:g.scrollTop+=o*m.settings.wheelSpeed,h=!0):m.scrollbarXActive&&!m.scrollbarYActive&&(o?g.scrollLeft+=o*m.settings.wheelSpeed:g.scrollLeft-=n*m.settings.wheelSpeed,h=!0):(g.scrollTop-=n*m.settings.wheelSpeed,g.scrollLeft+=o*m.settings.wheelSpeed),y(m),(h=h||(s=o,l=n,d=Math.floor(g.scrollTop),c=0===g.scrollTop,p=d+g.offsetHeight===g.scrollHeight,u=0===g.scrollLeft,f=g.scrollLeft+g.offsetWidth===g.scrollWidth,!(Math.abs(l)>Math.abs(s)?c||p:u||f)||!m.settings.wheelPropagation))&&!e.ctrlKey&&(e.stopPropagation(),e.preventDefault())}}void 0!==window.onwheel?m.event.bind(g,"wheel",e):void 0!==window.onmousewheel&&m.event.bind(g,"mousewheel",e)},touch:function(s){if(b.supportsTouch||b.supportsIePointer){var l=s.element,d={},c=0,p={},a=null;b.supportsTouch?(s.event.bind(l,"touchstart",e),s.event.bind(l,"touchmove",t),s.event.bind(l,"touchend",r)):b.supportsIePointer&&(window.PointerEvent?(s.event.bind(l,"pointerdown",e),s.event.bind(l,"pointermove",t),s.event.bind(l,"pointerup",r)):window.MSPointerEvent&&(s.event.bind(l,"MSPointerDown",e),s.event.bind(l,"MSPointerMove",t),s.event.bind(l,"MSPointerUp",r)))}function u(e,t){l.scrollTop-=t,l.scrollLeft-=e,y(s)}function f(e){return e.targetTouches?e.targetTouches[0]:e}function h(e){return!(e.pointerType&&"pen"===e.pointerType&&0===e.buttons||(!e.targetTouches||1!==e.targetTouches.length)&&(!e.pointerType||"mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE))}function e(e){if(h(e)){var t=f(e);d.pageX=t.pageX,d.pageY=t.pageY,c=(new Date).getTime(),null!==a&&clearInterval(a)}}function t(e){if(h(e)){var t=f(e),a={pageX:t.pageX,pageY:t.pageY},r=a.pageX-d.pageX,i=a.pageY-d.pageY;if(function(e,t,a){if(!l.contains(e))return!1;for(var r=e;r&&r!==l;){if(r.classList.contains(v.element.consuming))return!0;var i=j(r);if([i.overflow,i.overflowX,i.overflowY].join("").match(/(scroll|auto)/)){var o=r.scrollHeight-r.clientHeight;if(0<o&&!(0===r.scrollTop&&0<a||r.scrollTop===o&&a<0))return!0;var n=r.scrollLeft-r.clientWidth;if(0<n&&!(0===r.scrollLeft&&t<0||r.scrollLeft===n&&0<t))return!0}r=r.parentNode}return!1}(e.target,r,i))return;u(r,i),d=a;var o=(new Date).getTime(),n=o-c;0<n&&(p.x=r/n,p.y=i/n,c=o),function(e,t){var a=Math.floor(l.scrollTop),r=l.scrollLeft,i=Math.abs(e),o=Math.abs(t);if(i<o){if(t<0&&a===s.contentHeight-s.containerHeight||0<t&&0===a)return 0===window.scrollY&&0<t&&b.isChrome}else if(o<i&&(e<0&&r===s.contentWidth-s.containerWidth||0<e&&0===r))return!0;return!0}(r,i)&&e.preventDefault()}}function r(){s.settings.swipeEasing&&(clearInterval(a),a=setInterval(function(){s.isInitialized?clearInterval(a):p.x||p.y?Math.abs(p.x)<.01&&Math.abs(p.y)<.01?clearInterval(a):(u(30*p.x,30*p.y),p.x*=.8,p.y*=.8):clearInterval(a)},10))}}},c=function(e,t){var a=this;if(void 0===t&&(t={}),"string"==typeof e&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");for(var r in(this.element=e).classList.add(v.main),this.settings={handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1},t)a.settings[r]=t[r];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var i,o,n=function(){return e.classList.add(v.state.focus)},s=function(){return e.classList.remove(v.state.focus)};this.isRtl="rtl"===j(e).direction,this.isNegativeScroll=(o=e.scrollLeft,e.scrollLeft=-1,i=e.scrollLeft<0,e.scrollLeft=o,i),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new h,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=f(v.element.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=f(v.element.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.event.bind(this.scrollbarX,"focus",n),this.event.bind(this.scrollbarX,"blur",s),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var l=j(this.scrollbarXRail);this.scrollbarXBottom=parseInt(l.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=g(l.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=g(l.borderLeftWidth)+g(l.borderRightWidth),u(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=g(l.marginLeft)+g(l.marginRight),u(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=f(v.element.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=f(v.element.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.event.bind(this.scrollbarY,"focus",n),this.event.bind(this.scrollbarY,"blur",s),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var d,c,p=j(this.scrollbarYRail);this.scrollbarYRight=parseInt(p.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=g(p.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?(d=this.scrollbarY,g((c=j(d)).width)+g(c.paddingLeft)+g(c.paddingRight)+g(c.borderLeftWidth)+g(c.borderRightWidth)):null,this.railBorderYWidth=g(p.borderTopWidth)+g(p.borderBottomWidth),u(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=g(p.marginTop)+g(p.marginBottom),u(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach(function(e){return $[e](a)}),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",function(e){return a.onScroll(e)}),y(this)};return c.prototype.update=function(){this.isAlive&&this.element&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,u(this.scrollbarXRail,{display:"block"}),u(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=g(j(this.scrollbarXRail).marginLeft)+g(j(this.scrollbarXRail).marginRight),this.railYMarginHeight=g(j(this.scrollbarYRail).marginTop)+g(j(this.scrollbarYRail).marginBottom),u(this.scrollbarXRail,{display:"none"}),u(this.scrollbarYRail,{display:"none"}),y(this),t(this,"top",0,!1,!0),t(this,"left",0,!1,!0),u(this.scrollbarXRail,{display:""}),u(this.scrollbarYRail,{display:""}))},c.prototype.onScroll=function(e){this.isAlive&&(y(this),t(this,"top",this.element.scrollTop-this.lastScrollTop),t(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)},c.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),r(this.scrollbarX),r(this.scrollbarY),r(this.scrollbarXRail),r(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)},c.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter(function(e){return!e.match(/^ps([-_].+|)$/)}).join(" ")},c});var $j=jQuery.noConflict(),jPar={};$j.extend(!0,jPar,{Tracking:{init:function(){},parmacontoTeaser:{init:function(){var e=this;document.addEventListener("scroll",function(){e.onScrollOrResizeViewed()},jPar.util.customEvent.hasPassiveListener()),window.addEventListener("resize",function(){e.onScrollOrResizeViewed()})},onScrollOrResizeViewed:function(){var e=this,t=$j(".urcCard [data-urclayout]:not(.is-viewed)");0<t.length&&t.each(function(){$j(this).isOnScreen(function(e){return e.top>=.75*$j(this).height()&&e.bottom>=$j(this).height()})&&($j(this).addClass("is-viewed"),e.triggerPegLoggerEvent($j(this),"viewed"))})},slotLoaded:function(e){0<e.height()&&this.triggerPegLoggerEvent(e,"loaded")},slotViewed:function(t){t.isOnScreen(function(e){return e.top>=.75*t.height()&&e.bottom>=$j(this).height()})&&(t.addClass("is-viewed"),this.triggerPegLoggerEvent(t,"viewed"))},slotClicked:function(e){var r=this;e.on("click",function(e){var t=$j(this).attr("href");if(navigator&&navigator.sendBeacon)e.preventDefault(),r.triggerPegLoggerEvent($j(this),"click"),window.setTimeout(function(){document.location.href=t},50);else{var a=void 0===$j(this).attr("target");a&&(e.preventDefault(),document.addEventListener("sherLogger-xhrDone",function(){document.location.href=t})),r.triggerPegLoggerEvent($j(this),"click"),a&&window.setTimeout(function(){document.location.href=t},2e3)}})},addParamsToParmacontoLink:function(e){var t=e.find("a").attr("href");if(null!=t){var a=-1===t.lastIndexOf("?")?"?":"&",r=t+a+("target_id="+e.data("urc-id"))+("&urcTitle="+e.data("urc-title"))+("&slotName="+e.parents(".urcCard").attr("id"))+("&displaySize="+jPar.wdk.screensize.getCurrentScreenSize());e.attr("href",r)}},triggerPegLoggerEvent:function(e,t){var a=e.data("urc-slot"),r=e.data("urc-id"),i=e.data("urc-title");jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"parmacontoTeaser",subcategory:a,targetId:r+":"+i,action:t})}},registration:{trackLayer:function(e){jPar.util.log.devConsole("Deprecated Tracking.registration.trackLayer() ",e)}},trackVirtualPage:function(e){jPar.util.log.devConsole("Deprecated Tracking.trackVirtualPage() ",e)},paymentLayer:function(e){var t="payment/";void 0!==$j(".config").data("trackingPage")&&(t+=$j(".config").data("trackingPage")),void 0!==$j(".config").data("trackingPageVariation")&&(t=t+"_"+$j(".config").data("trackingPageVariation")+"/");var a=t+e;jPar.util.log.devConsole("Deprecated Tracking.paymentLayer() ",a)}}}),jPar.util=jPar.util||{},$j.extend(!0,jPar.util,{setCookie:function(e,t){var a=new Date;a.setTime(a.getTime()+85536e5);var r=e+"="+t+"; path=/; domain="+this.getTopLevelDomain()+"; expires="+a.toGMTString()+";";document.cookie=r},getCookie:function(e){var t=document.cookie.split(" ");if(void 0!==t)for(var a=0;a<t.length;a++){var r=t[a].split("=");if(r[0]===e)return r.slice(1).join("=")}return null},loadScript:function(e,t){var a=$j("#domPageVars").data("jsPath"),r=document.createElement("script"),i="";-1<document.location.href.indexOf(".dev")&&!0===$j("#domPageVars").data("useCacheBreaker")&&(i="?ts"+$j.now()),-1<e.indexOf("https:")?r.setAttribute("src",e):r.setAttribute("src",a+e+".js"+i),document.getElementsByTagName("head")[0].appendChild(r),r.onloadDone||void 0===t||(r.onloadDone=!0,r.onload=function(){t()})},vibrate:function(){void 0!==window.navigator.vibrate&&window.navigator.vibrate(50)},getTopLevelDomain:function(){var e=location.hostname,t=e.match(/(.co.uk|.com.mx|.com.au)$/)?-3:-2;return e.split(".").slice(t).join(".")},scrollToElement:function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:300;t||(t=0),$j("html, body, #pageWrapper").animate({scrollTop:$j(e).offset().top+t},a)},putCursorAtEnd:function(e){if(0<$j("html.no-touchevents").length){var t=e.val();e.trigger("focus"),e.val(""),e.val(t)}},setFocusOnFirstFocusableElement:function(e){e.filter("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]").filter(":visible:not([aria-hidden=true])").first().focus()},prefixedAnimationEndEvent:{animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"}[Modernizr.prefixed("animation")]}),jPar.util=jPar.util||{},$j.extend(!0,jPar.util,{pwa:{webappServiceWorker:void 0,init:function(){0<$j("#offlineError").length&&(this.createServiceWorker(),this.installOption.init(),this.offline.init(),this.checkStandalone()),0<$j("#serviceWorkerKillSwitch").length&&this.unregisterServiceWorker()},createServiceWorker:function(){var t=this;"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker").then(function(e){t.webappServiceWorker=e})},unregisterServiceWorker:function(){"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(e){0<e.length&&(console.log("Hat sw installed"),e[0].unregister("/service-worker").then(function(){jPar.util.log.devConsole("Successfully uninstalled ServiceWorker")},function(e){jPar.util.log.devConsole("Failed to uninstall: "+e)}))})},offline:{init:function(){this.checkOnlineState(),$j("#offlineError").on("animationend webkitAnimationEnd",function(){$j("#offlineError").removeClass("attention"),$j("#offlineError").removeClass("hardAttention")})},forceClearAllCaches:function(){navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage({command:"clearAllCaches",message:"true"}):console.log("No ServiceWorker")},checkOnlineState:function(){var e=this;!1===navigator.onLine&&e.prepareOfflineMode(),window.addEventListener("offline",function(){e.prepareOfflineMode()}),window.addEventListener("online",function(){$j("#offlineError").addClass("noDisplay"),$j("html").removeClass("is-offline"),$j(".js-onlineOnly").off("click.onlineOnly")})},prepareOfflineMode:function(){var t=this;$j("#offlineError").removeClass("noDisplay").addClass("attention"),$j("html").addClass("is-offline"),$j(".js-onlineOnly").on("click.onlineOnly",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),t.triggerOfflineAttention()})},triggerOfflineAttention:function(e){$j("#offlineError").removeClass("attention"),$j("#offlineError").removeClass("attention"),$j("#offlineError").css("color"),e?$j("#offlineError").addClass("hardAttention"):$j("#offlineError").addClass("attention")}},installOption:{installPrompt:void 0,init:function(){if("serviceWorker"in navigator){var t=this;window.addEventListener("beforeinstallprompt",function(e){e.preventDefault(),t.installPrompt=e,t.showInstallButton(),$j(".js-installPwa").on("click",function(e){e.preventDefault(),t.hideInstallButton(),t.handlePrompt()})}),window.addEventListener("appinstalled",function(e){console.log("INSTALL: Success",e)})}},showInstallButton:function(){$j(".js-installPwa").parent("li").removeClass("noDisplay")},hideInstallButton:function(){$j(".js-installPwa").parent("li").addClass("noDisplay")},handlePrompt:function(){this.installPrompt.prompt(),this.installPrompt.userChoice.then(function(e){"accepted"===e.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt")})}},checkStandalone:function(){var e=window.matchMedia("(display-mode: standalone)").matches,t=!0===window.navigator.standalone;(e||t)&&$j("html").addClass("is-inPWA")}}}),jPar.util=jPar.util||{},$j.extend(!0,jPar.util,{log:{error:function(e,t){try{console.trace("%c----CAUGHT ERROR: "+e+" -> "+t.toString()+" ----","color: red; font-size: 14px;"),jPar.util.customEvent.trigger("pegLogger-logJsError",{message:e,stacktrace:t.toString(),origin:"Caught_JSError"})}catch(e){console.error("call of jPar.util.log.error() failed")}},ui:function(e,t,a){try{jPar.util.log.devConsole("---------------- Deprecated UI_Logging: "+e+" -> "+t+" -> "+a+" ----------------")}catch(e){console.error("UI logging failed")}},devConsole:function(e){0<$j("#domPageVars").length&&((void 0!==$j("#domPageVars").data("isDevSystem")||-1<document.location.href.indexOf(".dev"))&&console.log(e))}}}),jPar.util=jPar.util||{},$j.extend(!0,jPar.util,{network:{hasValidSessionAndCsrfToken:function(e){return void 0!==e&&e.hasOwnProperty("status")?403!==e.status:"string"!=typeof e||-1===e.indexOf("<html")&&-1===e.indexOf("<body")&&-1===e.indexOf("loginForm")},reloadIfResponseInvalid:function(e){if(!(1<arguments.length&&void 0!==arguments[1]&&arguments[1])&&!1!==this.hasValidSessionAndCsrfToken(e))return!0;jPar.wdk.modalbox.show({modalboxId:"#errorModalboxSessionExpired"}),window.setTimeout(function(){var e=document.URL,t=e.lastIndexOf("#"),a=e.substring(0,t);location.replace(a)},500)},reloadForSessionExpired:function(){this.reloadIfResponseInvalid(null,!0)},setGlobalAjaxTimeout:function(){$j.ajaxSetup({timeout:"15000"})}}}),jPar.util=jPar.util||{},$j.extend(!0,jPar.util,{customEvent:{trigger:function(e,t,a){this._polyfillCustomEvent();var r=new CustomEvent(e,{detail:t});void 0!==a?a.dispatchEvent(r):document.dispatchEvent(r)},_polyfillCustomEvent:function(){!function(){if("CustomEvent"in window&&"function"==typeof window.CustomEvent)return;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),a}e.prototype=window.Event.prototype,window.CustomEvent=e}()},hasPassiveListener:function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(e){}return!!e&&{passive:!0}}}}),jPar.util=jPar.util||{},$j.extend(!0,jPar.util,{loadURCviaAjax:{init:function(){var e=this;e.loadVisibleContents(),$j(window).on("resize",function(){e.loadVisibleContents()})},loadVisibleContents:function(){var t=this;$j(".js-loadURCviaAjax").not(".is-loading").each(function(){var e=$j(this).data("showInViewports").split(",");jPar.wdk.screensize.isBreakpoint(e)&&0===$j("html.is-offline").length&&t.loadContent($j(this))})},loadContent:function(i){i.addClass("is-loading");var o=i.data("slotname"),e=i.data("viewname"),t=i.data("showInViewports"),a=i.data("wrapperTemplate"),r="";"pc_logoutpage"===o&&0<$j("html.localstorage").length&&(r=null!==localStorage.getItem("userId")?localStorage.getItem("userId"):"");var n="/urcontent",s="";-1<document.location.href.indexOf("showURC")?(n+="?showURC",s='<p class="showURCName">'+o+" ("+t+")</p>"):-1<document.location.href.indexOf("preventExternalContent")&&(n+="?preventExternalContent"),$j.ajax({type:"GET",url:n,data:{slot:o,viewname:e,wrapper:a,userId:r},success:function(e){if(void 0!==e&&!0===jPar.util.network.hasValidSessionAndCsrfToken(e))if(-1<e.indexOf(' data-urclayout="')){var t=e;-1<e.indexOf("document.write(")&&(t=e.replace("document.write(","console.log("),jPar.util.log.error(o,"document.write found in URCSlot"));var a=i.parents("article");i.replaceWith(s+t);var r=a.find("div[data-urclayout]");r[0].setAttribute("data-urc-slot",o),$j(".urcWrapper").css("color"),$j(".urcWrapper").removeClass("is-hidden"),"pc_welcomepage_infolayer"===o&&jPar.app.welcomePage.earlyBirdLayer.open(),jPar.Tracking.parmacontoTeaser.slotLoaded(r),jPar.Tracking.parmacontoTeaser.slotViewed(r),jPar.Tracking.parmacontoTeaser.slotClicked(r),jPar.Tracking.parmacontoTeaser.addParamsToParmacontoLink(r)}else i.remove(),""!==$j.trim(e)&&jPar.util.log.error(o+" - "+e,"invalid content returned for URCSlot")},error:function(){i.remove()}})}}}),jPar.util=jPar.util||{},$j.extend(!0,jPar.util,{validate:{checkboxIsChecked:function(e){return!0===e.prop("checked")},selectBoxHasValue:function(e,t){return $j.trim(e.val())===t},radioIsSelected:function(e){return 0<e.filter(":checked").length},textfieldIsEmpty:function(e){return""===$j.trim(e.val())},hasMinimumWordsFilled:function(e,t){var a=new RegExp("([^ ]+ +){"+(t-1)+",}[^ ]+","g"),r=$j.trim(e.val());return a.test(r)},isNumber:function(e){var t=e.val().trim().replace(/ /g,"");return $j.isNumeric(t)},isEmailAddress:function(e){return!0===/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.val())},isNotTabOrShiftKey:function(e){return 9!==e&&16!==e},isMouseclickEnterOrSpaceKey:function(e){return void 0===e||0===e||13===e||32===e}}}),jPar.util=jPar.util||{},$j.extend(!0,jPar.util,{timezone:{setTimezone:function(){if(0<$j("html.localstorage").length){var t=this,e=null===sessionStorage.getItem("hasFreshTimezoneForSession"),a=null===jPar.util.getCookie("timezone");if(e||a)try{var r=t.getTimezoneForModernBrowsers();t.writeTimezoneToCookie(r)}catch(e){jPar.util.loadScript("polyfill_timezone",function(){var e=jstz.determine().name();t.writeTimezoneToCookie(e)})}}},getTimezoneForModernBrowsers:function(){if("string"!=typeof Intl.DateTimeFormat().resolvedOptions().timeZone)throw new Error("Timezone could not be resolved by Intl.DateTimeFormat");return Intl.DateTimeFormat().resolvedOptions().timeZone},writeTimezoneToCookie:function(e){jPar.util.setCookie("timezone",e),sessionStorage.setItem("hasFreshTimezoneForSession",!0)}}}),jPar.util=jPar.util||{},$j.extend(!0,jPar.util,{zipAutofill:{init:function(){var t=this;jPar.wdk.forms.autofillDropdown.initTextfield("#zipAutofill",function(e){t.getGeoData(e)}),$j(".js-autofillDropdownTextfield").on("focus",function(){var e=$j("#zipForBackend").val();$j(this).val("").val(e),t.clearDropdown()}),this.setInputType()},getGeoData:function(e){var t=this,a=e.val().trim(),r=$j("#country").val(),i=this.getAutofillMinLength(),o=$j('#personaldataForm input[name="access_token"]').val();if(a.length>=i&&a.length<=10){var n=e.data("listUrl");jPar.wdk.forms.hideError($j("#zipListLoadingError")),jPar.wdk.loadingIndicator.show($j("#zipAutofill .wdk_loadingIndicator")),$j.ajax({type:"GET",url:n,data:{access_token:o,countryCode:r,zip:a},success:function(e){jPar.wdk.loadingIndicator.hide($j("#zipAutofill .wdk_loadingIndicator")),window.setTimeout(function(){jPar.wdk.loadingIndicator.hide($j("#zipAutofill .wdk_loadingIndicator"))},2e3),t.handleSuccess(e)},error:function(){jPar.wdk.forms.showError($j("#zipListLoadingError")),t.clearDropdown()}})}else t.clearDropdown()},clearDropdown:function(){jPar.wdk.loadingIndicator.hide($j("#zipAutofill .wdk_loadingIndicator")),jPar.wdk.forms.autofillDropdown.close($j(".wdk-form-autofillDropdown .autofillDropdownDatalist")),$j("#geoDataList .selection").empty(),$j("#zipAutofill").find("input#zipForBackend").val("").trigger("change")},isValidSuccessResponse:function(e){try{return"object"===_typeof(e)&&void 0!==e.zipLocations}catch(e){return jPar.util.log.error(e,"jPar.app.zipAutofill: Ajax-Success-Handling failed"),!1}},handleSuccess:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):this.isValidSuccessResponse(e)?(this.fillGeoList(e),jPar.wdk.forms.autofillDropdown.initList("#zipAutofill",function(e){$j("#zipAutofill").find("input#zipForBackend").val(e.data("zip")).trigger("change"),$j("#zipAutofill").find("input#hiddenCity").val(e.data("city")),$j("#zipAutofill").find("input#hiddenStateCode").val(e.data("stateCode"))}),jPar.wdk.forms.autofillDropdown.open($j(".wdk-form-autofillDropdown .autofillDropdownDatalist"))):jPar.wdk.forms.showError($j("#zipListLoadingError"))},getAutofillMinLength:function(){return $j("#country option:selected").data("autocompleteMin")},fillGeoList:function(e){var t=e.zipLocations;if(0===t.length){var a=0===$j("#geoDataList.is-open").length,r=0<$j("#geoDataList.is-open li.noResult").length,i=$j("#zipAutofill #zip").val().trim().length<this.getAutofillMinLength();if(a||r||i){$j("#geoDataList .selection").empty();var o=$j(".selection").data("emptyText"),n=$j('<li class="noResult">'.concat(o,"</li>"));$j("#geoDataList .selection").append(n)}}else{$j("#geoDataList .selection").empty();for(var s=this.checkAllStatesAreEqual(t),l=0;l<t.length;l++){var d=t[l],c=void 0,p='<li id="autocompleteOption'.concat(l+1,'" role="option" data-zip="').concat(d.zip,'" data-city="').concat(d.city,'" data-state-code="').concat(d.stateCode,'" data-state="').concat(d.state,'">');jPar.wdk.brands.forBrands(["ps","ep"])?c=s?"<span>".concat(d.zip,"</span> <span>").concat(d.city,"</span>"):"<span>".concat(d.zip,"</span> <span>").concat(d.city,"</span> - <span>").concat(d.state,"</span>"):jPar.wdk.brands.forBrands(["eh"])&&(c="<span>".concat(d.zip,"</span> <span>").concat(d.city,"</span>, <span>").concat(d.stateCode,"</span>"));var u=$j(p+c+"</li>");$j("#geoDataList .selection").append(u)}}},setInputType:function(){var e=$j("#country").val();"DE"===e||"AT"===e||"CH"===e?($j("#zip").attr("type","tel"),$j("#zip").attr("inputmode","numeric")):($j("#zip").attr("type","text"),$j("#zip").removeAttr("inputmode"))},checkAllStatesAreEqual:function(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(e[a].state);return t.every(function(e,t,a){return e===a[0]})}}}),jPar.util=jPar.util||{},$j.extend(!0,jPar.util,{legacyBrowser:{init:function(){try{var r=this;Modernizr.addTest("legacybrowser",function(){var e=!1;0<$j("html.localstorage").length&&(e="true"!==sessionStorage.getItem("hideLegacyBrowserBar"));var t=bowser.android&&bowser.osversion&&bowser.osversion.split(".")[0]<3,a=bowser.c||t||r.isAndroidStockBrowser();if(e&&a)return!0}),Modernizr.addTest("androidstockbrowser",function(){return r.isAndroidStockBrowser()}),$j("#legacyBrowser .hideInfoBar").on("click",function(e){e.preventDefault(),r.hideInfoBar()}),this.svgIconPolyfill(),this.customPropertiesPolyfill()}catch(e){jPar.util.log.error(e,"jPar.util.legacyBrowser.init failed")}},isAndroidStockBrowser:function(){var e=navigator.userAgent,t=-1<e.indexOf("Android")&&-1<e.indexOf("Mozilla/5.0")&&-1<e.indexOf("AppleWebKit"),a=new RegExp(/AppleWebKit\/([\d.]+)/),r=null===a.exec(e)?null:parseFloat(a.exec(e)[1]),i=new RegExp(/Chrome\/([\d.]+)/).exec(e);return t&&null===i&&null!==r&&parseFloat(r)<parseFloat(537.36)},isSupported:function(){var e=void 0!==bowser.android&&bowser.android&&bowser.osversion&&bowser.osversion.split(".")[0]<3,t=void 0!==bowser.msedge&&bowser.msedge&&bowser.version<80;return!1===(bowser.c||e||this.isAndroidStockBrowser()||t)},hideInfoBar:function(){$j("html").removeClass("legacybrowser"),0<$j("html.localstorage").length&&sessionStorage.setItem("hideLegacyBrowserBar",!0)},svgIconPolyfill:function(){0<$j("html.ie").length&&jPar.util.loadScript("polyfill_svg4everybody",function(){svg4everybody()})},customPropertiesPolyfill:function(){$j("html").hasClass("ie")&&jPar.util.loadScript("ie11CustomProperties")}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{navigation:{init:function(){var t=this;t.swiper.init(),t.burgerMenu.init(),t.scroll.init(),t.myProfileDropdown.init(),jPar.wdk.countdownClock.start("#bannerInTopNavi"),this.initSkipNavigation(),null!==document.querySelector("#conversationArea")&&document.querySelector("#conversationArea").addEventListener("messengerConversationArea:updateMessageCount",function(e){t.updateMessageCounter(e.detail.currentReadMessageCount)})},initSkipNavigation:function(){$j(".skipNavigation").bind("click",function(e){e.preventDefault(),jPar.util.setFocusOnFirstFocusableElement($j("#content *"))})},updateMessageCounter:function(e){var t=$j("#topNavi #messenger .bubble").text(),a=parseInt(t)+parseInt(e),r=$j("#topNavi #messenger .bubble"),i=$j("#burgerMenu .messenger .bubble");r.text(a),0<i.length&&i.text(a),a<=0?(r.removeClass("is-visible"),0<i.length&&i.removeClass("is-visible")):(r.addClass("is-visible"),0<i.length&&i.addClass("is-visible"))},myProfileDropdown:{init:function(){try{var t=this;0<$j("#topNavi #myProfile").length&&($j("#topNavi #myProfile > a").off("click"),$j("#topNavi #myProfile > a").on("click",function(e){t.open(e)}))}catch(e){jPar.util.log.error(e,"jPar.app.navigation.myProfileDropdown.init")}},open:function(e){var t=this;e.preventDefault(),e.stopPropagation();var a=$j("#pageHeader #myProfile");a.hasClass("is-open")?t.close():(a.addClass("is-open"),a.find("a:first-of-type").attr("aria-expanded","true"),$j(".myProfileDropdown").attr("aria-hidden","false"),$j(".myProfileDropdown ul").removeAttr("inert"),$j("body").on("click.myProfileDropdown",function(e){$j(e.target).is(".myProfileDropdown")||$j(e.target).parents(".myProfileDropdown").length||t.close()}))},close:function(){$j("#pageHeader #myProfile").removeClass("is-open"),$j("#pageHeader #myProfile").find("a:first-of-type").attr("aria-expanded","false"),$j("#pageHeader #myProfile").find(".myProfileDropdown ul").attr("aria-hidden","true"),$j("body").off("click.myProfileDropdown")}},burgerMenu:{init:function(){try{if(0<$j("#ps_page, #pageWrapper").length&&0<$j("#burgerMenu").length){var t=this;$j("#openBurger a").on("click",function(e){t.openBurger(e)}),$j(document).on("ajaxShellPage:loadingDone",function(){jPar.app.navigation.burgerMenu.closeBurger()})}}catch(e){jPar.util.log.error(e,"jPar.app.navigation.burgerMenu.init")}},openBurger:function(e){var r=this;e.preventDefault(),e.stopPropagation(),$j("#ps_page, #pageWrapper, #closeBurgerMenu").on("click.burgerMenuEvent touchstart.burgerMenuEvent",function(e){var t=!$j(e.target).is("#closeBurgerMenu")||$j(e.target).parents("#closeBurgerMenu").length,a=$j(e.target).is("#burgerMenu")||$j(e.target).parents("#burgerMenu").length;t&&a||(r.closeBurger(),e.preventDefault(),$j("#ps_page, #pageWrapper, #closeBurgerMenu").off(".burgerMenuEvent"))}),$j("html").addClass("burgerOpened"),$j("#burgerMenu").attr("aria-hidden","false"),$j("#burgerMenu").removeClass("a11y-visibilityHidden"),$j("#burgerMenuToggle").attr("aria-expanded","true"),$j("#burgerMenu").focus(),$j("#topNavi").attr("aria-hidden","true"),$j("#topNavi").attr("inert",!0),$j("#secondaryNavi").attr("aria-hidden","true"),$j("#secondaryNavi").attr("inert",!0),$j("#content").attr("aria-hidden","true"),$j("#content").attr("inert",!0),$j("footer").attr("aria-hidden","true"),$j("footer").attr("inert",!0)},closeBurger:function(){$j("html").removeClass("burgerOpened"),$j("#burgerMenu, #burgerMenu *").off("swipe"),$j("#burgerMenu").addClass("a11y-visibilityHidden"),$j("#ps_page, #pageWrapper, #closeBurgerMenu").off("click.burgerMenuEvent"),$j("#burgerMenu").attr("aria-hidden","true"),$j("#burgerMenuToggle").attr("aria-expanded","false"),$j("#burgerMenu").blur(),$j("#topNavi").attr("aria-hidden","false"),$j("#topNavi").removeAttr("inert"),$j("#secondaryNavi").attr("aria-hidden","false"),$j("#secondaryNavi").removeAttr("inert"),$j("#content").attr("aria-hidden","false"),$j("#content").removeAttr("inert"),$j("footer").attr("aria-hidden","false"),$j("footer").removeAttr("inert")}},scroll:{conf:{previousTop:0,classHidden:"fadeOut",pageHeaderHeight:0,$document:null,$window:null,$pageHeader:null,throttleTimeout:500,throttleLast:null,throttleTimer:null},init:function(){try{if(0<$j("#pageHeader").length){var e=this;e.conf.$window=$j(window),e.conf.$document=$j(document),e.conf.$pageHeader=$j("#pageHeader"),e.conf.pageHeaderHeight=e.conf.$pageHeader.height(),e.handleIsScrolled(),document.addEventListener("scroll",function(){e.handleIsScrolled(),e.throttle(e.conf.throttleTimeout,e.handleFixedHeaderPosition)},{passive:!0}),document.addEventListener&&document.addEventListener("touchmove",e.handleFixedHeaderPosition,!1)}}catch(e){jPar.util.log.error(e,"jPar.app.navigation.scroll.init")}},throttle:function(e,t){var a=this.conf.throttleTimer,r=this.conf.throttleLast,i=this,o=arguments,n=+new Date;r&&n<r+e?(clearTimeout(a),a=setTimeout(function(){r=n,t.apply(i,o)},e)):(r=n,t.apply(i,o))},handleFixedHeaderPosition:function(){try{jPar.wdk.screensize.isBreakpoint(["M","S"])?jPar.app.navigation.scroll.setHeaderPositioningForMAndS():jPar.app.navigation.scroll.resetHeaderPosition()}catch(e){}},handleIsScrolled:function(){this.conf.$window.scrollTop()<20?this.conf.$pageHeader.removeClass("is-scrolled"):this.conf.$pageHeader.addClass("is-scrolled")},resetHeaderPosition:function(){this.conf.$pageHeader.addClass("fixed"),this.conf.$pageHeader.removeClass("fadeOut")},setHeaderPositioningForMAndS:function(){try{var e=$j(window).scrollTop(),t=this.conf.previousTop-e;e<=0?this.conf.$pageHeader.removeClass(this.conf.classHidden):0<t&&this.conf.$pageHeader.hasClass(this.conf.classHidden)?this.conf.$pageHeader.removeClass(this.conf.classHidden):t<0&&e>this.conf.pageHeaderHeight&&(e+this.conf.$window.height()>=this.conf.$document.height()&&this.conf.$pageHeader.hasClass(this.conf.classHidden)?this.conf.$pageHeader.removeClass(this.conf.classHidden):(this.conf.$pageHeader.addClass(this.conf.classHidden),jPar.app.navigation.myProfileDropdown.close())),this.conf.previousTop=e}catch(e){}}},swiper:{init:function(){if(null!==document.querySelector("#topNavi .swiperWrapper")){void 0!==dragscroll&&dragscroll.reset();var e=document.querySelector("#topNavi .swiperWrapper li.active");null!==e&&e.scrollIntoView({inline:"start"})}}}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{brands:{forBrands:function(e){if(0<$j("#domPageVars").length)return e.some(function(e){return $j("#domPageVars").data("brandId")===e});window.setTimeout(function(){return e.some(function(e){return $j("#domPageVars").data("brandId")===e})},1e3)}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{screensize:{getCurrentScreenSize:function(){var t,e=$j(window).width();try{t=(t=window.getComputedStyle(document.body,":after").getPropertyValue("content")).replace(/"/g,"").replace(/'/g,"")}catch(e){t="XL"}return"S"!==t&&"M"!==t&&"L"!==t&&"XL"!==t&&(0<=e&&e<481?t="S":481<=e&&e<768?t="M":768<=e&&e<980?t="L":980<=e?t="XL":(t="XL",jPar.util.log.error("windowWidth: "+e,"windowWidth and Breakpoints somehow fucked up"))),t},isBreakpoint:function(e){return-1<e.indexOf(jPar.wdk.screensize.getCurrentScreenSize())},setScreenSizeCookie:function(){try{var e=this.getCurrentScreenSize();setCookie("currentScreenSize",e),0<$j("#specialOfferScreensize").length&&$j("#specialOfferScreensize").val(e)}catch(e){jPar.util.log.error("failed to set screensize-cookie on page "+$j("body").attr("id")+" - "+e,"jPar.wdk.screensize.setScreenSizeCookie()")}}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{security:{_charsToHTMLEntityMap:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_htmlEntityToCharMap:{"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},sanitizeStringForHtml:function(e){var t=this;return String(e).replace(/[&<>"']/g,function(e){return t._charsToHTMLEntityMap[e]})},htmlEntitiesToChars:function(e){var t=this;return String(e).replace(/&[^;]+;/g,function(e){return""!==t._htmlEntityToCharMap[e]?t._htmlEntityToCharMap[e]:e})},getCsrfToken:function(){var e="";return 0<$j("meta[name=_csrf]").length&&(e=$j("meta[name=_csrf]").attr("content")),e}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{cardDeck:{conf:{currentCardPositionFor:"sm"},init:function(){if($j(".wdk-cardDeck.js-withMagicCards")){var e=this;this.conf.currentCardPositionFor="sm",e.storeOriginalPosition(),e.shuffleCards(),$j(window).on("resize",function(){e.shuffleCards()})}},storeOriginalPosition:function(){$j(".wdk-cardDeck.js-withMagicCards article[data-2column-position]").each(function(e,t){$j(t).data("1columnOrder",e+1)})},shuffleCards:function(){var e="sm"!==this.conf.currentCardPositionFor,t="lxl"!==this.conf.currentCardPositionFor;jPar.wdk.screensize.isBreakpoint(["S","M"])&&e?this.switchToOneColumn():jPar.wdk.screensize.isBreakpoint(["L","XL"])&&t&&this.switchToTwoColumns()},switchToOneColumn:function(){$j(".wdk-cardDeck.js-withMagicCards").each(function(e,t){var a=$j(t),r=a.find(".primaryCol");a.find("article[data-2column-position]").sort(function(e,t){var a=$j(e).data("1columnOrder"),r=$j(t).data("1columnOrder");return r<a?1:a<r?-1:0}).appendTo(r)}),this.conf.currentCardPositionFor="sm"},switchToTwoColumns:function(){$j(".wdk-cardDeck.js-withMagicCards").each(function(e,t){var a=$j(t).find(".primaryCol"),r=$j(t).find(".secondaryCol");a.find('[data-2column-position*="secondary"]').prependTo(r),$j(".wdk-cardDeck.js-withMagicCards").addClass("shuffleDone")}),this.conf.currentCardPositionFor="lxl"}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{modalbox:{conf:{},show:function(e){jPar.wdk.modalbox.hide(!0),this.setConfig(e),this.conf.isAjaxModalbox?this.loadAjax():this.loadInline()},setConfig:function(e){this.conf={$currentModalbox:null,jqxhr:null,isAjaxModalbox:!1,url:null,ajaxSettings:null,closeOnBgClick:!1,closeOnEsc:!1,originalPageScrollPosition:null,previousActiveElement:null,onSuccess:null,onFail:null,onAlways:null,onBeforeClose:null,perfectScrollbarObj:null};var t=$j(e.modalboxId);-1===e.modalboxId.indexOf("#")&&(t=$j("#"+e.modalboxId));var a=t;if(!(0<a.length))throw jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),new Error("wdkmodalbox: Modalbox ID not found on Page "+e.modalboxId);void 0!==(this.conf.$currentModalbox=a).data("url")&&(this.conf.isAjaxModalbox=!0,this.conf.url=a.data("url"),void 0!==e.ajaxSettings&&(this.conf.ajaxSettings=e.ajaxSettings),void 0!==e.onFail&&(this.conf.onFail=e.onFail),void 0!==e.onAlways&&(this.conf.onAlways=e.onAlways)),void 0!==a.data("closeOnBgClick")&&(this.conf.closeOnBgClick=a.data("closeOnBgClick")),void 0!==a.data("closeOnEsc")&&(this.conf.closeOnEsc=a.data("closeOnEsc")),this.conf.originalPageScrollPosition=$j(document).scrollTop(),this.conf.previousActiveElement=document.activeElement,void 0!==e.onSuccess&&(this.conf.onSuccess=e.onSuccess),void 0!==e.onBeforeClose&&(this.conf.onBeforeClose=e.onBeforeClose)},loadAjax:function(){var r=this,i=this.conf.$currentModalbox,e="";null!==r.conf.ajaxSettings&&(e=r.conf.ajaxSettings),this.conf.jqxhr=$j.ajax(r.conf.url,e).done(function(e){r.handleSessionExpired(e),i.html(e),r.setCloseEvents(),r.handleSpecialDataConfigs(),r.makeVisible(),null!==r.conf.onSuccess&&r.conf.onSuccess()}).fail(function(e,t,a){"function"==typeof r.conf.onFail&&r.conf.onFail(e,t,a),r.handleNetworkErrors(e,t,a,i)}).always(function(){"function"==typeof r.conf.onAlways&&r.conf.onAlways()})},loadInline:function(){this.setCloseEvents(),this.makeVisible(),null!==this.conf.onSuccess&&this.conf.onSuccess()},handleSpecialDataConfigs:function(){0<this.conf.$currentModalbox.find("[data-set-small-content-class=true]").length&&this.conf.$currentModalbox.addClass("has-smallContent"),0<this.conf.$currentModalbox.find("[data-set-full-bg-image-class=true]").length&&this.conf.$currentModalbox.addClass("has-fullBgImage")},makeVisible:function(){var e;this.moveModalboxDomToBottom(),$j("html").addClass("has-modalboxOpen"),this.conf.$currentModalbox.hasClass("wdk-modalbox")?e=this.conf.$currentModalbox:0<this.conf.$currentModalbox.find(".wdk-modalbox").length&&(e=this.conf.$currentModalbox.find(".wdk-modalbox")),0<e.find("textarea").length&&e.addClass("has-textarea"),e.css("color"),e.addClass("is-open transition-in"),this.triggerPerfectScrollbar(),this.updatePerfectScrollbar(),this.fixSomeIosBugs(),this.setA11yForOpenModal(),this.setInitialFocus(),jPar.util.customEvent.trigger("wdk:modalbox:isOpened",{$modalboxObj:e})},setA11yForOpenModal:function(){var t=this;this.conf.$currentModalbox.attr("aria-hidden","false"),$j("#pageWrapper").attr("aria-hidden","true"),Array.prototype.slice.call(document.body.children).forEach(function(e){null!==e.getAttribute("inert")&&e.setAttribute("data-inert-before",!0),e!==t.conf.$currentModalbox[0]?e.setAttribute("inert",!0):e.removeAttribute("inert")})},setA11yForClosedModal:function(){this.conf.$currentModalbox.attr("aria-hidden","true"),$j("#pageWrapper").removeAttr("aria-hidden"),Array.prototype.slice.call(document.body.children).forEach(function(e){null!==e.getAttribute("data-inert-before")?(e.setAttribute("inert",!0),e.removeAttribute("data-inert-before")):e.removeAttribute("inert")})},setInitialFocus:function(){var e=this,t=null,a=0===this.conf.$currentModalbox.find(".js-focusField").length,r=0===this.conf.$currentModalbox.filter("[aria-labelledby]").length;a&&(0<this.conf.$currentModalbox.find("header h3").length&&""!==this.conf.$currentModalbox.find("header h3").text().trim()?t="header h3":0<this.conf.$currentModalbox.find("h3").length&&""!==this.conf.$currentModalbox.find("h3").text().trim()?t="h3":0<this.conf.$currentModalbox.find("header").length&&""!==this.conf.$currentModalbox.find("header").text().trim()?t="header":0<this.conf.$currentModalbox.find("article").length&&(t="article"),r&&null!==t?this.conf.$currentModalbox.one("transitionend",function(){e.conf.$currentModalbox.find(t).attr("tabindex","0").focus()}):this.conf.$currentModalbox.one("transitionend",function(){jPar.util.setFocusOnFirstFocusableElement(e.conf.$currentModalbox.find("article *"))}))},setPreviousFocus:function(){var e=this;this.conf.$currentModalbox.one("transitionend",function(){e.conf.previousActiveElement.focus()})},hide:function(e){if(0<$j(".wdk-modalbox.is-open").length){var t=this;if(null===this.conf.onBeforeClose||!0===this.conf.onBeforeClose()){var a=$j(".wdk-modalbox.is-open");a.one("transitionend",function(){$j("html").removeClass("has-modalboxOpen"),t.moveModalboxDomToOriginalPosition(),$j(".wdk-modalbox.is-open").removeClass("is-open transition-out"),t.removeEventListener(),$j(document).scrollTop(t.conf.originalPageScrollPosition),jPar.util.customEvent.trigger("wdk:modalbox:isHidden",{$modalboxObj:a})}),a.removeClass("transition-in").addClass("transition-out"),this.setA11yForClosedModal(),this.setPreviousFocus(),(e||jPar.wdk.screensize.isBreakpoint(["S","M"]))&&a.trigger("transitionend")}}},closeCurrentModalbox:function(){0<$j(".wdk-modalbox.is-open").length&&jPar.wdk.modalbox.hide(!0)},moveModalboxDomToBottom:function(){$j('<div class="modalboxPlaceholder"></div>').insertBefore(this.conf.$currentModalbox),this.conf.$currentModalbox.detach().appendTo("body")},moveModalboxDomToOriginalPosition:function(){this.conf.isAjaxModalbox?($j(".wdk-modalbox.is-open").empty(),$j(".wdk-modalbox.is-open").remove().insertAfter(".modalboxPlaceholder")):$j(".wdk-modalbox.is-open").insertAfter(".modalboxPlaceholder"),$j(".modalboxPlaceholder").remove()},removeEventListener:function(){$j(document).off(".modalboxEvent"),$j(document).off("touchmove"),$j("body").off("touchstart",".scrollable"),$j("body").off("touchmove",".scrollable")},setCloseEvents:function(){var a=this,e="#"+this.conf.$currentModalbox.attr("id")+" .js-closeModalbox";$j(document).on("click.modalboxEvent",e,function(e){e.preventDefault(),a.hide()}),!0===this.conf.closeOnBgClick&&$j(document).on("mousedown.modalboxEvent",function(e){var t=e.target;$j(t).is(".wdk-modalbox .modalboxContent")||$j(t).parents().is(".wdk-modalbox .modalboxContent")||a.hide()}),!0===this.conf.closeOnEsc&&$j(document).on("keyup.modalboxEvent",function(e){27===e.keyCode&&a.hide()})},handleNetworkErrors:function(e,t,a,r){this.conf.jqxhr.fail(function(){"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),0!==e.status&&jPar.util.log.error(r.attr("id")+" on Page "+$j("body").attr("id")+" reported "+e.status+" - "+a,"Error opening wdkmodalbox"))})},handleSessionExpired:function(e){if(!1===jPar.util.network.hasValidSessionAndCsrfToken(e))throw jPar.util.network.reloadIfResponseInvalid(e),new Error("wdkmodalbox: Session expired")},triggerPerfectScrollbar:function(){var e="undefined"!=typeof PerfectScrollbar,t=jPar.wdk.screensize.isBreakpoint(["L","XL"]),a=0<$j("html.no-touchevents").length;if(e&&t&&a)try{this.conf.perfectScrollbarObj=new PerfectScrollbar(".wdk-modalbox.is-open .js-scrollableContent")}catch(e){}},updatePerfectScrollbar:function(){null!==this.conf.perfectScrollbarObj&&this.conf.perfectScrollbarObj.update()},fixSomeIosBugs:function(){$j("html").hasClass("ios")&&($j("body").css("position","fixed"),$j(document).one("wdk:modalbox:isHidden",function(){$j("body").css("position","initial")}))}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{hintbox:{addClassNoDisplay:function(e){e.addClass("noDisplay"),e.removeAttr("role"),e.attr("aria-hidden","true"),e.attr("inert","true")},removeClassNoDisplay:function(e){e.removeClass("noDisplay"),e.attr("role","alert"),e.attr("aria-hidden","false"),e.removeAttr("inert")},addClassIsVisible:function(e){e.addClass("is-visible"),e.attr("role","alert"),e.attr("aria-hidden","false"),e.removeAttr("inert")},removeClassIsVisible:function(e){e.removeClass("is-visible"),e.removeAttr("role"),e.attr("aria-hidden","true"),e.attr("inert","true")}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{forms:{props:{selector:""},init:function(e){this.textElement.init(e)},showError:function(e){e.addClass("is-visible"),e.attr("role","alert"),e.attr("aria-hidden","false"),e.removeAttr("inert");var t=e.parents(".wdk-form-text, .wdk-form-toggles, .wdk-form-dropdown, .wdk-form-customDropdown");0<t.length&&(t.addClass("has-error"),t.find("input").attr("aria-invalid","true"),t.find("input").attr("aria-describedby",e.attr("id")))},hideError:function(e){e.removeClass("is-visible"),e.removeAttr("role"),e.attr("aria-hidden","true"),e.attr("inert","true");var t=e.parents(".wdk-form-text, .wdk-form-toggles, .wdk-form-dropdown, .wdk-form-customDropdown");0===t.find(".error.is-visible").length&&(t.removeClass("has-error"),t.find("input").removeAttr("aria-invalid","false"),t.find("input").removeAttr("aria-describedby"))},hasVisibleErrors:function(e){return 0<e.find('.wdk-styledHintBox[class*=" t-error"].is-visible').length},textElement:{defaultSelector:".wdk-form-text",selector:"",init:function(e){this.setSelectorProperty(e),this.initCharCounter()},setSelectorProperty:function(e){this.selector=void 0!==e?e+" "+this.defaultSelector:this.defaultSelector},initCharCounter:function(){var t=this,e=$j(this.selector).find("textarea, input");e.on("keyup blur change paste cut",function(){var e=$j(this);window.setTimeout(function(){t.updateCounter(e)},10)}),e.each(function(){t.updateCounter($j(this))})},updateCounter:function(e){if(void 0!==e.attr("maxlength")){var t=e.attr("maxlength"),a=t/100*80,r=e.val().length,i=e.parents(this.selector),o=i.find(".limitReachedInfo");i.find(".charCounter span").text(r),a<=r?i.addClass("is-nearLimit"):i.removeClass("is-nearLimit"),t<=r?(i.addClass("is-limitReached"),0<o.length&&o.text(o.data("alertText"))):(i.removeClass("is-limitReached"),o.text(""))}}},customDropdown:{callback:null,isAnimating:!1,init:function(e,t){var a=this;this.callback=t,0<$j(e).length&&($j(e).find(".wdk-form-customDropdown a").off("click").on("click",function(e){!0!==a.isAnimating&&(a.isAnimating=!0,e.preventDefault(),a.toggle(e),setTimeout(function(){a.isAnimating=!1},280))}),$j(e).find(".wdk-form-customDropdown li").off("click").on("click",function(e){e.preventDefault(),a.selectCurrentElement(e)}))},toggle:function(e){var t=$j(e.target).parents(".wdk-form-customDropdown"),a=t.find(".selection");t.hasClass("is-open")?t.removeClass("is-open"):t.addClass("is-open"),a.slideToggle("fast")},selectCurrentElement:function(e){var t=$j(e.target);t.parents(".wdk-form-customDropdown").find(".selection").find("li").removeClass("selectedListItem"),t.addClass("selectedListItem"),t.parents(".wdk-form-customDropdown").find("a").html(t.html()),this.toggle(e),"function"==typeof this.callback&&(t.parents(".wdk-form-customDropdown").find('input[name="selectedItem"]').val(t.data("value")),this.callback(e))}},autofillDropdown:{callback:null,perfectScroller:null,initList:function(e,t){var a=this;this.callback=t,0<$j(e).length&&($j(e).find(".autofillDropdownDatalist li:not(.noResult)").off("click").on("click",function(e){e.preventDefault(),a.selectCurrentElement(e)}),null!==a.perfectScroller&&window.setTimeout(function(){a.perfectScroller.update()},200))},initTextfield:function(s,l){var d=this,c=1;this.callback=l,this.initPerfectScrollbar(s),this.preventEnterToSubmitForm(s),$j(s).find(".js-autofillDropdownTextfield").on("click",function(e){"function"==typeof d.callback&&l($j(e.target))}),$j(s).find(".js-autofillDropdownTextfield").on("keyup",function(e){e.preventDefault();var t=38===e.keyCode,a=40===e.keyCode,r=13===e.keyCode,i=$j(s).find(".autofillDropdownDatalist .selection li.isKeyboardSelected");if(t||a){var o=$j(s).find(".autofillDropdownDatalist .selection li").length;if(0<o){c=i.index()+1;var n=a&&c<o;t&&1<c?c-=1:n&&(c+=1),i.removeClass("isKeyboardSelected"),$j(s).find(".autofillDropdownDatalist .selection li:nth-child(".concat(c,")")).addClass("isKeyboardSelected"),$j(s).find(".js-autofillDropdownTextfield").attr("aria-activedescendant","autocompleteOption"+c),$j(s).find(".isKeyboardSelected").length&&$j(s).find(".isKeyboardSelected")[0].scrollIntoView(!0)}}else r&&1===i.length?i.trigger("click"):"function"==typeof d.callback&&l($j(e.target))})},preventEnterToSubmitForm:function(e){$j(e).find(".js-autofillDropdownTextfield").on("keydown",function(e){13===e.keyCode&&e.preventDefault()})},open:function(e){var t=e.find(".selection");e.parents(".row").find(".js-autofillDropdownTextfield").attr("aria-expanded","true"),e.addClass("is-open"),t.slideDown("fast")},close:function(e){var t=e.find(".selection");e.parents(".row").find(".js-autofillDropdownTextfield").attr("aria-expanded","false"),e.removeClass("is-open"),t.slideUp("fast")},selectCurrentElement:function(e){var t=$j(e.target);this.close(t.parents(".wdk-form-autofillDropdown .autofillDropdownDatalist"));var a=t.text();t.parents(".wdk-form-autofillDropdown").find(".js-autofillDropdownTextfield").val(a).trigger("blur"),"function"==typeof this.callback&&this.callback(t)},initPerfectScrollbar:function(e){var t="undefined"!=typeof PerfectScrollbar,a=jPar.wdk.screensize.isBreakpoint(["L","XL"]),r=0<$j("html.no-touchevents").length;if(t&&a&&r)try{this.perfectScroller=new PerfectScrollbar(e+".wdk-form-autofillDropdown .autofillDropdownDatalist")}catch(e){}}}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{toast:{conf:{defaultVisibleTime:4e3},show:function(e,t){var a=$j(e);a.addClass("is-visible"),a.attr("role","alert").attr("aria-live","assertive").attr("aria-atomic","true").removeAttr("aria-hidden"),window.setTimeout(function(){a.removeClass("is-visible"),a.removeAttr("role").removeAttr("aria-live").removeAttr("aria-atomic").attr("aria-hidden","true")},t||this.conf.defaultVisibleTime)}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{countdownClock:{start:function(i){0<$j(".wdk-countdownClock").length&&(0===$j(i).find(".clockFace .countSeconds").length&&$j(i).find(".clockFace").countdown({timestamp:new Date(parseInt($j(i).find(".clockFace").data("countdownEndTs"),10)),currentServerTime:new Date(parseInt($j(i).find(".clockFace").data("countdownStartTs"),10)),callback:function(e,t,a,r){parseInt($j(i).find(".clockFace").data("countdownEndTs"),10),parseInt($j(i).find(".clockFace").data("countdownStartTs"),10)}}))}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{loadingIndicator:{indicatorTimer:null,show:function(e){this.stopTimer(),1<e.length?(e instanceof jQuery&&(e=e.toArray()),e.forEach(function(e){e.classList.add("disabled"),e.disabled=!0,this.indicatorTimer=window.setTimeout(function(){e.classList.add("is-loading")},1500)})):(e instanceof jQuery&&(e=e[0]),void 0!==e&&(e.classList.add("disabled"),e.disabled=!0,this.indicatorTimer=window.setTimeout(function(){e.classList.add("is-loading")},1500)))},hide:function(e){this.stopTimer(),null!==e&&(1<e.length?(e instanceof jQuery&&(e=e.toArray()),e.forEach(function(e){e.classList.remove("disabled","is-loading"),e.disabled=!1})):(e instanceof jQuery&&(e=e[0]),void 0!==e&&(e.classList.remove("disabled","is-loading"),e.disabled=!1)))},stopTimer:function(){window.clearTimeout(this.indicatorTimer)}}}),jPar.wdk=jPar.wdk||{},$j.extend(!0,jPar.wdk,{passwordRestrictionBox:{conf:{boxName:"",emailNoticeInputs:"",passwordInputId:""},init:function(){var e="input.checkPassword";this.conf.boxName="#wdk-passwordRestrictionBox",this.conf.emailNoticeInputs="#regFormEmail",this.conf.passwordInputId="#"+$j(e+"[type=password]:first").attr("id");var t=this;!1===$j(this.conf.boxName).data("showAlways")&&($j(e+"[type=password]").on("focus",function(){t.showRestrictionBox()}),$j(e+"[type=password]").on("blur",function(){t.hideRestrictionBox()})),$j(e).on("keyup change",function(){t.checkPasswordRestrictions()})},showRestrictionBox:function(){this.checkPasswordRestrictions(),$j(this.conf.boxName).fadeIn(400)},hideRestrictionBox:function(){$j(this.conf.boxName).fadeOut(400)},checkPasswordRestrictions:function(){this.checkLength(),this.checkLettersAndNumbers(),$j("#partOfEmail").length&&this.checkPartOfEmail(),$j(this.conf.boxName+" ul li").length===$j(this.conf.boxName+" ul li.success").length?$j(this.conf.boxName).addClass("success"):$j(this.conf.boxName).removeClass("success")},checkLength:function(){8<=$j(this.conf.passwordInputId).val().length?this.setRestrictionToSuccess("#minCharacters"):this.setRestrictionToError("#minCharacters")},checkLettersAndNumbers:function(){var e=$j(this.conf.passwordInputId).val(),t=/.*[a-zA-Z]+.*/g.test(e),a=/.*[0-9]+.*/g.test(e),r=/.*[^a-zA-Z0-9\s]+.*/g.test(e);t&&a||t&&r?this.setRestrictionToSuccess("#lettersAndNumbers"):this.setRestrictionToError("#lettersAndNumbers")},checkPartOfEmail:function(){var e=$j(this.conf.emailNoticeInputs).val().split("@")[0],t=0<$j(this.conf.passwordInputId).val().length,a=$j(this.conf.passwordInputId).val().indexOf(e)<0;t&&(""===e||a)?this.setRestrictionToSuccess("#partOfEmail"):this.setRestrictionToError("#partOfEmail")},setRestrictionToSuccess:function(e){$j(e).removeClass("error"),$j(e).addClass("success")},setRestrictionToError:function(e){$j(e).removeClass("success"),$j(e).addClass("error")},isPasswordValid:function(){return $j(this.conf.boxName+" ul li").length===$j(this.conf.boxName+" ul li.success").length}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{ajaxCommands:{rejectSuggestion:function(e){return new Promise(function(t,a){$j.ajax({type:"POST",url:"/partner/writemessage/rejection",data:{partnerUser:e,_csrf:jPar.wdk.security.getCsrfToken()},success:function(e){jPar.util.network.hasValidSessionAndCsrfToken(e)?"object"===_typeof(e)&&void 0!==e.rejectionResponseView&&!0===e.rejectionResponseView.success?(jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"partner_actions",subcategory:"remove_match",action:"click",targetId:"button_remove_match"}),t(e.rejectionResponseView.redirectUrl)):a(new Error("invalidSuccessResponse",e)):a(new Error("sessionExpired"))},error:function(e,t){a("timeout"===t?new Error("browserTimeout"):new Error("genericError"))}})})},favoriteToggle:function(o){return new Promise(function(a,r){var e=o.dataset.partnerUserid,i=o.classList.contains("is-favorite"),t=i?"removeFavorite":"addFavorite";$j.ajax({type:"POST",url:o.dataset.url,data:{action:t,partnerId:e,_csrf:jPar.wdk.security.getCsrfToken()},success:function(e){if(jPar.util.network.hasValidSessionAndCsrfToken(e))if("object"===_typeof(e)&&!0===e.success){a(i?"removeFavorite":"addFavorite");var t="addFavorite"===a?"add_favorite":"remove_favorite";jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"partner_actions",subcategory:t,action:"click",targetId:"button_"+t})}else r(new Error("successFalse",e));else r(new Error("sessionExpired"))},error:function(e,t){r("timeout"===t?new Error("browserTimeout"):new Error("genericError"))}})})}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{dominit:{init:function(){$j("#pageHeader").length&&jPar.app.navigation.init(),$j("#ratingAfterPurchaseLayer").length&&jPar.app.sharedFeatures.ratingAfterPurchaseLayer.init(),$j("#welcomePage").length&&jPar.app.welcomePage.init(),$j("body").is(".listPages")&&jPar.app.listPages.init(),$j("#partnerProfilePage").length&&jPar.app.partnerProfile.init(),$j("#myProfilePage").length&&jPar.app.myProfile.init(),0<$j("#messengerPage").length&&($j("html").hasClass("no-promises")?jPar.util.loadScript("polyfill_promise",function(){Promise.polyfill(),jPar.app.messenger.init()}):jPar.app.messenger.init()),$j("#basiccriteriaPage").length&&jPar.app.basiccriteria.init(),$j("body").is(".rwdDataAndSettingsPages")&&jPar.app.dataAndSettings.init(),$j("body").is(".legalPages")&&jPar.app.legalPages.init(),$j("body").is(".exoticLinkPage")&&jPar.app.exoticLinks.init(),0<$j("#logoutPage").length&&jPar.app.logoutPage.init(),0<$j("#consentPage").length&&jPar.app.consentPage.init(),jPar.util.pwa.init(),jPar.util.loadURCviaAjax.init(),jPar.Tracking.parmacontoTeaser.init(),jPar.util.legacyBrowser.init(),jPar.wdk.screensize.setScreenSizeCookie(),jPar.util.timezone.setTimezone(),void 0!==navigator.serviceWorker&&null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage("prepareDefaultCache"),jPar.app.sharedFeatures.videoCall.init()}}}),$j(document).ready(function(){try{jPar.Tracking.init(),jPar.util.network.setGlobalAjaxTimeout()}catch(e){jPar.util.log.error(e,"jPar.app: Init external libs failed")}try{if(0<$j("html.is-appShellView").length)jPar.app.shellLayout.shellFrameInit(),void 0!==jPar.app.shellLayout.urls[location.pathname]?jPar.app.shellLayout.loadAppShellContent(location.pathname+location.search):jPar.app.shellLayout.fallbackRedirect();else jPar.app.dominit.init(),jPar.app.shellLayout.tracking.storeReferrerForTracking()}catch(e){jPar.util.log.error(e,"jPar.app: Init failed")}}),jPar.app.util=jPar.app.util||{},$j.extend(!0,jPar.app.util,{editLayer:{hideAllErrors:function(e){e.find('.wdk-styledHintBox[class*=" t-error"]').each(function(){jPar.wdk.forms.hideError($j(this))})},resultViewIsSuccess:function(e){try{return"object"===_typeof(e)&&void 0!==e.resultView&&!0===e.resultView.success}catch(e){return!1}},handleNetworkErrorOnSubmit:function(e,t,a){jPar.wdk.loadingIndicator.hide(e.find("button.saveElement")),"timeout"===a?jPar.wdk.forms.showError(e.find(".saveTimeout")):jPar.wdk.forms.showError(e.find(".saveError"))},handleInvalidResponse:function(e,t){!1===jPar.util.network.hasValidSessionAndCsrfToken(t)?jPar.wdk.forms.showError(e.find(".sessionExpired")):(jPar.wdk.forms.showError(e.find(".saveError")),jPar.util.log.error($j("body").attr("id")+" "+e.attr("id")+"data: "+JSON.stringify(t),"editLayer: errorOnSubmit - reallyBadError"))},resultViewIsApprovalNeeded:function(e){try{return"AWAITING_APPROVAL"===e.resultView.approvalStatus}catch(e){return!1}},resultViewIsRejected:function(e){try{return"REJECTED"===e.resultView.approvalStatus}catch(e){return!1}},setFocusToMainField:function(e){var t=$j(e).find(".js-focusField");0<$j("html.no-ie").length&&0<t.length&&window.setTimeout(function(){jPar.util.putCursorAtEnd(t)},500)},resetFreetextForField:function(e){var t=e.data("currentSavedValue");e.val(jPar.wdk.security.htmlEntitiesToChars(t)),jPar.wdk.forms.textElement.updateCounter(e)},resetApprovalForField:function(e){var t=e.parents("form.editModalLayer"),a=t.find(".approvalStatusBox.t-rejected"),r=t.find(".approvalStatusBox.t-awaitingApproval");!0===Boolean(a.data("shownForSavedValue"))?a.addClass("is-visible").attr("role","alert").attr("aria-hidden","false"):a.removeClass("is-visible").removeAttr("role").attr("aria-hidden","true"),!0===Boolean(r.data("shownForSavedValue"))?r.addClass("is-visible").attr("role","alert").attr("aria-hidden","false"):r.removeClass("is-visible").removeAttr("role").attr("aria-hidden","true")},saveFreetextValueForReset:function(e){var t=jPar.wdk.security.sanitizeStringForHtml(e.val());e.data("currentSavedValue",t),e.val(jPar.wdk.security.htmlEntitiesToChars(t))},showApprovalStatusIfNeeded:function(e,t){this.hideApprovalStatus(t.find(".approvalStatusBox.t-awaitingApproval")),this.hideApprovalStatus(t.find(".approvalStatusBox.t-rejected")),this.resultViewIsApprovalNeeded(e)&&this.showApprovalStatus(t.find(".approvalStatusBox.t-awaitingApproval")),this.resultViewIsRejected(e)&&this.showApprovalStatus(t.find(".approvalStatusBox.t-rejected"))},showApprovalStatus:function(e){e.addClass("is-visible").attr("role","alert").attr("aria-hidden","false").data("shownForSavedValue",!0)},hideApprovalStatus:function(e){e.removeClass("is-visible").removeAttr("role").attr("aria-hidden","true").data("shownForSavedValue",!1)},saveCheckboxValuesForReset:function(e){e.find("input[type=checkbox]").each(function(){var e=$j(this);e.data("currentSavedStatus",e.prop("checked"))})},resetCheckboxesInForm:function(e){e.find("input[type=checkbox]").each(function(){var e=Boolean($j(this).data("currentSavedStatus"));$j(this).prop("checked",e)})},showStickyHint:function(e){e.addClass("is-visible").attr("role","alert").attr("aria-hidden",!1).attr("aria-live","assertive").attr("aria-atomic",!0),e.parents(".editModalLayer").addClass("has-hintboxShown")},hideStickyHint:function(e){e.removeClass("is-visible").attr("aria-hidden",!0).removeAttr("role").removeAttr("aria-live").removeAttr("aria-atomic");var t=e.parents(".editModalLayer");0===t.find(".editLayerHint.is-visible").length&&t.removeClass("has-hintboxShown")},scrollToError:function(e){if(0<e.find('.js-scrollableContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var t=e.find(".js-scrollableContent").prop("scrollHeight");e.find(".js-scrollableContent").animate({scrollTop:t},300)}}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{util:{replaceLinebreakWithBr:function(e){return e.replace(/(?:\r\n|\r|\n)/g,"<br />")},replaceBrWithLinebreak:function(e){return e.replace(/<br\s*[\/]?>/gi,"\n")},getGetParamFromUrl:function(e){var t,a,r=decodeURIComponent(window.location.search.substring(1)).split("&");for(a=0;a<r.length;a++)if((t=r[a].split("="))[0]===e)return void 0===t[1]||t[1]},switchIcon:function(e,t,a){var r=new RegExp(t,"g"),i="";e.is("svg")?!1===$j("html").hasClass("ie")&&(i=e.find("use").attr("xlink:href").replace(r,a),e.find("use").attr("xlink:href",i)):(i=e.attr("src").replace(r,a),e.attr("src",i))},initPopState:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",a=/^((?!chrome).)*safari/i.test(navigator.userAgent),r=!0;$j(window).on("popstate"+t,function(){a&&r?r=!1:e()})}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{shellLayout:{initialCall:!0,initialEncodedPTR:null,lastReferrers:[],urls:{"/profile/welcomepage":0,"/lists/partnersuggestions":0,"/lists/favorites":0,"/lists/visitors":0,"/lists/visits":0,"/partner/factfilepartner":0,"/partner/partnerandme":0,"/messenger":0},shellFrameInit:function(){var t=this;$j("#errorModalboxAppShell .js-reloadPage").one("click",function(e){e.preventDefault(),t.fallbackRedirect()}),document.addEventListener("scroll",function(){t.storeLastScrollpositions()},jPar.util.customEvent.hasPassiveListener()),jPar.app.util.initPopState(function(){t.updatePageFromUrl()},".shellLayout")},setPageTitle:function(e){var t,a=e.split("?")[0].substring(1).replace("/","");t=$j("title").data(a),$j("title").text(t),$j("#pageTitle").text(t)},setAjaxNaviEventListener:function(){var a=this;for(var e in this.urls)this.urls.hasOwnProperty(e)&&$j("body").on("click",'a[href^="'.concat(e,'"]'),function(e){e.preventDefault();var t=$j(this).attr("href");a.loadAppShellContent(t)})},loadAppShellContent:function(t){var a=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).gotoStoredScrollPosition,r=this;jPar.util.log.devConsole("Loading AppShellContent: "+t),jPar.wdk.loadingIndicator.show($j("#appShellLoader")),$j.ajax({url:t,data:"appshellContent=true",dataType:"html",headers:{"X-App-Shell":"true"},xhr:function(){return r.overwriteJqueryHeader()},success:function(e){r.handleSuccess(e,t,a)},error:function(e,t,a){r.handleNetworkError(e,t,a)}})},handleSuccess:function(e,t,a){history.scrollRestoration="manual",jPar.wdk.loadingIndicator.hide($j("#appShellLoader")),!0!==a&&history.pushState(null,null,t),$j("#appShellContent").addClass("has-animation"),!0===(void 0!==e&&"string"==typeof e&&-1<e.indexOf('data-app-shell="content"'))?(this.beforeAddingDom(),$j("#appShellContent").html(e),this.prepareTitleTag($j('[data-app-shell="content"]')),this.prepareBodyTag($j('[data-app-shell="content"]')),$j("#pageWrapper").unwrap('[data-app-shell="content"]'),$j("body #appShellContent #content").css("color"),$j("body #appShellContent #content").addClass("is-visible"),this.afterAddingDom(),jPar.app.shellLayout.ajaxPageInit()):this.handleInvalidResponse(e),this.setScrollPosition(a)},removeOldEventListener:function(){$j("body").off("click"),$j(document).off("click"),$j(document).off("scroll"),$j(document).off("visibilitychange"),$j(window).off("popstate.messenger"),$j(window).off("popstate.profileTabNavi"),$j(window).off("resize"),jPar.wdk.modalbox.closeCurrentModalbox()},ajaxPageInit:function(){jPar.util.customEvent.trigger("ajaxShellPage:loadingDone"),this.removeOldEventListener(),this.setAjaxNaviEventListener(),jPar.app.dominit.init(),$j("body #appShellContent").attr("role","alert"),window.setTimeout(function(){$j("#appShellContent").removeClass("has-animation"),$j("body #appShellContent").removeAttr("role")},500),jPar.util.customEvent.trigger("ajaxShellPage:initDone")},beforeAddingDom:function(){this.tracking.storeInitialPTRForTracking(),this.tracking.storeReferrerForTracking()},afterAddingDom:function(){this.tracking.fillPTRwithInitialPTR()},handleInvalidResponse:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):(jPar.wdk.modalbox.show({modalboxId:"errorModalboxAppShell"}),jPar.util.log.error($j("body").attr("id")+"response: "+JSON.stringify(e),"AppShell: invalid response"))},handleNetworkError:function(e,t){jPar.wdk.loadingIndicator.hide($j("#appShellLoader")),"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):418===e.status?jPar.util.pwa.offline.triggerOfflineAttention(!0):jPar.wdk.modalbox.show({modalboxId:"errorModalboxAppShell"})},prepareBodyTag:function(e){var t=e.attr("id"),a=e.attr("class");$j("body").attr("id",t),$j("body").attr("class",a)},prepareTitleTag:function(e){var t=e.data("titleText");$j("title").text(t),$j("#pageTitle").text(t)},updatePageFromUrl:function(){var e=document.location.href;this.loadAppShellContent(e,{gotoStoredScrollPosition:!0})},fallbackRedirect:function(){document.location.replace("/profile/welcomepage"),jPar.wdk.modalbox.hide()},overwriteJqueryHeader:function(){var e=jQuery.ajaxSettings.xhr(),a=e.setRequestHeader;return e.setRequestHeader=function(e,t){"X-Requested-With"===e&&"XMLHttpRequest"===t||a.call(this,e,t)},e},storeLastScrollpositions:function(){var e=document.location.pathname,t=window.pageYOffset;jPar.app.shellLayout.urls[e]=t},setScrollPosition:function(e){if(!0===e){var t=document.location.pathname;$j(document).scrollTop(jPar.app.shellLayout.urls[t])}else $j(document).scrollTop(0)},tracking:{storeInitialPTRForTracking:function(){!0===jPar.app.shellLayout.initialCall&&(jPar.app.shellLayout.initialEncodedPTR=window.encodedPTR)},fillPTRwithInitialPTR:function(){!0===jPar.app.shellLayout.initialCall&&(window.encodedPTR=jPar.app.shellLayout.initialEncodedPTR,jPar.app.shellLayout.initialCall=!1)},storeReferrerForTracking:function(){var e=document.location.href;if(0<$j("html.is-appShellView").length){if(jPar.app.shellLayout.lastReferrers.push(e),1<jPar.app.shellLayout.lastReferrers.length&&0<$j("html.localstorage").length){var t=jPar.app.shellLayout.lastReferrers[jPar.app.shellLayout.lastReferrers.length-2];localStorage.setItem("pageReferrer",t),jPar.app.shellLayout.lastReferrers.shift()}}else 0<$j("html.localstorage").length&&localStorage.setItem("pageReferrer",e)}}}}),jPar.app.sharedFeatures=jPar.app.sharedFeatures||{},jPar.app.sharedFeatures.icebreaker=jPar.app.sharedFeatures.icebreaker||{},$j.extend(!0,jPar.app.sharedFeatures.icebreaker,{play:{formData:null,icebreakerType:"",$openModalbox:null,icebreakerId:null,numberOfImagePairs:5,showLoadingMillis:null,openLayer:function(e){var t=this,a="",r="",i=$j(e.currentTarget);jPar.wdk.loadingIndicator.show(i),t.showLoadingMillis=null,i.hasClass("js-sendIcebreaker")?(this.icebreakerType="icebreakerRequest",r=jPar.wdk.security.getCsrfToken(),a="POST"):i.hasClass("js-answerIcebreaker")&&(this.icebreakerType="icebreakerResponse",r="",a="GET"),jPar.wdk.modalbox.show({modalboxId:t.icebreakerType+"Modal",ajaxSettings:{type:a,data:{_csrf:r}},onSuccess:function(){0<$j(".modalboxContent").length&&(jPar.app.partnerProfile.messaging.messageMenu.close(),t.initLayer())},onFail:function(e){jPar.util.network.reloadIfResponseInvalid(e)},onAlways:function(){jPar.wdk.loadingIndicator.hide(i)},onBeforeClose:function(){return!!jPar.app.sharedFeatures.icebreaker.play.cancelLayer.isAllowedToClose||(jPar.app.sharedFeatures.icebreaker.play.cancelLayer.show(),!1)}})},initLayer:function(){if(this.$openModalbox=$j(".allIcebreakerModal.is-open"),this.icebreakerId=this.$openModalbox.find("#playBoard").data("icebreakerId"),0<this.$openModalbox.find("#playBoard").length){var t=this;this.ajaxData={selections:[],photoRelease:!1},$j(document).one("icebreaker-imagespreloaded",function(){t.showLayer()}),this.$openModalbox.find(".imagePair li:not(.is-selected)").one("click",function(){t.selectAndShowNextPair($j(this))}),this.$openModalbox.find(".js-shuffleImages").on("click",function(e){e.preventDefault(),$j(this).addClass("disabled"),t.shuffleCurrentPair()}),this.startPreloading(),this.cancelLayer.init()}else this.cancelLayer.isAllowedToClose=!0,jPar.app.partnerProfile.ajaxFormLayer.initLoadedLayer()},showLayer:function(){var e=this;window.setTimeout(function(){e.$openModalbox.find("#mainContent").fadeIn(),e.$openModalbox.find("#loadingLayer").addClass("noDisplay"),e.showOnboarding()},400)},cancelLayer:{isAllowedToClose:!1,init:function(){var a=this;this.isAllowedToClose=!1,jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find(".js-openCancelLayer").on("click",function(e){e.preventDefault(),a.show()}),jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find(".js-reallyCancelIcebreaker").on("click",function(e){e.preventDefault(),a.isAllowedToClose=!0,jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find("#cancelLayer").removeClass("is-open"),jPar.wdk.modalbox.hide();var t=$j("#playBoard ul.is-visible").data("imagepairUuid");jPar.util.log.ui("Icebreaker","Cancel Icebreaker","ImagePairId: "+t)}),jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find(".js-closeCancelLayer").on("click",function(e){e.preventDefault(),a.isAllowedToClose=!1,jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find("#cancelLayer").removeClass("is-open")})},show:function(){jPar.app.sharedFeatures.icebreaker.play.cancelLayer.isAllowedToClose?jPar.wdk.modalbox.hide():jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find("#cancelLayer").addClass("is-open")}},startPreloading:function(){var e=this;window.setTimeout(function(){e.showLoadingMillis=Date.now(),$j("#loadingLayer .wdk-loadingSpinner").addClass("is-loading")},1500),this.preloadImages()},preloadImages:function(){var e=this,t=!1,a=!1,r=this.getBgImageUrl($j("#pair1 .firstImage .image").css("background-image")),i=document.createElement("img");i.src=r,i.onload=function(){(t=!0)&&a&&e.imagesPreloaded()};var o=this.getBgImageUrl($j("#pair1 .secondImage .image").css("background-image")),n=document.createElement("img");n.src=o,n.onload=function(){a=!0,t&&a&&e.imagesPreloaded()}},getBgImageUrl:function(e){try{return e.replace(/url\(['"]?(.*?)['"]?\)/i,"$1")}catch(e){jPar.util.log.error("Icebreaker","No Icebreaker Images available")}},imagesPreloaded:function(){jPar.util.customEvent.trigger("icebreaker-imagespreloaded")},showOnboarding:function(){var e=!1;if(0<$j("html.localstorage").length){var t=parseInt(localStorage.getItem("icebreakerOnboardingShown"));(isNaN(t)?0:t)<2&&(e=!0)}else e=!0;!0===e&&($j("#onboardingIntro").removeClass("noDisplay"),this.$openModalbox.find("#onboardingIntro").on("click",function(){$j("#onboardingIntro").addClass("noDisplay")}))},selectAndShowNextPair:function(e){var r=this;if(0===$j(".messagingErrors .wdk-styledHintBox.is-visible").length){var i=e.parent(".imagePair"),t=i.data("imagepairUuid"),a=e.data("imageUuid"),o=0===jQuery.grep(r.ajaxData.selections,function(e){return e.imagePairId===t}).length,n=r.ajaxData.selections.length+1>=r.numberOfImagePairs;o?(r.ajaxData.selections.push({imagePairId:t,imageId:a}),e.addClass("is-selected").delay(500).queue(function(){var e=i.attr("id"),t=parseInt(e.replace("pair",""))+1;r.$openModalbox.find(".progressBar").removeClass("pair"+parseInt(t-1)).addClass("pair"+t);var a=r.$openModalbox.find("#pair"+t);a.css("zIndex",t),$j(".imagePair").removeClass("is-visible"),i.addClass("is-alreadySelected"),t>r.numberOfImagePairs?($j(".js-shuffleImages").addClass("is-shuffleNotAllowed"),i.addClass("is-visible"),window.setTimeout(function(){r.checkForImagerelease()},600)):(a.addClass("is-visible"),$j(".js-shuffleImages").removeClass("is-shuffleNotAllowed"))})):n&&r.checkForImagerelease()}else $j(".messagingErrors .wdk-styledHintBox.is-visible").removeClass("is-visible"),r.selectAndShowNextPair(e)},checkForImagerelease:function(){0<$j("#imagereleaseLayer").length?this.showImagereleaseLayer():this.save()},showImagereleaseLayer:function(){var t=this;t.ajaxData.photoRelease=!0,$j("#imagereleaseLayer").removeClass("noDisplay"),$j("#imageReleaseIcebreaker").on("change",function(){$j(this).prop("checked")?(t.ajaxData.photoRelease=!0,$j("#imagereleaseLayer .photo").removeClass("is-blurred")):(t.ajaxData.photoRelease=!1,$j("#imagereleaseLayer .photo").addClass("is-blurred"))}),$j(".js-saveIcebreaker").on("click",function(e){e.preventDefault(),t.save()})},shuffleCurrentPair:function(){var r=this,e=$j("#playBoard"),t=e.data("icebreaker-id"),a=e.data("partner-chiffre"),i=$j(".imagePair.is-visible"),o=i.data("imagepair-uuid"),n=i.attr("id"),s=jPar.wdk.security.getCsrfToken();jPar.wdk.loadingIndicator.show($j(".js-shuffleImages")),$j.ajax({type:"POST",cache:!1,url:"/icebreaker/partners/"+a+"/icebreakers/"+t+"/imagepairs/replace?_csrf="+s,contentType:"application/x-www-form-urlencoded",data:{imagePairId:o},success:function(e){var t=$j(e);t.attr("id",n),t.addClass("is-visible"),i.replaceWith(t),jPar.wdk.loadingIndicator.hide($j(".js-shuffleImages")),$j(".js-shuffleImages").addClass("is-shuffleNotAllowed"),jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find("#"+n+" li").on("click",function(){jPar.app.sharedFeatures.icebreaker.play.selectAndShowNextPair($j(this))})},error:function(e,t,a){jPar.wdk.loadingIndicator.hide($j(".js-shuffleImages")),r.errorHandling.handleNetworkErrorOnSubmit(e,t,a)}})},save:function(){var r=this;this.cancelLayer.isAllowedToClose=!0;var i,e="",t=r.$openModalbox.find("#playBoard").data("partnerChiffre"),a=r.icebreakerId,o=jPar.wdk.security.getCsrfToken();"icebreakerRequest"===this.icebreakerType?e="/icebreaker/partners/".concat(t,"/icebreakers/").concat(a,"/initiatorSelection?_csrf=").concat(o):"icebreakerResponse"===this.icebreakerType&&(e="/icebreaker/partners/".concat(t,"/icebreakers/").concat(a,"/responderSelection?_csrf=").concat(o)),i=0<$j("#imagereleaseLayer").length?$j(".js-saveIcebreaker"):$j("#playBoard"),jPar.wdk.loadingIndicator.show(i),$j.ajax({type:"POST",url:e,contentType:"application/json",data:JSON.stringify(r.ajaxData),success:function(e){jPar.wdk.loadingIndicator.hide(i),r.errorHandling.isValidSuccessResponse(e)?r.closeAfterSave.closeIcebreaker():r.errorHandling.handleErrorCodes(e)},error:function(e,t,a){jPar.wdk.loadingIndicator.hide(i),r.errorHandling.handleNetworkErrorOnSubmit(e,t,a)}})},closeAfterSave:{closeIcebreaker:function(){var e=0<$j("body#partnerProfilePage").length,t=0<$j("body#messengerPage").length;if(e)this.handleCloseForPartnerProfile();else if(t){if(jPar.wdk.modalbox.hide(!0),"icebreakerResponse"===jPar.app.sharedFeatures.icebreaker.play.icebreakerType&&0<$j("html.localstorage").length){var a=jPar.app.sharedFeatures.icebreaker.play.icebreakerId;localStorage.setItem("openIcebreakerInMessenger",a)}jPar.app.messenger.conversationArea.loadMessageForActivePartner()}this.updateLocalStorage()},updateLocalStorage:function(){if(0<$j("html.localstorage").length){var e=parseInt(localStorage.getItem("icebreakerOnboardingShown"));isNaN(e)?localStorage.setItem("icebreakerOnboardingShown",1):e<2&&localStorage.setItem("icebreakerOnboardingShown",2)}},handleCloseForPartnerProfile:function(){if(0<$j("html.localstorage").length){var e=parseInt(localStorage.getItem("icebreakerOnboardingShown")),t=isNaN(e)?0:e;"icebreakerRequest"===jPar.app.sharedFeatures.icebreaker.play.icebreakerType&&(t<2?this.showOutroLayer():this.showToast())}else this.showToast();this.gotoIcebreakerResult()},showToast:function(){jPar.app.partnerProfile.ajaxFormLayer.util.refreshCommunicationElements(),jPar.wdk.modalbox.hide(),jPar.wdk.toast.show("#icebreakerSuccess")},showOutroLayer:function(){jPar.app.partnerProfile.ajaxFormLayer.util.refreshCommunicationElements(),$j(".wdk-modalbox #mainContent").addClass("noDisplay"),jPar.app.sharedFeatures.icebreaker.play.$openModalbox.addClass("has-smallContent"),$j("#imagereleaseLayer").addClass("noDisplay"),$j("#onboardingOutro").removeClass("noDisplay"),$j(".js-closeOnboaringOutro").on("click",function(e){e.preventDefault(),jPar.app.partnerProfile.ajaxFormLayer.util.refreshCommunicationElements(),jPar.wdk.modalbox.hide(),$j(".js-closeOnboaringOutro").off("click")})},gotoIcebreakerResult:function(){if("icebreakerResponse"===jPar.app.sharedFeatures.icebreaker.play.icebreakerType){var e=jPar.app.sharedFeatures.icebreaker.play.icebreakerId,t=$j("#profileHeader").data("partnerChiffre");localStorage.setItem("openIcebreakerInMessenger",e),window.location.href="/messenger?partnerUserId=".concat(t)}}},errorHandling:{isValidSuccessResponse:function(e){try{return"object"===_typeof(e)&&void 0!==e.writeMessageResponse&&!0===e.writeMessageResponse.success}catch(e){return jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error(e," jPar.app.sharedFeatures.icebreaker.play: sendMessage Ajax-Success-Handling failed"),!1}},hasErrorCodes:function(e){return void 0!==e.writeMessageResponse&&0<e.writeMessageResponse.errorCodes.length},handleInvalidResponse:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.wdk.forms.showError($j("#sessionExpiredOnSendForIcebreaker")):!1===this.hasErrorCodes(e)?(jPar.wdk.forms.showError(jPar.app.sharedFeatures.icebreaker.play.$openModalbox("#panicIDontKnowWhatHappenedError")),jPar.util.log.error("errorOnSubmit - no errorCodes provided. data:"+JSON.stringify(e),"Messenger: sendIcebreaker panicIDontKnowWhatHappenedError")):(jPar.wdk.forms.showError(jPar.app.sharedFeatures.icebreaker.play.$openModalbox("#panicIDontKnowWhatHappenedError")),jPar.util.log.error("errorOnSubmit "+e,"Messenger: sendIcebreaker reallyBadError"))},handleErrorCodes:function(e){this.reactivateClickForErrorCase(),jPar.util.network.hasValidSessionAndCsrfToken(e)&&this.hasErrorCodes(e)?this.showErrorsForCodes(e.writeMessageResponse.errorCodes):this.handleInvalidResponse(e)},showErrorsForCodes:function(e){jQuery.each(e,function(e,t){0<jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find("#"+t).length?jPar.wdk.forms.showError(jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find("#"+t)):(jPar.wdk.forms.showError(jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find("#panicIDontKnowWhatHappenedError")),jPar.util.log.error("errorCode: "+t,"Messenger: sendIcebreaker unknown errorCode"))})},handleNetworkErrorOnSubmit:function(e,t,a){this.reactivateClickForErrorCase(),"timeout"===t?jPar.wdk.forms.showError(jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find("#requestTimeout")):(jPar.wdk.forms.showError(jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find("#serverError")),0!==e.status&&403!==e.status&&jPar.util.log.ui($j("body").attr("id"),"Icebreaker send/shuffle",e.status+" - "+a))},reactivateClickForErrorCase:function(){jPar.app.sharedFeatures.icebreaker.play.$openModalbox.find("#pair5 li").one("click",function(){jPar.app.sharedFeatures.icebreaker.play.selectAndShowNextPair($j(this))})}}}}),jPar.app.sharedFeatures=jPar.app.sharedFeatures||{},jPar.app.sharedFeatures.icebreaker=jPar.app.sharedFeatures.icebreaker||{},$j.extend(!0,jPar.app.sharedFeatures.icebreaker,{result:{perfectScrollbarInstance:null,openLayer:function(e){var t=$j(e.currentTarget),a=this;jPar.wdk.loadingIndicator.show(t),jPar.wdk.modalbox.show({modalboxId:t.data("openModalboxId"),onSuccess:function(){jPar.wdk.loadingIndicator.hide(t),a.initLayer()},onBeforeClose:function(){var e=(document.location.pathname+document.location.search).replace("&icebreakerOpen=true","");return history.replaceState(null,null,"".concat(e)),jPar.app.sharedFeatures.icebreaker.result.partyLayer.stopTimeouts(),jPar.app.sharedFeatures.icebreaker.result.partyLayer.stopAnimations(),!0},onFail:function(){jPar.wdk.loadingIndicator.hide(t)}})},initLayer:function(){var e=this;0<$j("html.no-webanimations").length?jPar.util.loadScript("web_animations_polyfill",function(){e.partyLayer.init()}):e.partyLayer.init(),this.initPerfectScrollbar(),0<$j("html.localstorage").length&&localStorage.removeItem("openIcebreakerInMessenger")},initPerfectScrollbar:function(){this.perfectScrollbarInstance=new PerfectScrollbar(".icebreakerResultModal .js-scrollableContent")}}}),jPar.app.sharedFeatures=jPar.app.sharedFeatures||{},jPar.app.sharedFeatures.icebreaker=jPar.app.sharedFeatures.icebreaker||{},jPar.app.sharedFeatures.icebreaker.result=jPar.app.sharedFeatures.icebreaker.result||{},$j.extend(!0,jPar.app.sharedFeatures.icebreaker.result,{easings:{easeOutBack:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",easeOutSine:"cubic-bezier(0.39, 0.575, 0.565, 1)",easeOutExpo:"cubic-bezier(0.19, 1, 0.22, 1)",easeInExpo:"cubic-bezier(0, 0.96, 0.3, 1)",easeOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)"}}),$j.extend(!0,jPar.app.sharedFeatures.icebreaker.result,{partyLayer:{sameImageAmount:null,baseTiming:600,counterDuration:0,endTime:{counter:0,text:0,heart:0,userPhotos:0,endAnim:0},animations:[],end:null,timeouts:[],init:function(){var e=this;this.timeouts=[],this.sameImageAmount=parseInt($j("#partyLayer").data("sameImageAmount")),this.counterAnimation.start(),this.resultTextAnimation.start(),this.heartAnimation.start(),this.userPhotoAnimation.start();var t=window.setTimeout(function(){e.endAnimation.start()},400);jPar.app.sharedFeatures.icebreaker.result.partyLayer.timeouts.push(t),$j(".icebreakerResultModal .imageArea").addClass("is-visible")},icebrakerAnimate:function(e,t,a){var r=e.animate(t,a);return this.animations.push(r),r},stopAnimations:function(){this.animations.forEach(function(e){e.cancel()})},stopTimeouts:function(){this.timeouts.forEach(function(e){window.clearTimeout(e)})},counterAnimation:{start:function(){var e=jPar.app.sharedFeatures.icebreaker.result.partyLayer.baseTiming,t={duration:e,delay:0,fill:"forwards"},a=jPar.app.sharedFeatures.icebreaker.result.partyLayer.sameImageAmount;jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate($j("#partyLayer .counterText")[0],this.keyOpacityCounterText,t);for(var r=null,i=0;i<a;i++){var o=$j("#partyLayer .counterElement"+i)[0];jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(o,this.keyTranslate,t),r=jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(o,this.keyOpacity,t),t.delay=t.delay+e/2}null!==r&&(r.onfinish=function(){$j('#partyLayer [class^="counterElement"]').hide(),$j("#partyLayer .counterElement"+a).show()});var n=$j("#partyLayer .counterElement"+a)[0];jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(n,this.lastKeyOpacity,t),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(n,this.lastKeyTranslate,t),jPar.app.sharedFeatures.icebreaker.result.partyLayer.counterDuration=0,jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.counter=e+t.delay},keyOpacity:[{opacity:0,offset:0},{opacity:1,offset:.5,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutQuint},{opacity:0,offset:1}],keyOpacityCounterText:[{opacity:0,offset:0},{opacity:1,offset:.3},{opacity:1,offset:1}],keyTranslate:[{transform:"translateY(-50px)",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"none",offset:.5,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"translateY(50px)",offset:1}],lastKeyOpacity:[{opacity:0,offset:0},{opacity:1,offset:1}],lastKeyTranslate:[{transform:"translateY(-50px)",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"none",offset:1}]},resultTextAnimation:{start:function(){var e=jPar.app.sharedFeatures.icebreaker.result.partyLayer.baseTiming,t=jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.counter-e;jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.text=e+t;var a={fill:"forwards",duration:e,delay:t},r=$j("#partyLayer p")[0],i=[{transform:"translateY(-80px)",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"none",offset:1}];jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(r,[{opacity:0,offset:0},{opacity:1,offset:1}],a),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(r,i,a)}},heartAnimation:{baseDuration:0,timings:{},matchesCount:0,$heart:null,$heartBorder:null,$exploder:null,keyHeartBounceUpLast:null,start:function(){this.baseDuration=jPar.app.sharedFeatures.icebreaker.result.partyLayer.baseTiming,this.timings={duration:this.baseDuration,delay:(jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.counter-jPar.app.sharedFeatures.icebreaker.result.partyLayer.baseTiming)/2,fill:"forwards"},this.timings.delay<600&&(this.timings.delay=600),this.matchesCount=jPar.app.sharedFeatures.icebreaker.result.partyLayer.sameImageAmount,this.$heart=$j("#partyLayer .icebreakerLogo .heart")[0],this.$heartBorder=$j("#partyLayer .icebreakerLogo .borderFrames")[0],this.$exploder=$j("#partyLayer .icebreakerLogo .exploder")[0];var e=1;$j("html").hasClass("no-ios")&&(e=2),this.keyHeartBounceUpLast=[{transform:"none",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"translateY(-18px) scale(1)",offset:.3,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"scale("+e+")",offset:1}],this.animateLowMatchesCount(),this.animateMediumMatchesCount(),this.animateTopMatchesCount();var t=this.timings.delay+this.timings.duration;jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.heart=t},animateLowMatchesCount:function(){var e=[{transform:"none",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"translateY(-12px)",offset:.3,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"none",offset:1}];if(1<=this.matchesCount){jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(this.$heart,e,this.timings),this.timings.delay=this.timings.delay+.2*this.timings.duration;var t=window.setTimeout(function(){$j(".borderFrames img").removeClass("is-visible"),$j("img.borderFrame1").addClass("is-visible")},this.timings.delay);jPar.app.sharedFeatures.icebreaker.result.partyLayer.timeouts.push(t),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(this.$heartBorder,this.keyheartBorderBounce,this.timings)}},animateMediumMatchesCount:function(){if(3===this.matchesCount||4===this.matchesCount){this.timings={duration:this.baseDuration,delay:this.timings.delay+this.timings.duration,fill:"forwards"},jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(this.$heart,this.keyHeartBounceUpLast,this.timings),this.timings.delay=this.timings.delay+.2*this.timings.duration;var e=window.setTimeout(function(){$j(".borderFrames img").removeClass("is-visible"),$j(".exploder").addClass("is-visible")},this.timings.delay);jPar.app.sharedFeatures.icebreaker.result.partyLayer.timeouts.push(e),this.timings={duration:this.baseDuration,delay:this.timings.delay,fill:"forwards"},jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(this.$exploder,this.keyExplodeHeart,this.timings),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(this.$exploder,this.keyExplodeHeartFadeOut,this.timings)}},animateTopMatchesCount:function(){if(5===this.matchesCount){var e=$j("#partyLayer .godrays")[0],t=$j("#partyLayer .godray1")[0],a=$j("#partyLayer .godray2")[0],r=[{transform:"none",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"translateY(-12px",offset:.3,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"none",offset:1}],i=[{transform:"rotate(0deg)",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutSine},{transform:"rotate(-50deg)",offset:1}],o=[{transform:"rotate(0deg)",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutSine},{transform:"rotate(50deg)",offset:1}];this.timings={duration:this.baseDuration,delay:this.timings.delay+this.timings.duration,fill:"forwards"},jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(this.$heart,r,this.timings),this.timings.delay=this.timings.delay+.2*this.timings.duration;var n=window.setTimeout(function(){$j("#partyLayer .borderFrames img").removeClass("is-visible"),$j("#partyLayer img.borderFrame2").addClass("is-visible")},this.timings.delay);jPar.app.sharedFeatures.icebreaker.result.partyLayer.timeouts.push(n),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(this.$heartBorder,this.keyheartBorderBounce,this.timings),this.timings.delay=this.timings.delay+this.timings.duration,jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(this.$heart,this.keyHeartBounceUpLast,this.timings),this.timings.delay=this.timings.delay+.2*this.timings.duration;var s=window.setTimeout(function(){$j("#partyLayer .icebreakerLogo img").removeClass("is-visible"),$j("#partyLayer .exploder").addClass("is-visible"),$j("#partyLayer .heartIcon3").addClass("is-visible"),$j("#partyLayer .counter").addClass("has-mainColorText")},this.timings.delay);jPar.app.sharedFeatures.icebreaker.result.partyLayer.timeouts.push(s);var l={duration:850,delay:this.timings.delay,fill:"forwards"};jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(this.$exploder,this.keyExplodeHeart,l),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(this.$exploder,this.keyExplodeHeartFadeOut,l),l.duration=300,jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(e,[{opacity:0,offset:0},{opacity:1,offset:1}],l),l.duration=2500,jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(t,i,l),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(a,o,l)}},keyheartBorderBounce:[{transform:"none",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"translateY(-5px)",offset:.3,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"none",offset:1}],keyExplodeHeart:[{transform:"scale(1)",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutExpo},{transform:"scale(8)",offset:1}],keyExplodeHeartFadeOut:[{opacity:1,offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutExpo},{opacity:0,offset:1}]},userPhotoAnimation:{start:function(){$j("#partyLayer").data("has-photorelease")?(this.fadeInPhotos(),this.moveToTopPhotos()):jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.userPhotos=0},fadeInPhotos:function(){var e=$j("#partyLayer .myUser")[0],t=$j("#partyLayer .partnerUser")[0],a=$j("#partyLayer .userPhotos span")[0],r=$j("#partyLayer .userPhotos span")[1],i=2*jPar.app.sharedFeatures.icebreaker.result.partyLayer.baseTiming,o=jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.heart-jPar.app.sharedFeatures.icebreaker.result.partyLayer.baseTiming,n={fill:"forwards",duration:i,delay:o};jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.userPhotos=i+o;var s=[{opacity:.5,offset:0},{opacity:1,offset:1}],l=[{transform:"translateX(-50%)",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeInExpo},{transform:"translateX(0px)",offset:1}],d=[{transform:"translateX(150%)",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeInExpo},{transform:"translateX(100%)",offset:1}],c=[{filter:"blur(7px)",offset:0},{filter:"blur(0px)",offset:.7},{filter:"blur(0px)",offset:1}];jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(a,c,n),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(e,s,n),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(r,c,n),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(t,s,n),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(e,l,n),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(t,d,n)},moveToTopPhotos:function(){var e=0;e=jPar.wdk.screensize.isBreakpoint(["S","M"])?0:27.5;var t=$j("#mainContent .userPhotos").position().top,a=-1*($j("#partyLayer .userPhotos").position().top-t+e),r=$j("#partyLayer .userPhotos")[0],i=1.5*jPar.app.sharedFeatures.icebreaker.result.partyLayer.baseTiming,o=jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.userPhotos+200,n={fill:"forwards",duration:i,delay:o};jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.userPhotos=i+o;var s=[{transform:"translateY(0px)",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeInExpo},{transform:"translateY("+a+"px)",offset:1}];jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(r,s,n)}},endAnimation:{timings:null,start:function(){var e=0;e=0===jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.userPhotos?jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.heart:jPar.app.sharedFeatures.icebreaker.result.partyLayer.endTime.userPhotos-1350;var t=1*jPar.app.sharedFeatures.icebreaker.result.partyLayer.baseTiming;this.timings={duration:t,delay:e,fill:"forwards"},this.fadeoutPartyLayer(),this.slideHeartToEndPosition(),$j("#partyLayer").data("has-photorelease")||this.fadeInUserPhotos()},fadeoutPartyLayer:function(){var e=$j("#partyLayer .counterAndTextWrapper")[0],t=$j("#partyLayer .background")[0],a=[{opacity:1,offset:0},{opacity:0,offset:1}];jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(e,a,this.timings),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(t,a,this.timings)},fadeInUserPhotos:function(){var e=$j("#mainContent .userPhotos")[0];jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate(e,[{opacity:0,offset:0},{opacity:1,offset:1}],this.timings)},slideHeartToEndPosition:function(){var e=$j(".icebreakerLogo").position().top-$j(".logoSpacer").position().top,t=[{transform:"scale(1)",offset:0,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack},{transform:"translateY(-"+e+"px) scale(0.43)",offset:1,easing:jPar.app.sharedFeatures.icebreaker.result.easings.easeOutBack}],a=jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate($j("#partyLayer .heart")[0],t,this.timings);jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate($j("#partyLayer .heartIcon1")[0],t,this.timings),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate($j("#partyLayer .heartIcon2")[0],t,this.timings),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate($j("#partyLayer .heartIcon3")[0],t,this.timings),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate($j("#partyLayer .borderFrames .borderFrame0")[0],t,this.timings),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate($j("#partyLayer .borderFrames .borderFrame1")[0],t,this.timings),jPar.app.sharedFeatures.icebreaker.result.partyLayer.icebrakerAnimate($j("#partyLayer .borderFrames .borderFrame2")[0],t,this.timings),this.timings={duration:300,delay:this.timings.delay,fill:"forwards"};var r=window.setTimeout(function(){$j(".heart").removeClass("is-visible"),$j(".borderFrames img").removeClass("is-visible"),0===jPar.app.sharedFeatures.icebreaker.result.partyLayer.sameImageAmount?$j(".heartIcon1").addClass("is-visible"):1===jPar.app.sharedFeatures.icebreaker.result.partyLayer.sameImageAmount||2===jPar.app.sharedFeatures.icebreaker.result.partyLayer.sameImageAmount?$j(".heartIcon2").addClass("is-visible"):$j(".heartIcon3").addClass("is-visible")},this.timings.delay);jPar.app.sharedFeatures.icebreaker.result.partyLayer.timeouts.push(r),a.onfinish=function(){$j(".counterAndTextWrapper").remove(),$j(".icebreakerLogoWrapper").addClass("has-endposition"),$j(".background").addClass("has-endposition"),$j("#partyLayer").addClass("animationFinished"),$j("#partyLayer").data("has-photorelease")&&$j("#mainContent .userPhotos").addClass("is-visible")}}}}}),jPar.app.sharedFeatures=jPar.app.sharedFeatures||{},$j.extend(!0,jPar.app.sharedFeatures,{oscChat:{hasEndedAnotherChat:!1,init:function(){if(0<$j(".js-openOscChat").length){var a=this;window.addEventListener("message",function(e){var t=a.parseEventData(e.data);!1!==t&&(console.log("jsonData:",t),a.handleChatButtonVisibility(t),a.handleChatHeader(t))},!1),this.loadIframeForRightNow(),this.setClickEventsForStartChat(),this.setClickEventsForChatHeader(),window.addEventListener("beforeunload",function(e){a.checkBeforeUnload(e)})}},handleChatButtonVisibility:function(e){!0===e.agentAvailable?this.showChatButton():!1===e.agentAvailable&&this.hideChatButton()},handleChatHeader:function(e){void 0!==e.csAgentName&&($j("#chatWindow .agentInfos h3").text(e.csAgentName),jPar.util.customEvent.trigger("oscChat:agentAccepted",null,$j("#oscChatContainer")[0])),void 0!==e.csAgentStatus&&($j("#chatWindow .agentStatus").removeClass("is-visible"),"Online"===e.csAgentStatus?$j("#chatWindow .agentStatus.is-online").addClass("is-visible"):"Typing"===e.csAgentStatus&&$j("#chatWindow .agentStatus.is-typing").addClass("is-visible")),!0===e.newChatMessage&&0<$j("#oscChatContainer.has-minimizedChat").length&&$j("#chatWindow header .chatIcon").addClass("has-newMessage")},loadIframeForRightNow:function(){$j("#oscChatIframe").attr("src",$j("#oscChatIframe").data("url"))},showChatButton:function(){jPar.util.customEvent.trigger("oscChat:showChatButton",null,$j("#oscChatContainer")[0])},hideChatButton:function(){jPar.util.customEvent.trigger("oscChat:hideChatButton",null,$j("#oscChatContainer")[0])},setClickEventsForStartChat:function(){var t=this;$j(".js-openOscChat").on("click",function(e){e.preventDefault(),0===$j("#oscChatContainer.has-chatOpen").length&&t.openChatWindow()})},setClickEventsForChatHeader:function(){var t=this;$j("#chatWindow .minimizeButton").on("click",function(e){e.preventDefault(),$j("#oscChatContainer").removeClass("has-chatOpen"),$j("#oscChatContainer").addClass("has-minimizedChat")}),$j("#chatWindow .continueChat").on("click",function(){t.continueChat()}),$j("#chatWindow .endChatButton").on("click",function(){t.openConfirmDialog()}),$j("#chatWindow #closeConfirmDialog #js-confirmClose").on("click",function(e){e.preventDefault(),t.closeChatWindow()}),$j("#chatWindow #closeConfirmDialog #js-abortClose").on("click",function(e){e.preventDefault(),$j("#chatWindow").removeClass("has-closeConfirmDialog")})},openChatWindow:function(){var e=document.getElementById("oscChatIframe").contentWindow,t=location.protocol+"//"+location.host;e.postMessage("clickedStartChat",t),$j("#oscChatContainer").addClass("has-chatOpen"),$j("#chatWindow").removeClass("noDisplay")},continueChat:function(){$j("#oscChatContainer").addClass("has-chatOpen"),$j("#oscChatContainer").removeClass("has-minimizedChat"),$j(".chatIcon").removeClass("has-newMessage")},openConfirmDialog:function(){0===$j("#oscChatContainer.has-chatOpen").length&&this.continueChat(),$j("#chatWindow").addClass("has-closeConfirmDialog")},closeChatWindow:function(){$j("#oscChatContainer").removeClass("has-chatOpen"),$j("#chatWindow").removeClass("has-closeConfirmDialog"),$j("#chatWindow").addClass("noDisplay"),document.getElementById("oscChatIframe").contentWindow.postMessage("clickedEndChat","*"),window.setTimeout(function(){$j("#oscChatIframe").attr("src",$j("#oscChatIframe").data("url")),jPar.util.customEvent.trigger("oscChat:chatWindowClosed",null,$j("#oscChatContainer")[0])},2e3)},checkBeforeUnload:function(e){($j("#oscChatContainer").hasClass("has-minimizedChat")||$j("#oscChatContainer").hasClass("has-chatOpen"))&&(e.preventDefault(),e.returnValue="")},parseEventData:function(e){try{return JSON.parse(e)}catch(e){return!1}}}}),jPar.app=jPar.app||{},jPar.app.sharedFeatures=jPar.app.sharedFeatures||{},$j.extend(!0,jPar.app.sharedFeatures,{ratingAfterPurchaseLayer:{ratedValue:0,init:function(){var e=this;e.openRatingLayer(),$j(".closeRatingLayerButton").on("click",function(){e.storeLastClosedInLocalStorage()}),$j("#trustpilotButton").on("click",function(){e.triggerTruspilotTrackingEvent(),jPar.wdk.modalbox.hide()})},openRatingLayer:function(){var e=this;if(0<$j("html.localstorage").length){var t=$j("#ratingAfterPurchaseLayer").data("userChiffre"),a=localStorage.getItem("ratingLayerClosed_".concat(t));(null===a||864e5<Date.now()-a)&&jPar.wdk.modalbox.show({modalboxId:"ratingAfterPurchaseLayer",onSuccess:function(){e.rate()}})}},rate:function(){var e=this;$j("#ratingAfterPurchaseLayer .smiley .wdk-button").one("click",function(){e.ratedValue=$j(this).attr("data-rating"),$j(this).addClass("rated"),e.save()})},save:function(){var r=this,e=jPar.wdk.security.getCsrfToken();$j.ajax({type:"POST",url:"/rating/ratingafterpurchase",contentType:"application/json",headers:{"X-CSRF-TOKEN":e},data:JSON.stringify({rate:r.ratedValue}),success:function(e){r.handleSuccess(e)},error:function(e,t,a){r.handleError(e,t,a)}})},handleSuccess:function(e){var t=this;jPar.util.network.hasValidSessionAndCsrfToken(e)?window.setTimeout(function(){e.success?t.showFollowingModal(e):jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"})},600):jPar.util.network.reloadIfResponseInvalid(e)},showFollowingModal:function(e){var t=parseInt(this.ratedValue);t<=2?e.hasWithdrawalRight?jPar.wdk.modalbox.show({modalboxId:"negativeWithdrawableRatingModal"}):jPar.wdk.modalbox.show({modalboxId:"negativeRatingModal"}):3===t?jPar.wdk.modalbox.show({modalboxId:"neutralRatingModal"}):t<=5&&jPar.wdk.modalbox.show({modalboxId:"positiveRatingModal"})},handleError:function(e,t,a){"timeout"!==t&&0!==e.status&&jPar.util.log.error(t+" - "+a,"jPar.app.sharedFeatures.ratingAfterPurchaseLayer failed"),jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"})},storeLastClosedInLocalStorage:function(){if(0<$j("html.localstorage").length){var e=$j("#ratingAfterPurchaseLayer").data("userChiffre");localStorage.setItem("ratingLayerClosed_".concat(e),"".concat(Date.now()))}},triggerTruspilotTrackingEvent:function(){jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"feedback",subcategory:"feedback_layer",action:"click",targetId:"button_to_trustpilot"})}}}),jPar.app=jPar.app||{},jPar.app.sharedFeatures=jPar.app.sharedFeatures||{},$j.extend(!0,jPar.app.sharedFeatures,{videoCall:{stream:{sessionInterval:null,triedCancel:!1,resolutions:[{name:"default",value:"default"},{name:"480p",value:"480p"},{name:"720p",value:"720p"},{name:"1080p",value:"1080p"}],rtc:{client:null,joined:!1,published:!1,localStream:null,remoteStreams:[]},rtcConfig:{network:{appId:"",uid:null,token:"",channel:"",calleeeeUserId:null,callerUserId:null,channelToken:"",encryptionMode:"",encryptionSecret:""},stream:{mode:"live",coec:"h264",microphoneId:"",cameraId:""}},listenForRtmEvents:function(){var e=this;$j("#videoCall").on("videoCall:peerUserIsOnline",function(){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: PeerUserIsOnline")}),$j("#videoCall").on("videoCall:peerUserIsNotOnline",function(){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: PeerUserIsNotOnline"),jPar.wdk.modalbox.show({modalboxId:"videoCallPartnerNotAvailable"}),jPar.app.sharedFeatures.videoCall.uiResetCallWindow(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"layer_rejected_videocall",action:"offline"})}),$j("#videoCall").on("videoCall:RemoteInvitationReceived",function(e){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: invitationAccepted"),jPar.app.sharedFeatures.videoCall.uiIncomingVideoCall(e.detail.callerId)}),$j("#videoCall").on("videoCall:RemoteInvitationCancelled",function(){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: invitationCancelled"),jPar.app.sharedFeatures.videoCall.cancelIncomingVideoCall(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"incoming_call_overlay",targetId:"hung_up",action:"missed"})}),$j("#videoCall").on("videoCall:RemoteInvitationFailure",function(){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: RemoteInvitationFailure"),jPar.app.sharedFeatures.videoCall.cancelIncomingVideoCall(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"incoming_call_overlay",targetId:"timeout",action:"missed"})}),$j("#videoCall").on("videoCall:invitationReceivedByPartner",function(){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: invitationReceivedByPartner"),!0===e.triedCancel&&null!==pegAgora.signaling.localInvitation&&jPar.app.sharedFeatures.videoCall.uiResetCallWindow()}),$j("#videoCall").on("videoCall:invitationAccepted",function(){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: invitationAccepted"),jPar.app.sharedFeatures.videoCall.uiCallAccepted()}),$j("#videoCall").on("videoCall:invitationRefused",function(){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: invitationRefused"),jPar.wdk.modalbox.show({modalboxId:"videoCallPartnerRefusedInvitation"}),jPar.app.sharedFeatures.videoCall.uiResetCallWindow()}),$j("#videoCall").on("videoCall:localInvitationFailure",function(){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: localInvitationFailure"),jPar.wdk.modalbox.show({modalboxId:"videoCallPartnerNotAvailable"}),jPar.app.sharedFeatures.videoCall.uiResetCallWindow()}),$j("#videoCall").on("videoCall:localInvitationCanceled",function(){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: localInvitationCanceled"),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"outgoing_call",action:"invitation_canceled"})}),$j("#videoCall").on("videoCall:callerNotLoggedIn",function(){jPar.util.log.devConsole("################++++++++++++++++++++ listenForRtmEvents: callerNotLoggedIn"),jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),jPar.app.sharedFeatures.videoCall.uiResetCallWindow()})},handleRtcClientEvents:function(r,i){r.client.on("error",function(e){jPar.util.log.devConsole(e)}),r.client.on("peer-leave",function(e){jPar.util.log.devConsole("Event: peer-leave wurde geworfen"),jPar.app.sharedFeatures.videoCall.uiResetCallWindow();var t=e.stream,a=t.getId();t.stop("remote_video_"+a),r.remoteStreams=r.remoteStreams.filter(function(e){return e.getId()!==a}),jPar.app.sharedFeatures.videoCall.removeView(a)}),r.client.on("stream-subscribed",function(e){var t=e.stream,a=t.getId();r.remoteStreams.push(t),jPar.app.sharedFeatures.videoCall.addView(a),t.play("remote_video_"+a),jPar.util.log.devConsole("Event: stream-subscribed remote-uid: ",a)}),r.client.on("stream-added",function(e){var t=e.stream,a=t.getId();jPar.util.log.devConsole("Event: stream-added remote-uid: ",a),a!==i.network.uid&&r.client.subscribe(t,function(e){jPar.util.log.devConsole("Event: stream subscribe failed",e)})})},getSignalingInformation:function(t){var a=this;$j.ajax({type:"GET",url:"/videoCall/loginToken",success:function(e){void 0!==e.agoraAppId&&(a.rtcConfig.network.appId=e.agoraAppId,a.rtcConfig.network.uid=e.agoraUserId,a.rtcConfig.network.token=e.agoraToken,t())},error:function(){}})},setupStartVideoCall:function(){var t=this;t.triedCancel=!1,jPar.app.partnerProfile.messaging.messageMenu.close(),t.setCalleeeeUserId(),t.triggerInitiateCallTracking(),jPar.util.log.devConsole("startVideoCall-------------------------------------------------"),jPar.wdk.loadingIndicator.show($j(".js-startVideoCall")),t.getCallInformationForCaller(t.rtcConfig.network.calleeeeUserId,function(){t.createStream(t.rtc,t.rtcConfig,function(){pegAgora.signaling.rtmClient.queryPeer().then(function(e){!0===e?jPar.app.sharedFeatures.videoCall.showInviteScreen():jPar.util.customEvent.trigger("videoCall:peerUserIsNotOnline",null,$j("#videoCall")[0])})},function(e){jPar.wdk.loadingIndicator.hide($j(".js-startVideoCall")),t.handleCreateStreamError(e),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"error",subcategory:"video_call_error",action:"create_stream",targetId:JSON.stringify(e)})})})},setCalleeeeUserId:function(){0<$j("#profileHeader").length?this.rtcConfig.network.calleeeeUserId=$j("#profileHeader").data("partnerChiffre"):this.rtcConfig.network.calleeeeUserId=$j("#contactList .contactItem.is-active").data("partnerUserId")},triggerInitiateCallTracking:function(){0<$j("#profileHeader").length?jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"profile_view",targetId:"button_initiate_call",action:"click "}):jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"conversation_view",targetId:"button_initiate_call",action:"click "})},getCallInformationForCaller:function(e,t){this.getCallInformation("/videoCall/caller/channel/",e,t)},getCallInformationForCallee:function(e,t){this.getCallInformation("/videoCall/callee/channel/",e,t)},getCallInformation:function(e,t,a){var r=this;$j.ajax({type:"GET",url:e+t,success:function(e){jPar.wdk.loadingIndicator.hide($j(".js-startVideoCall")),!0===jPar.util.network.hasValidSessionAndCsrfToken(e)?(void 0!==e.channelName?(r.rtcConfig.network.calleeeeUserId=e.agoraPartnerId,r.rtcConfig.network.channel=e.channelName,r.rtcConfig.network.channelToken=e.channelToken,r.rtcConfig.network.encryptionMode=e.encryptionMode,r.rtcConfig.network.encryptionSecret=e.encryptionSecret,a()):-1<e.errorCodes.indexOf("RECEIVER_IS_SCAMMER")?jPar.wdk.modalbox.show({modalboxId:"calleeIsScammer"}):-1<e.errorCodes.indexOf("DELETED_CONTACT")?jPar.wdk.modalbox.show({modalboxId:"deletedContact"}):-1<e.errorCodes.indexOf("ENDED_CONTACT")?jPar.wdk.modalbox.show({modalboxId:"endedContact"}):-1<e.errorCodes.indexOf("INITIAL_MESSAGE_LIMIT_PER_CONTACT_EXCEEDED")||-1<e.errorCodes.indexOf("VIDEO_CALL_NOT_ALLOWED")?jPar.wdk.modalbox.show({modalboxId:"videoCallNotAllowed"}):-1<e.errorCodes.indexOf("PROFILE_COMPLETE_NOT_ENOUGH")?jPar.wdk.modalbox.show({modalboxId:"videoCallProfilNotCompleted"}):-1<e.errorCodes.indexOf("VIDEO_CALL_ERROR")?jPar.wdk.modalbox.show({modalboxId:"commonError"}):(jPar.wdk.modalbox.show({modalboxId:"commonError"}),jPar.util.log.error("getCallInformation failed","getCallInformation: response invalid")),void 0===e.channelName&&jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"layer_rejected_videocall",action:"restricted"})):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){jPar.wdk.loadingIndicator.hide($j(".js-startVideoCall")),jPar.util.log.error("getCallInformation failed","getCallInformation failed "+t+" - "+a)}})},createStream:function(e,t,a,r){if(!1===jPar.util.legacyBrowser.isSupported())return r({msg:"NOT_SUPPORTED"}),!1;null===e.localStream?(jPar.util.log.devConsole("AgoraRTC.createStream: ",t.network.uid,t.stream.microphoneId,t.stream.cameraId),e.localStream=AgoraRTC.createStream({streamID:t.network.uid,audio:!0,video:!0,screen:!1,microphoneId:t.stream.microphoneId,cameraId:t.stream.cameraId}),e.localStream.init(function(){jPar.util.log.devConsole("init local stream success"),e.localStream.play("local_stream"),a()},function(e){jPar.util.log.devConsole("init local stream failed ",e),r(e)})):jPar.util.log.devConsole("createStream: stream ist bereits erzeugt")},handleCreateStreamError:function(e){"NotAllowedError"===e.msg||"NotReadableError"===e.msg||"MEDIA_OPTION_INVALID"===e.msg||"PERMISSION_DENIED"===e.msg?jPar.wdk.modalbox.show({modalboxId:"givePermissionModal"}):"NOT_SUPPORTED"===e.msg?jPar.wdk.modalbox.show({modalboxId:"incompatibleBrowser"}):"DEVICES_NOT_FOUND"===e.msg?jPar.wdk.modalbox.show({modalboxId:"noWebcam"}):jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),jPar.app.sharedFeatures.videoCall.uiResetCallWindow()},join:function(t,a,r){var i=this;if(t.joined)jPar.util.log.devConsole("Your already joined");else{var e=i.getGeoFencingForRtc();t.client=AgoraRTC.createClient({mode:a.stream.mode,codec:a.stream.codec,areaCode:e}),t.client.setEncryptionMode(a.network.encryptionMode),t.client.setEncryptionSecret(a.network.encryptionSecret),i.handleRtcClientEvents(t,a),t.client.init(a.network.appId,function(){jPar.util.log.devConsole("init success"),t.client.join(a.network.channelToken,a.network.channel,a.network.uid,function(e){jPar.util.log.devConsole("join channel: "+a.network.channel+" success, uid: "+e),t.joined=!0,i.startSessionPing(),i.publishLocalStream(t),void 0!==r&&r()},function(e){jPar.util.log.devConsole("client join failed",e),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"error",subcategory:"video_call_error",action:"join_channel",targetId:JSON.stringify(e)})})},function(e){jPar.util.log.devConsole(e),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"error",subcategory:"video_call_error",action:"client_init",targetId:JSON.stringify(e)})})}},publishLocalStream:function(t){if(t.client)if(t.published)jPar.util.log.devConsole("Your already published");else{var a=t.published;t.client.publish(t.localStream,function(e){t.published=a,jPar.util.log.devConsole("publish failed",e),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"error",subcategory:"video_call_error",action:"publish_stream",targetId:JSON.stringify(e)})}),jPar.util.log.devConsole("publish"),t.published=!0}else jPar.util.log.devConsole("Please Join Room First")},leaveRtcChannel:function(a){var r=this;a.client?a.joined?a.client.leave(function(){for(;0<a.remoteStreams.length;){var e=a.remoteStreams.shift(),t=e.getId();e.stop(),jPar.app.sharedFeatures.videoCall.removeView(t)}a.remoteStreams=[],a.client=null,jPar.util.log.devConsole("client leaves channel success"),a.published=!1,a.joined=!1,r.stopSessionPing(),jPar.util.log.devConsole("leave success")},function(e){jPar.util.log.devConsole("channel leave failed",e)}):jPar.util.log.devConsole("You are not in channel"):jPar.util.log.devConsole("Please Join First!")},leaveLocalStream:function(e){null!==e.localStream&&(e.localStream.isPlaying()&&e.localStream.stop(),e.localStream.close(),jPar.util.log.devConsole("rtc.localStream.stream",e.localStream.stream),e.localStream=null,jPar.util.log.devConsole("leave localStream success"))},startSessionPing:function(){this.sessionInterval=window.setInterval(function(){$j.ajax({type:"GET",url:"/sessionPing",error:function(e){jPar.util.log.devConsole("Session ping failed",e.statusText)}})},42e4)},stopSessionPing:function(){window.clearInterval(this.sessionInterval),this.sessionInterval=null},getGeoFencingForRtc:function(){var e=[AgoraRTC.AREAS.EUROPE];return jPar.wdk.brands.forBrands(["eh"])&&(e=[AgoraRTC.AREAS.NORTH_AMERICA,AgoraRTC.AREAS.EUROPE,AgoraRTC.AREAS.ASIA]),e}}}}),jPar.app=jPar.app||{},jPar.app.sharedFeatures=jPar.app.sharedFeatures||{},$j.extend(!0,jPar.app.sharedFeatures,{videoCall:{hasAlreadyIncomingCall:!1,iosRingtoneEnabled:!1,hasCallerStartedCall:!1,callStartTime:0,init:function(){var e=this,t=0<$j("#videoCall").length,a=$j("html").hasClass("promises")&&jPar.util.legacyBrowser.isSupported(),r="undefined"==typeof pegAgora;e.setDomEventListener(),t&&a&&r&&this.stream.getSignalingInformation(function(){window.setTimeout(function(){jPar.util.loadScript("agora_combined",function(){pegAgora.signaling.init()})},4e3),e.stream.listenForRtmEvents()})},setDomEventListener:function(){var t=this;$j("html").hasClass("is-appShellView")&&($j("body").on("click touchstart",function(){"undefined"!=typeof pegAgora&&pegAgora.signaling.connectToAgora(),t.enableAudioForIos()}),$j(document).on("visibilitychange",function(){"visible"===document.visibilityState&&"undefined"!=typeof pegAgora&&pegAgora.signaling.connectToAgora()})),$j("body").on("click",".js-startVideoCall",function(e){e.preventDefault(),t.stream.setupStartVideoCall()}),$j("body").on("click",".js-acceptVideoCall",function(e){e.preventDefault(),t.uiAcceptVideoCall()}),$j("body").on("click",".js-declineVideoCall",function(e){e.preventDefault(),jPar.util.log.devConsole("declineVideoCall"),t.uiDeclineVideoCall()}),$j("body").on("click",".js-leaveCall",function(e){e.preventDefault(),t.uiResetCallWindow()}),$j("body").on("click",".js-toggleMic",function(e){e.preventDefault(),jPar.util.log.devConsole("mute toggle"),t.toggleMic($j(this))})},showInviteScreen:function(){this.fillCalleeDetails(),jPar.wdk.loadingIndicator.hide($j(".js-startVideoCall")),$j("#videoCall").addClass("has-justLocalVideo"),pegAgora.signaling.rtmClient.sendInvitation(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"outgoing_call",action:"invitation_sent"}),this.playRingtone("connecting")},fillCalleeDetails:function(){var e=[],t="",a="",r="",i="";0<$j("[data-video-call-partner-info]").length&&(e=$j("[data-video-call-partner-info]").data("videoCallPartnerInfo"),t=$j(".useForVideoCallLayer").data("videoCallPartnerPhoto"),a=e[0],r=""!==e[1]?"&bull; ".concat(e[1]):"",i=",&nbsp; ".concat(e[2])),0<$j("#videoCall").length&&($j("#videoCall #photoBox .photo").css("background-image","url("+t+")"),$j("#videoCall #calleeInfo .occupation").html(a),$j("#videoCall #calleeInfo .givenAliasName").html(r),$j("#videoCall #calleeInfo .age").html(i))},uiCallAccepted:function(){this.stopRingtone(),jPar.wdk.loadingIndicator.hide($j(".js-startVideoCall")),$j("#videoCall").addClass("has-callActive"),this.stream.join(this.stream.rtc,this.stream.rtcConfig,this.triggerStartCall)},cancelIncomingVideoCall:function(){this.stopRingtone(),$j("#incomingCall").removeClass("is-visible"),this.hasAlreadyIncomingCall=!1},uiIncomingVideoCall:function(e){var t=this;null===this.stream.rtc.localStream&&!1===this.hasAlreadyIncomingCall?this.getIncomingCallPeerInfo(e,function(){$j("#incomingCall").addClass("is-visible").attr("role","alert"),t.playRingtone("incomming"),t.hasAlreadyIncomingCall=!0,jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"incoming_call_overlay",action:"received"})}):this.uiDeclineVideoCall()},getIncomingCallPeerInfo:function(e,t){var a=this,r="/videoCall/callerInfo/"+e;$j.ajax({type:"GET",url:r,success:function(e){!0===jPar.util.network.hasValidSessionAndCsrfToken(e)?void 0!==e.name?($j("#incomingCall .primaryPartnerLabel").text(e.name),$j("#incomingCall .age").text(e.age),$j("#incomingCall .photo").css("background-image","url("+e.photoUrl+")"),a.stream.rtcConfig.network.callerUserId=e.userId,t()):jPar.util.log.error("getIncomingCallPeerInfo failed","getIncomingCallPeerInfo: no name defined"):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){jPar.util.log.devConsole("eeeeeerror"),jPar.util.log.error("getIncomingCallPeerInfo failed","getIncomingCallPeerInfo failed "+t+" - "+a)}})},uiAcceptVideoCall:function(){var t=this;t.stream.createStream(t.stream.rtc,t.stream.rtcConfig,function(){t.stopRingtone(),$j("#incomingCall").removeClass("is-visible"),$j("#videoCall").addClass("has-callActive"),t.stream.getCallInformationForCallee(t.stream.rtcConfig.network.callerUserId,function(){pegAgora.signaling.rtmClient.acceptVideoInvitation(),t.stream.join(t.stream.rtc,t.stream.rtcConfig,function(){jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"incoming_call",action:"call_started",targetId:t.stream.rtcConfig.network.callerUserId})}),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"incoming_call_overlay",action:"accepted"})})},function(e){jPar.util.log.devConsole("create stream failed: ",e),t.stopRingtone(),$j("#incomingCall").removeClass("is-visible"),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"error",subcategory:"video_call_error",action:"create_stream",targetId:JSON.stringify(e)}),t.uiDeclineVideoCall(),t.stream.handleCreateStreamError(e)}),this.hasAlreadyIncomingCall=!1},uiDeclineVideoCall:function(){this.stopRingtone(),$j("#incomingCall").removeClass("is-visible"),pegAgora.signaling.rtmClient.declineVideoInvitation(),this.hasAlreadyIncomingCall=!1,jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"incoming_call_overlay",action:"rejected"})},uiResetCallWindow:function(){jPar.util.log.devConsole("-- User is hanging up --"),this.stopRingtone(),this.triggerEndCall(),jPar.wdk.loadingIndicator.hide($j(".js-startVideoCall")),$j("#videoCall").removeClass("has-justLocalVideo"),$j("#videoCall").removeClass("has-callActive"),this.switchIcon($j(".icon_mic"),"icon_mic_off","icon_mic"),this.stream.leaveLocalStream(this.stream.rtc),this.stream.leaveRtcChannel(this.stream.rtc),"undefined"!=typeof pegAgora&&pegAgora.signaling.rtmClient.cancel()},playRingtone:function(e){var t=document.querySelector("#ringtone-".concat(e));t.setAttribute("src",document.querySelector("#ringtone-".concat(e)).getAttribute("data-ringtone-".concat(e))),t.loop=!0,t.currentTime=0;var a=t.play();a&&a.catch(function(e){"NotAllowedError"!==e.name&&"NotSupportedError"!==e.name||jPar.util.log.devConsole("playRingtone: "+e.name)}).then(function(){})},stopRingtone:function(){0<$j("audio").length&&$j("audio").each(function(){this.setAttribute("src","#"),this.pause(),this.currentTime=0})},enableAudioForIos:function(){if($j("html").hasClass("ios")&&!1===this.iosRingtoneEnabled){var e=$j("#ringtone-silence")[0];if(void 0!==e){var t=e.play();this.iosRingtoneEnabled=!0,t&&t.catch(function(e){"NotAllowedError"!==e.name&&"NotSupportedError"!==e.name||jPar.util.log.devConsole(e.name)}).then(function(){})}}},addView:function(e){jPar.util.log.devConsole("-------------RemoteVideo Divs erstellen",e,$j("#"+e).length),0===$j("#"+e).length&&(jPar.util.log.devConsole("erzeuge remote_video_panel_"+e),$j("<div/>",{id:"remote_video_panel_"+e,class:"video-view remoteVideoView"}).prependTo("#videoCall .vidoCallWrapper"),$j("<div/>",{id:"remote_video_"+e,class:"video-placeholder"}).appendTo("#remote_video_panel_"+e),$j("<div/>",{id:"remote_video_info_"+e,class:"video-profile hide"}).appendTo("#remote_video_panel_"+e),$j("<div/>",{id:"video_autoplay_"+e,class:"autoplay-fallback hide"}).appendTo("#remote_video_panel_"+e))},removeView:function(e){jPar.util.log.devConsole("removeView",e),0<$j("#remote_video_panel_"+e).length&&$j("#remote_video_panel_"+e).remove()},switchIcon:function(e,t,a){var r=new RegExp(t,"g"),i="";e.is("svg")?!1===$j("html").hasClass("ie")&&(i=e.find("use").attr("xlink:href").replace(r,a),e.find("use").attr("xlink:href",i)):(i=e.attr("src").replace(r,a),e.attr("src",i))},toggleMic:function(e){jPar.util.log.devConsole("toggleMic Function"),e.hasClass("is-micOn")?(e.removeClass("is-micOn"),e.addClass("is-micOff"),this.switchIcon(e.find("svg"),"icon_mic","icon_mic_off"),this.stream.rtc.localStream.muteAudio()):e.hasClass("is-micOff")&&(e.removeClass("is-micOff"),e.addClass("is-micOn"),this.switchIcon(e.find("svg"),"icon_mic_off","icon_mic"),this.stream.rtc.localStream.unmuteAudio())},triggerStartCall:function(){jPar.app.sharedFeatures.videoCall.hasCallerStartedCall=!0,jPar.app.sharedFeatures.videoCall.callStartTime=(new Date).getTime(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"outgoing_call",action:"call_started",targetId:jPar.app.sharedFeatures.videoCall.stream.rtcConfig.network.calleeeeUserId})},triggerEndCall:function(){jPar.app.sharedFeatures.videoCall.hasCallerStartedCall&&jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"video_call",subcategory:"outgoing_call",action:"call_ended",targetId:Math.round(((new Date).getTime()-jPar.app.sharedFeatures.videoCall.callStartTime)/1e3).toString()}),jPar.app.sharedFeatures.videoCall.hasCallerStartedCall=!1},qaDebug:{showInviteScreen:function(){jPar.app.sharedFeatures.videoCall.showInviteScreen()}}}}),$j(window).on("load",function(){document.getElementById("ringtone-incomming")&&document.querySelector("#ringtone-incomming").setAttribute("src",document.querySelector("#ringtone-incomming").getAttribute("data-ringtone-incomming"))}),jPar.app.dataAndSettings=jPar.app.dataAndSettings||{},$j.extend(!0,jPar.app.dataAndSettings,{cancellation:{reason:{settingsUtil:null,init:function(){var t=this;this.settingsUtil=jPar.app.dataAndSettings.utils,this.arDowngrade.init(),$j("#cancellationReasonForm").on("submit",function(e){t.validateForm(),t.formHasErrors()&&e.preventDefault()}),$j("#cancellationReasonForm").on("change",function(){$j(this).find(".js-reasonContinue").removeClass("visuallyDisabled")})},arDowngrade:{init:function(){if(0<$j("#arDowngradeModal").length){var t=this;$j(".js-showArDowngradeModal").on("click",function(e){e.preventDefault(),t.showArDowngradeModal()}),$j("#downgradeTerms").on("change",function(){t.validateCheckbox()}),$j(".js-takeDowngrade").on("click",function(e){e.preventDefault(),t.validateCheckbox()&&t.takeDowngrade(e)}),$j(".js-doNotTakeDowngrade").on("click",function(e){e.preventDefault(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"downgrade_auto_renewal_offer",subcategory:"offer_layer",action:"click",targetId:"button_offer_reject"}),$j("#cancellationReasonForm").submit()}),$j(".js-closeModalbox").on("click",function(e){e.preventDefault(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"downgrade_auto_renewal_offer",subcategory:"offer_layer",action:"click",targetId:"close"})}),$j("#arDowngradeSuccessModal footer a").on("click",function(e){jPar.wdk.loadingIndicator.show($j(e.currentTarget))})}},showArDowngradeModal:function(){jPar.app.dataAndSettings.cancellation.reason.validateForm(),!1===jPar.app.dataAndSettings.cancellation.reason.formHasErrors()&&(jPar.wdk.modalbox.show({modalboxId:"arDowngradeModal"}),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"downgrade_auto_renewal_offer",subcategory:"offer_layer",action:"layer_view"}))},validateCheckbox:function(){var e=jPar.util.validate.checkboxIsChecked($j("#downgradeTerms"));return e?jPar.wdk.forms.hideError($j("#downgradeTermsError")):(jPar.wdk.forms.showError($j("#downgradeTermsError")),window.setTimeout(function(){$j("#downgradeTermsError")[0].scrollIntoView()},100)),e},takeDowngrade:function(e){var t=this,a=$j(e.currentTarget);jPar.wdk.forms.hideError($j("#generalDowngradeError")),jPar.wdk.loadingIndicator.show(a),$j.ajax({type:"POST",url:"/profile/cancellation/take_downgrade",data:$j("#arDowngradeModal form").serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(a),!0===e.success?(jPar.wdk.modalbox.show({modalboxId:"arDowngradeSuccessModal"}),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"downgrade_auto_renewal_offer",subcategory:"offer_layer",action:"click",targetId:"button_offer_accept"})):t.handleInvalidResponse(e)},error:function(){jPar.wdk.loadingIndicator.hide(a),jPar.wdk.forms.showError($j("#generalDowngradeError")),window.setTimeout(function(){$j("#generalDowngradeError")[0].scrollIntoView()},100)}})},handleInvalidResponse:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):(jPar.wdk.forms.showError($j("#generalDowngradeError")),window.setTimeout(function(){$j("#generalDowngradeError")[0].scrollIntoView()},100))}},validateForm:function(){var e=$j("#noReasonError"),t=$j('#cancellationReasonForm input[type="radio"]');!1===jPar.util.validate.radioIsSelected(t)?jPar.wdk.forms.showError(e):jPar.wdk.forms.hideError(e)},formHasErrors:function(){return jPar.wdk.forms.hasVisibleErrors($j("#cancellationReasonForm"))}}}}),jPar.app.dataAndSettings=jPar.app.dataAndSettings||{},$j.extend(!0,jPar.app.dataAndSettings,{cancellation:{withdrawalPrevent:{init:function(){var e=this;e.concernPage.init(),e.changeMembershipPage.init(),e.dissatisfiedPage.init(),e.contactTypePage.init(),e.mailCustomerServicePage.init()},concernPage:{init:function(){var t=this,e=jPar.app.dataAndSettings.cancellation.withdrawalPrevent,a=e.enableSubmitButton,r=e.validateAnswersForm;0<$j("#cancellationConcernContainer").length&&($j("#startChangeMembership").on("click",function(){$j("#cancellationConcernContainer").removeClass("is-closed"),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"manage_profile",targetId:"button_change_subscription",action:"click"})}),a($j("#cancellationConcernForm")),$j("#cancellationConcernForm").on("submit",function(e){r($j(this),e),t.trackingForCancellationTermtime()}))},trackingForCancellationTermtime:function(){var e="";switch($j('input[type="radio"]:checked',"#cancellationConcernForm").val()){case"CANCELLATION":e=jPar.wdk.brands.forBrands(["eh"])?"button_next|disable_auto_renawal":"button_next|cancellation_information";break;case"CHANGE_MEMBERSHIP":e="button_next|change_membership";break;case"DISSATISFIED":e="button_next|dissatisfied";break;default:e="button_next|no_selection"}jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"manage_profile",targetId:e,action:"click"})}},changeMembershipPage:{init:function(){var t=this,e=jPar.app.dataAndSettings.cancellation.withdrawalPrevent,a=e.enableSubmitButton,r=e.validateAnswersForm;0<$j("#cancellationChangeMembershipPage").length&&(a($j("#cancellationChangeMembershipForm")),$j("#cancellationChangeMembershipForm").on("submit",function(e){r($j(this),e),t.trackingForChangeMembership()}))},trackingForChangeMembership:function(){var e="";switch($j('#cancellationChangeMembershipForm input[type="radio"]:checked').val()){case"RESTRUCTURE_PLAN":e="button_next|restructure_plan";break;case"MEMBERSHIP_TOO_LONG":e="button_next|membership_too_long";break;case"TOO_EXPENSIVE":e="button_next|too_expensive";break;case"SOMETHING_ELSE":e="button_next|something_else";break;default:e=""}""!==e&&jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"change_membership",targetId:e,action:"click"})}},dissatisfiedPage:{init:function(){var t=this,e=jPar.app.dataAndSettings.cancellation.withdrawalPrevent,a=e.enableSubmitButton,r=e.validateAnswersForm;0<$j("#cancellationDissatisfiedPage").length&&(a($j("#cancellationDissatisfiedForm")),$j("#cancellationDissatisfiedForm").on("submit",function(e){r($j(this),e),t.trackingForDissatisfied()}))},trackingForDissatisfied:function(){var e="";switch($j('#cancellationDissatisfiedForm input[type="radio"]:checked').val()){case"BAD_EXPERIENCE":e="button_next|bad_experience";break;case"NO_SUCCESS":e="button_next|no_success";break;case"DONT_LIKE_MATCHES":e="button_next|dont_like_matches";break;case"NOT_ENOUGH_COMMUNICATION":e="button_next|not_enough_communication";break;case"MATCHES_TOO_FAR_AWAY":e="button_next|matches_too_far_away";break;case"NOT_ENOUGH_MATCHES":e="button_next|not_enough_matches";break;case"TOO_EXPENSIVE":e="button_next|too_expensive";break;case"SOMETHING_ELSE":e="button_next|something_else";break;default:e=""}""!==e&&jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"dissatisfied",targetId:e,action:"click"})}},contactTypePage:{init:function(){if(0<$j("#cancellationContactTypePage").length){this.prepareChat();var e=$j(".buttonsContainer").data("topic"),t=$j(".buttonsContainer").data("concern"),a="".concat(e,"|").concat(t);$j("#cancellationContactTypePage #openContactForm").on("click",function(){jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"customer_care_selection|"+a,targetId:"button_contact_form",action:"click"})}),0<$j("#customerPhoneLink").length&&$j("#customerPhoneLink").on("click",function(){jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"customer_care_selection|"+a,targetId:"link_phone_number",action:"click"})})}},prepareChat:function(){var e=!1,t=!1,a=$j(".buttonsContainer").data("topic"),r=$j(".buttonsContainer").data("concern"),i="".concat(a,"|").concat(r);jPar.app.sharedFeatures.oscChat.init(),$j("#oscChatContainer").on("oscChat:showChatButton",function(){$j(".js-openOscChat").parents(".buttonItem").removeClass("noDisplay"),$j("#openContactForm").removeClass("t-primarySkin1").addClass("t-basicSkin1"),!1===e&&(e=!0,jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"customer_care_selection|"+i,action:"screen_view",targetId:"livechat_available"}))}),$j("#oscChatContainer").on("oscChat:hideChatButton",function(){$j(".js-openOscChat").parents(".buttonItem").addClass("noDisplay"),$j("#openContactForm").removeClass("t-basicSkin1").addClass("t-primarySkin1"),!1===t&&(t=!0,jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"customer_care_selection|"+i,action:"screen_view",targetId:"livechat_not_available"}))}),$j(".js-openOscChat").on("click",function(){$j(".js-openOscChat").attr("disabled",!0),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"customer_care_selection|"+i,action:"click",targetId:"button_live_chat"})}),$j("#oscChatContainer").on("oscChat:agentAccepted",function(){jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"live_chat|"+i,action:"initialized"})}),$j("#oscChatContainer").on("oscChat:chatWindowClosed",function(){$j(".js-openOscChat").removeAttr("disabled")})}},mailCustomerServicePage:{init:function(){if(0<$j("#cancellationSendMailPage").length){var i=this;this.toggleTextareaDisplay(),jPar.wdk.forms.customDropdown.init("#cancellationSendMailForm",function(e){var t=$j(e.target),a=t.data("value");if(t.parents(".wdk-form-customDropdown").find('input[type="hidden"]').val(a),i.updateDropdownList(a),"NO_CHOICE"!==a){var r=t.parents(".wdk-form-element").find(".wdk-styledHintBox.t-errorForm");jPar.wdk.forms.hideError(r),$j("#sendMail").prop("disabled",!1)}i.toggleTextareaDisplay(t)}),$j("#cancellationSendMailForm").on("submit",function(e){e.preventDefault();var t=$j("#membershipHelpChoiceEntry_Step1").val().toLowerCase(),a=$j("form .is-visible input").val();jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"customer_care_contact_form|".concat(t),targetId:"button_submit|".concat(a),action:"click"}),i.validateContactForm(),i.formIsValid()&&i.sendContactForm()}),$j("#membershipHelpTextarea").on("keyup change",function(){jPar.wdk.forms.hideError($j("#membershipHelpTextareaError")),$j("#sendMail").prop("disabled",!1)})}},updateDropdownList:function(e){var t="";"CHANGE_MEMBERSHIP"===e?($j(".changeMembershipAnswers").addClass("is-visible"),t=$j('.changeMembershipAnswers li[data-value="NO_CHOICE"]').text(),$j(".changeMembershipAnswers li").removeClass("selectedListItem"),$j('.changeMembershipAnswers li[data-value="NO_CHOICE"]').addClass("selectedListItem"),$j(".changeMembershipAnswers a").text(t),$j(".changeMembershipAnswers a").data("hasTextarea","false"),$j("#changeMembershipConcernEntry").val("NO_CHOICE"),$j(".dissatisfiedAnswers").removeClass("is-visible"),$j("#changeMembershipConcernEntry").prop("disabled",!1),$j("#dissatisfiedConcernEntry").prop("disabled",!0)):"DISSATISFIED"===e&&($j(".dissatisfiedAnswers").addClass("is-visible"),t=$j('.dissatisfiedAnswers li[data-value="NO_CHOICE"]').text(),$j(".dissatisfiedAnswers li").removeClass("selectedListItem"),$j('.dissatisfiedAnswers li[data-value="NO_CHOICE"]').addClass("selectedListItem"),$j(".dissatisfiedAnswers a").text(t),$j(".dissatisfiedAnswers a").data("hasTextarea","false"),$j("#dissatisfiedConcernEntry").val("NO_CHOICE"),$j(".changeMembershipAnswers").removeClass("is-visible"),$j("#changeMembershipConcernEntry").prop("disabled",!0),$j("#dissatisfiedConcernEntry").prop("disabled",!1))},toggleTextareaDisplay:function(e){if(e){var t=e.data("hasTextarea");e.parents(".wdk-form-customDropdown").find(".is-visible a").data("hasTextarea",t)}!0===$j(".wdk-form-customDropdown .is-visible > a").data("hasTextarea")?($j("#membershipHelpTextareaContainer").addClass("is-visible"),$j("#membershipHelpTextarea").prop("disabled",!1)):($j("#membershipHelpTextareaContainer").removeClass("is-visible"),$j("#membershipHelpTextarea").prop("disabled",!0),jPar.wdk.forms.hideError($j("#membershipHelpTextareaError")),$j("#sendMail").prop("disabled",!1))},sendContactForm:function(){jPar.wdk.loadingIndicator.show($j("#sendMail"));var e=$j("#cancellationSendMailForm"),t=e.attr("action"),a=e.serialize();$j.ajax({type:"POST",url:t,data:a,success:function(){jPar.wdk.loadingIndicator.hide($j("#sendMail"));var e=$j("#membershipHelpChoiceEntry_Step1").val().toLowerCase(),t=$j("form .is-visible input").val();jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"withdrawal",subcategory:"customer_care_contact_form|".concat(e),targetId:"button_submit|".concat(t),action:"submit_successful"}),jPar.wdk.modalbox.show({modalboxId:"contactformSubmitdModal"})},error:function(e,t,a){jPar.wdk.loadingIndicator.hide($j("#sendMail")),"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),""!==a&&0!==e.status&&jPar.util.log.error(e.status+" - "+a,"Submit failed"))}})},validateContactForm:function(){var e=$j("#membershipHelpChoiceEntry_Step1").val(),t=$j("#dissatisfiedConcernEntry").val(),a=$j("#changeMembershipConcernEntry").val(),r="DISSATISFIED"===e&&"NO_CHOICE"===t,i="CHANGE_MEMBERSHIP"===e&&"NO_CHOICE"===a,o=!1;0<$j("#membershipHelpTextareaContainer.is-visible #membershipHelpTextarea").length&&(o=""===$j("#membershipHelpTextareaContainer.is-visible #membershipHelpTextarea").val().trim()),"NO_CHOICE"===e&&(jPar.wdk.forms.showError($j("#errorBox_concernDropdown")),$j("#sendMail").prop("disabled",!0)),(r||i)&&(jPar.wdk.forms.showError($j("#errorBox_specifiedConcernDropdown")),$j("#sendMail").prop("disabled",!0)),o&&(jPar.wdk.forms.showError($j("#membershipHelpTextareaError")),$j("#sendMail").prop("disabled",!0))},formIsValid:function(){return!jPar.wdk.forms.hasVisibleErrors($j("#cancellationSendMailForm"))}},validateAnswersForm:function(e,t){var a=$j("#noAnswerSelectedError"),r=e.find('input[type="radio"]');!1===jPar.util.validate.radioIsSelected(r)?(t.preventDefault(),jPar.wdk.forms.showError(a),$j(".nextButton").attr("disabled",!0)):(jPar.wdk.forms.hideError(a),$j(".nextButton").attr("disabled",!1))},enableSubmitButton:function(e){e.find("input").on("change",function(){e.find("button[type=submit]").attr("disabled",!1),$j("#noAnswerSelectedError").removeClass("is-visible")})}}}}),jPar.app.dataAndSettings=jPar.app.dataAndSettings||{},$j.extend(!0,jPar.app.dataAndSettings,{disconnectSocialLogin:{init:function(){var t=this;jPar.wdk.passwordRestrictionBox.init(),$j("#disconnectAppleForm").on("submit",function(e){t.validateEmail(),t.validatePassword(),jPar.wdk.forms.hasVisibleErrors($j("#disconnectAppleForm"))&&e.preventDefault()}),$j("#disconnectFacebookForm").on("submit",function(e){t.validatePassword(),jPar.wdk.forms.hasVisibleErrors($j("#disconnectFacebookForm"))&&e.preventDefault()})},validateEmail:function(){if(0<$j("#email").length){var e=$j("#email"),t=$j("#emailInvalidError");!0===jPar.util.validate.isEmailAddress(e)?jPar.wdk.forms.hideError(t):jPar.wdk.forms.showError(t)}},validatePassword:function(){var e=$j("#passwordEmpty"),t=$j("#passwordCheckEmpty"),a=jPar.util.validate.textfieldIsEmpty($j("#passwordRow").find("input")),r=jPar.util.validate.textfieldIsEmpty($j("#passwordCheckRow").find("input"));if(a||r)a?jPar.wdk.forms.showError(e):jPar.wdk.forms.hideError(e),r?jPar.wdk.forms.showError(t):jPar.wdk.forms.hideError(t);else{jPar.wdk.forms.hideError(e),jPar.wdk.forms.hideError(t);var i=$j("#passwordMismatch");$j("#passwordRow").find("input").val()!==$j("#passwordCheckRow").find("input").val()?jPar.wdk.forms.showError(i):jPar.wdk.forms.hideError(i);var o=$j("#newPasswordNotValid");!1===jPar.wdk.passwordRestrictionBox.isPasswordValid()?jPar.wdk.forms.showError(o):jPar.wdk.forms.hideError(o)}}}}),jPar.app.dataAndSettings=jPar.app.dataAndSettings||{},$j.extend(!0,jPar.app.dataAndSettings,{idSecure:{phone:{settingsUtil:null,init:function(){var t=this;this.settingsUtil=jPar.app.dataAndSettings.utils,$j("#enterPhoneForm").on("submit",function(e){t.validateForm(),t.formHasErrors()&&e.preventDefault()})},validateForm:function(){var e=$j("#mobilePrefixRow"),t=$j("#mobilePrefixError");jPar.util.validate.selectBoxHasValue(e.find("select"),"-1")?jPar.wdk.forms.showError(t):jPar.wdk.forms.hideError(t);var a=$j("#numberRow"),r=$j("#numberError"),i=a.find("input"),o=i.val().trim().replace(/ /g,"");i.val(o),jPar.util.validate.textfieldIsEmpty(i)||!1===jPar.util.validate.isNumber(i)?jPar.wdk.forms.showError(r):jPar.wdk.forms.hideError(r);var n=$j("#agbAcceptedError");!1===jPar.util.validate.checkboxIsChecked($j("#agbAccepted"))?jPar.wdk.forms.showError(n):jPar.wdk.forms.hideError(n)},formHasErrors:function(){return jPar.wdk.forms.hasVisibleErrors($j("#enterPhoneForm"))}},pin:{init:function(){var t=this;this.settingsUtil=jPar.app.dataAndSettings.utils,jPar.util.putCursorAtEnd($j("#pinRow").find("input")),$j("#enterPinForm").on("submit",function(e){t.validateForm(),t.formHasErrors()&&e.preventDefault()})},validateForm:function(){$j("#enterPinForm").find(".wdk-styledHintBox.beValidationError").removeClass("is-visible");var e=$j("#pinRow input"),t=$j("#pinError");jPar.util.validate.textfieldIsEmpty(e)||7!==$j.trim(e.val()).length||!1===jPar.util.validate.isNumber(e)?(jPar.wdk.forms.showError(t),jPar.util.putCursorAtEnd($j("#pinRow").find("input"))):jPar.wdk.forms.hideError(t)},formHasErrors:function(){return jPar.wdk.forms.hasVisibleErrors($j("#enterPinForm"))}}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{dataAndSettings:{init:function(){jPar.wdk.cardDeck.init(),jPar.wdk.forms.init(),0<$j("#manageProfilePage").length&&this.manageProfile.init(),0<$j("body.disconnectSocialLoginPages").length&&this.disconnectSocialLogin.init(),0<$j("#personaldataPage").length&&this.personaldata.init(),(0<$j("#notificationPage").length||0<$j("#notificationoptionsDuringTestPage").length)&&this.notification.init(),0<$j("#idSecureEnterPhonePage").length&&this.idSecure.phone.init(),0<$j("#idSecureEnterPinPage").length&&this.idSecure.pin.init(),0<$j("#cancellationTermtimePage").length&&$j("#openContractConditions").on("click",function(){jPar.wdk.modalbox.show({modalboxId:"contractConditionModalbox"})}),0<$j("#cancellationReasonPage").length&&this.cancellation.reason.init(),0<$j("#cancellationTermtimePage, #cancellationChangeMembershipPage, #cancellationDissatisfiedPage, #cancellationContactTypePage, #cancellationSendMailPage").length&&this.cancellation.withdrawalPrevent.init(),0<$j("#personalDataInquiryPage").length&&this.personalDataInquiry.init(),0<$j("form.passwordForm").length&&this.passwordForm.init()},utils:{handleNetworkError:function(e,t,a,r){"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),0!==e.status&&403!==e.status&&jPar.util.log.error(r.attr("id")+" - "+e.status+" - "+a,"DataAndSettings save failed"));var i=r.prop("checked");r.prop("checked",!i)}}}}),jPar.app.dataAndSettings=jPar.app.dataAndSettings||{},$j.extend(!0,jPar.app.dataAndSettings,{manageProfile:{settingsUtil:null,init:function(){var e=this;this.settingsUtil=jPar.app.dataAndSettings.utils,$j("#openPaymentPlan").on("click",function(){jPar.wdk.modalbox.show({modalboxId:"#paymentPlanModal"})}),$j("#profileVisibleSwitch").on("change",function(){e.saveProfileStatus()}),$j("#visitorListSwitch").on("change",function(){e.saveVisitorListStatus()}),$j("#onlineStatusSwitch").on("change",function(){e.saveOnlineStatus()}),0<$j("#disconnectedSocialNotification").length&&jPar.wdk.toast.show("#disconnectedSocialNotification"),$j("#openResetQuestionnaire").on("click",function(){jPar.wdk.modalbox.show({modalboxId:"resetQuestionnaireModal"})}),$j("#downloadExpertise").on("click",function(){e.downloadExpertise(this)}),this.initPasswordEdit()},downloadExpertise:function(){var t=this;jPar.wdk.modalbox.show({modalboxId:"#preparingExpertiseDownload"});var e=new XMLHttpRequest;e.open("GET","/settings/dataandsettings/expertisedownload",!0),e.responseType="arraybuffer",e.onload=function(){if(void 0!==this.responseURL&&-1!==this.responseURL.indexOf("login"))jPar.util.network.reloadIfResponseInvalid("loginForm");else if(200===this.status){jPar.wdk.modalbox.hide();var e=$j("#downloadExpertise").data("expertisePdfFilename");t.savePdf(this.response,e)}else{405===this.status?jPar.wdk.modalbox.show({modalboxId:"#tooManyExpertiseDownloadRequestsModal"}):jPar.wdk.modalbox.show({modalboxId:"#expertiseDownloadExceptionModal"})}},e.send()},savePdf:function(e,t){if("Blob"in window){var a=new Blob([e],{type:"application/pdf"});if("msSaveOrOpenBlob"in navigator)navigator.msSaveOrOpenBlob(a,t);else{var r=document.createElement("a");r.download=t,r.innerHTML="Download File",r.href=window.URL.createObjectURL(a),r.onclick=function(e){document.body.removeChild(e.target)},r.style.display="none",document.body.appendChild(r),r.click()}}},initPasswordEdit:function(){var t=this;jPar.wdk.passwordRestrictionBox.init(),$j("#setNewPassword").on("click keyup",function(e){jPar.util.validate.isMouseclickEnterOrSpaceKey(e.keyCode)&&(jPar.wdk.modalbox.show({modalboxId:"setNewPasswordModal"}),t.saveNewPassword.setFocusToPasswordField())}),$j("#setNewPasswordModal").on("submit",function(e){e.preventDefault(),t.saveNewPassword.save()}),$j(document).on("wdk:modalbox:isHidden",function(e){"setNewPasswordModal"===e.detail.$modalboxObj.attr("id")&&t.saveNewPassword.resetFormOnAbort()})},saveProfileStatus:function(){var e=$j("#profileStatusForm"),t=$j("#profileVisibleSwitch").prop("checked"),a={_csrf:jPar.wdk.security.getCsrfToken(),profileVisible:t};$j.ajax({type:e.attr("method"),url:e.attr("action"),data:a,success:function(e){!0===jPar.util.network.hasValidSessionAndCsrfToken(e)?t?($j("#profileStatus .profileVisibleText").removeClass("noDisplay"),$j("#profileStatus .profileInvisibleText").addClass("noDisplay")):($j("#profileStatus .profileVisibleText").addClass("noDisplay"),$j("#profileStatus .profileInvisibleText").removeClass("noDisplay")):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){jPar.app.dataAndSettings.utils.handleNetworkError(e,t,a,$j("#profileVisibleSwitch"))}})},saveVisitorListStatus:function(){var e=$j("#visitorListForm"),t=!1===$j("#visitorListSwitch").prop("checked"),a={_csrf:jPar.wdk.security.getCsrfToken(),hideMyVisits:t};$j.ajax({type:e.attr("method"),url:e.attr("action"),data:a,success:function(e){!0===jPar.util.network.hasValidSessionAndCsrfToken(e)?t?($j("#visitorList .visitorListInactiveText").removeClass("noDisplay"),$j("#visitorList .visitorListActiveText").addClass("noDisplay")):($j("#visitorList .visitorListInactiveText").addClass("noDisplay"),$j("#visitorList .visitorListActiveText").removeClass("noDisplay")):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){jPar.app.dataAndSettings.utils.handleNetworkError(e,t,a,$j("#visitorListSwitch"))}})},saveOnlineStatus:function(){var e=$j("#onlineStatusForm"),t=$j("#onlineStatusSwitch").prop("checked"),a={_csrf:jPar.wdk.security.getCsrfToken(),onlineStatusVisible:t};$j.ajax({type:e.attr("method"),url:e.attr("action"),data:a,success:function(e){!0===jPar.util.network.hasValidSessionAndCsrfToken(e)?t?($j("#onlineStatus .onlineStatusVisibleText").removeClass("noDisplay"),$j("#onlineStatus .onlineStatusInvisibleText").addClass("noDisplay")):($j("#onlineStatus .onlineStatusVisibleText").addClass("noDisplay"),$j("#onlineStatus .onlineStatusInvisibleText").removeClass("noDisplay")):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){jPar.app.dataAndSettings.utils.handleNetworkError(e,t,a,$j("#visitorListSwitch"))}})},saveNewPassword:{settingsUtil:null,setFocusToPasswordField:function(){window.setTimeout(function(){jPar.util.putCursorAtEnd($j("#oldPassword"))},500)},save:function(){var t=this;t.settingsUtil=jPar.app.dataAndSettings.utils;var e=$j("#setNewPasswordModal"),r=e.find("button.saveElement");t.validateForm(),this.formIsValid()&&(jPar.wdk.loadingIndicator.show(r),$j.ajax({type:"POST",url:e.attr("action"),data:e.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(r),!0===jPar.util.network.hasValidSessionAndCsrfToken(e)?t.handleResponse(e):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){"timeout"===t?(jPar.wdk.toast.show("#timeoutNotification"),jPar.util.log.ui("dataAndSettings","savedataandsettings","newPassword")):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),0!==e.status&&403!==e.status&&jPar.util.log.error(e.status+" - "+a,"dataAndSettings manageProfile save faild")),jPar.wdk.loadingIndicator.hide(r)}}))},formIsValid:function(){return!1===jPar.wdk.forms.hasVisibleErrors($j("#setNewPasswordModal"))},validateForm:function(){jPar.wdk.forms.hideError($j("#oldPasswordNotValid"));var e=$j("#oldPasswordEmpty");jPar.util.validate.textfieldIsEmpty($j("#oldPasswordRow input"))?jPar.wdk.forms.showError(e):jPar.wdk.forms.hideError(e);var t=$j("#passwordRow"),a=$j("#passwordEmpty");jPar.util.validate.textfieldIsEmpty(t.find("input"))?jPar.wdk.forms.showError(a):jPar.wdk.forms.hideError(a);var r=$j("#passwordCheckRow"),i=$j("#passwordCheckEmpty");jPar.util.validate.textfieldIsEmpty(r.find("input"))?jPar.wdk.forms.showError(i):jPar.wdk.forms.hideError(i);var o=$j("#passwordMismatch");t.find("input").val()!==r.find("input").val()?jPar.wdk.forms.showError(o):jPar.wdk.forms.hideError(o);var n=$j("#newPasswordNotValid");!1===$j("#wdk-passwordRestrictionBox").hasClass("success")?jPar.wdk.forms.showError(n):jPar.wdk.forms.hideError(n)},handleResponse:function(e){!0===e.success?(jPar.wdk.modalbox.hide(),jPar.wdk.toast.show("#newPasswordNotification")):!0===e.hasOldPasswordError?jPar.wdk.forms.showError($j("#oldPasswordNotValid")):!0===e.hasNewPasswordError&&jPar.wdk.forms.showError($j("#newPasswordNotValid"))},resetFormOnAbort:function(){var e=$j("#setNewPasswordModal");e.find(".wdk-form-text input[type=password]").val(""),e.find(".has-error").removeClass("has-error"),e.find(".wdk-styledHintBox").removeClass("is-visible"),$j("#wdk-passwordRestrictionBox, #minCharacters, #lettersAndNumbers").removeClass("success")}}}}),jPar.app.dataAndSettings=jPar.app.dataAndSettings||{},$j.extend(!0,jPar.app.dataAndSettings,{notification:{settingsUtil:null,init:function(){var t=this;this.settingsUtil=jPar.app.dataAndSettings.utils,this.syncGlobalToggleState(),$j("#notificationGlobalForm input[type=checkbox]").on("change",function(e){t.saveGlobal(e,$j(this))}),$j("#notificationForm input[type=checkbox]").on("change",function(e){t.save(e,$j(this))})},syncGlobalToggleState:function(){var e=0===$j("#notificationForm input[type=checkbox]").filter(":checked").length,t=$j("#notificationGlobalForm");t.find("input[type=checkbox]").prop("checked",e),t.find(".stateActive").toggleClass("noDisplay",e),t.find(".stateInactive").toggleClass("noDisplay",!e)},saveGlobal:function(e,t){var a=$j("#notificationGlobalForm"),r=$j(e.target),i=!t.prop("checked");$j("#notificationForm input[type=checkbox]").prop("checked",i);var o="_csrf="+jPar.wdk.security.getCsrfToken();o+="&subscribe="+i,this.callAjaxForm(a,o,r)},save:function(e,t){var a=$j("#notificationForm"),r=$j(e.target),i="NEVER";t.prop("checked")&&(i="IMMEDIATELY");var o="notificationType="+t.attr("name"),n="notificationFrequency="+i,s="_csrf="+jPar.wdk.security.getCsrfToken();s+="&"+o+"&"+n,this.callAjaxForm(a,s,r)},callAjaxForm:function(e,t,r){$j.ajax({type:e.attr("method"),url:e.attr("action"),data:t,success:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)&&jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){jPar.app.dataAndSettings.utils.handleNetworkError(e,t,a,r)}}),this.syncGlobalToggleState()}}}),jPar.app.dataAndSettings=jPar.app.dataAndSettings||{},$j.extend(!0,jPar.app.dataAndSettings,{passwordForm:{settingsUtil:null,init:function(){var t=this;this.settingsUtil=jPar.app.dataAndSettings.utils,jPar.util.putCursorAtEnd($j("#password")),$j("form.passwordForm").on("submit",function(e){t.validateForm(),t.formHasErrors()&&e.preventDefault()})},validateForm:function(){$j("#backendValidationError").removeClass("is-visible");var e=$j("#passwordError");jPar.util.validate.textfieldIsEmpty($j("#passwordRow input"))?(jPar.wdk.forms.showError(e),jPar.util.putCursorAtEnd($j("#password"))):jPar.wdk.forms.hideError(e)},formHasErrors:function(){return jPar.wdk.forms.hasVisibleErrors($j("form.passwordForm"))}}}),jPar.app.dataAndSettings=jPar.app.dataAndSettings||{},$j.extend(!0,jPar.app.dataAndSettings,{personaldata:{init:function(){this.addressForm.init(),this.income.init()},addressForm:{init:function(){var t=this,e=$j("#editPersonalData");e.on("click keyup",function(e){jPar.util.validate.isMouseclickEnterOrSpaceKey(e.keyCode)&&t.openEditPersonalDataModal()}),(e.data("openEditEmail")||-1<document.location.search.indexOf("openEditEmail"))&&t.openEditPersonalDataModal(!0),$j("#editPersonalDataModal").on("submit",function(e){e.preventDefault(),t.save()}),t.geoDataFields.initGeoDataFields(),t.changeEmail.init()},openEditPersonalDataModal:function(e){var t=this;if(jPar.wdk.modalbox.show({modalboxId:"editPersonalDataModal",onBeforeClose:function(){return t.resetFormOnAbort(),!0}}),!0===e){var a=$j("#editPersonalDataModal #email"),r=$j("#editPersonalDataModal").offset().top;$j("#editPersonalDataModal").find(".js-scrollableContent").animate({scrollTop:a.offset().top-r-70},300),window.setTimeout(function(){a.focus()},500)}},geoDataFields:{initGeoDataFields:function(){var e=this;jPar.util.zipAutofill.init(),e.toggleZipFields(),$j("#country").on("change",function(){e.clearAllZipAndCityFields(),e.toggleZipFields()}),$j("#cityFallback").on("change",function(){e.validateCityFallback()}),$j("#zipForBackend").on("change",function(){jPar.wdk.forms.hideError($j("#zipForBackendError"))})},toggleZipFields:function(){var e=$j("#country option:selected").data("isCountryWithoutZip"),t=$j("#country option:selected").data("isCountryWithIncompleteZip");e||t?($j("#zipAutofill").addClass("noDisplay"),$j("#zipWithoutAutofill").removeClass("noDisplay"),$j("#zipForBackend").prop("disabled",!0),$j("#hiddenCity").prop("disabled",!0),$j("#hiddenStateCode").prop("disabled",!0),$j("#zipFallback").prop("disabled",!1),$j("#cityFallback").prop("disabled",!1),e?($j("#zipFallback").val($j("#country option:selected").val()),$j("#zipFallback").prop("readonly",!0),$j("#zipFallback").addClass("disabled"),$j("#zipRowFallback .infoText").addClass("noDisplay")):t&&($j("#zipFallback").prop("readonly",!1),$j("#zipFallback").removeClass("disabled"),$j("#zipRowFallback .infoText").removeClass("noDisplay"))):($j("#zipAutofill").removeClass("noDisplay"),$j("#zipWithoutAutofill").addClass("noDisplay"),$j("#zipForBackend").prop("disabled",!1),$j("#hiddenCity").prop("disabled",!1),$j("#hiddenStateCode").prop("disabled",!1),$j("#zipFallback").prop("disabled",!0),$j("#cityFallback").prop("disabled",!0),$j("#zipRowFallback .infoText").removeClass("noDisplay"))},validateZipFallback:function(){jPar.util.validate.textfieldIsEmpty($j("#editPersonalDataModal").find("#zipFallback"))?jPar.wdk.forms.showError($j("#zipEmptyError")):jPar.wdk.forms.hideError($j("#zipEmptyError"))},validateCityFallback:function(){jPar.util.validate.textfieldIsEmpty($j("#editPersonalDataModal").find("#cityFallback"))?jPar.wdk.forms.showError($j("#cityEmptyError")):(jPar.wdk.forms.hideError($j("#cityEmptyError")),jPar.wdk.forms.hideError($j("#cityWrongError")))},validateAutofillField:function(){jPar.wdk.forms.hideError($j("#zipWrongError")),jPar.wdk.forms.hideError($j("#cityWrongError"));var e=jPar.util.validate.textfieldIsEmpty($j("#zipAutofill").find("#zip")),t=jPar.util.validate.textfieldIsEmpty($j("#zipAutofill").find("#zipForBackend"));e||t?jPar.wdk.forms.showError($j("#zipForBackendError")):jPar.wdk.forms.hideError($j("#zipForBackendError"))},clearAllZipAndCityFields:function(){jPar.util.zipAutofill.clearDropdown(),$j("#zipAutofill").find(".js-autofillDropdownTextfield").val(""),$j("#zipForBackend").val(""),$j("#hiddenCity").val(""),$j("#hiddenStateCode").val(""),$j("#zipFallback").val(""),$j("#cityFallback").val("")}},formIsValid:function(){return!1===jPar.wdk.forms.hasVisibleErrors($j("#editPersonalDataModal"))},save:function(){var t=this,e=$j("#editPersonalDataModal"),r=e.find("button.saveElement");t.validateForm(),t.formIsValid()&&(jPar.wdk.loadingIndicator.show(r),$j.ajax({type:"POST",url:e.attr("action"),data:e.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(r),!0===jPar.util.network.hasValidSessionAndCsrfToken(e)?(t.handleSuccessResponse(e),localStorage.setItem("personalDataSavedKey",!1),void 0!==e.unconfirmedEmailSent&&!0===e.unconfirmedEmailSent&&localStorage.setItem("personalDataSavedKey",!0)):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){jPar.wdk.loadingIndicator.hide(r),"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),0!==e.status&&403!==e.status&&jPar.util.log.error(e.status+" - "+a,"dataAndSettings savePersonalData failed"))}}))},validateForm:function(){this.validateName(),this.validateStreetAndHousenumber(),this.validateEmail(),this.validateZip(),this.validateCompany(),this.validatePhone(),this.scrollToFirstError()},validateName:function(){var e=$j("#firstnameRow"),t=$j("#firstnameEmpty"),a=$j("#firstnameError");jPar.util.validate.textfieldIsEmpty(e.find("input"))?jPar.wdk.forms.showError(t):jPar.wdk.forms.hideError(t),jPar.wdk.forms.hideError(a);var r=$j("#lastnameRow"),i=$j("#lastnameEmpty"),o=$j("#lastnameError");jPar.util.validate.textfieldIsEmpty(r.find("input"))?jPar.wdk.forms.showError(i):jPar.wdk.forms.hideError(i),jPar.wdk.forms.hideError(o)},validateStreetAndHousenumber:function(){var e=Boolean($j("#editPersonalDataModal").data("isPremium")),t=$j("#streetRow"),a=$j("#streetEmpty"),r=$j("#streetError"),i=$j("#housenumberRow"),o=$j("#housenumberEmpty"),n=$j("#housenumberError");e&&jPar.util.validate.textfieldIsEmpty(t.find("input"))?jPar.wdk.forms.showError(a):jPar.wdk.forms.hideError(a),jPar.wdk.forms.hideError(r),e&&jPar.util.validate.textfieldIsEmpty(i.find("input"))?jPar.wdk.forms.showError(o):jPar.wdk.forms.hideError(o),jPar.wdk.forms.hideError(n)},validateEmail:function(){var e=$j("#email"),t=$j("#unconfirmedEmailRow");if(0<t.length&&t.is(":visible")){var a=$j("#unconfirmedEmailInvalid");""===t.val()||!0===jPar.util.validate.isEmailAddress(t)?jPar.wdk.forms.hideError(a):jPar.wdk.forms.showError(a)}else{var r=$j("#emailInvalid");!0===jPar.util.validate.isEmailAddress(e)?jPar.wdk.forms.hideError(r):jPar.wdk.forms.showError(r)}},validateZip:function(){0<$j("#zipAutofill").length?0<$j("#zipAutofill.noDisplay").length?(this.geoDataFields.validateZipFallback(),this.geoDataFields.validateCityFallback()):this.geoDataFields.validateAutofillField():this.geoDataFields.validateZipForToggleOff()},validateCompany:function(){var e=$j("#companyError");jPar.wdk.forms.hideError(e)},validatePhone:function(){var e=$j("#phoneError");jPar.wdk.forms.hideError(e)},scrollToFirstError:function(){var e=$j("form#editPersonalDataModal article").find(".has-error").first();if(0<e.length){var t=$j("#editPersonalDataModal").offset().top;$j("#editPersonalDataModal .js-scrollableContent").animate({scrollTop:e.offset().top-t-70},300)}},handleSuccessResponse:function(e){var t=e.$errors.personalDataForm;if(void 0!==t){if(void 0!==t.zip&&jPar.wdk.forms.showError($j("#zipForBackendError")),void 0!==t.city&&jPar.wdk.forms.showError($j("#cityWrongError")),void 0!==t.street&&jPar.wdk.forms.showError($j("#streetError")),void 0!==t.housenumber&&jPar.wdk.forms.showError($j("#housenumberError")),void 0!==t.company&&jPar.wdk.forms.showError($j("#companyError")),void 0!==t.phone&&jPar.wdk.forms.showError($j("#phoneError")),void 0!==t.email&&jPar.wdk.forms.showError($j("#emailInvalid")),void 0!==t.unconfirmedEmail)$j("#unconfirmedEmail").is(":visible")?jPar.wdk.forms.showError($j("#unconfirmedEmailInvalid")):jPar.wdk.forms.showError($j("#emailInvalid"));void 0!==t.firstname&&jPar.wdk.forms.showError($j("#firstnameError")),void 0!==t.lastname&&jPar.wdk.forms.showError($j("#lastnameError"))}else{var a=location.href.split("?")[0];location.replace(a)}},resetFormOnAbort:function(){$j('#editPersonalDataModal .wdk-styledHintBox[class*=" t-error"]').removeClass("is-visible"),$j("#editPersonalDataModal .wdk-form-text").removeClass("has-error"),$j("#editPersonalDataModal input[data-saved-value]").each(function(){var e=$j(this),t=e.data("savedValue");e.val(t),jPar.wdk.forms.textElement.updateCounter(e)});var e=$j("#countryRow select"),t=e.data("savedValue");e.val(t),jPar.wdk.forms.autofillDropdown.close($j("#geoDataList")),this.geoDataFields.toggleZipFields()},changeEmail:{init:function(){var t=this;t.accordion.init(),t.copyEmailToHiddenUnconfirmedEmail(),$j("#resendEmailButton").on("click",function(e){jPar.wdk.loadingIndicator.show($j(this)),e.preventDefault(),t.resendDOIMail()}),t.showEMailChangedModal()},accordion:{init:function(){if(0<$j(".accordionContainer").length){var e=this;$j(".accordionContainer h5").on("click",function(){e.openAccordionPanel($j(this).parent())})}},openAccordionPanel:function(e){e.hasClass("active")?(e.removeClass("active"),e.find(".accordionPanel").slideUp(400)):($j(".accordionContainer li").removeClass("active"),$j(".accordionContainer li").find(".accordionPanel").slideUp(400),e.addClass("active"),e.find(".accordionPanel").slideDown(400))}},copyEmailToHiddenUnconfirmedEmail:function(){0===$j("#unconfirmedEmailRow").length&&$j("#editPersonalDataModal #email").on("keyup",function(){var e=$j(this).val().trim();0<e.length&&$j("#unconfirmedEmail").val(e)})},resendDOIMail:function(){$j.ajax({type:"POST",url:"/settings/resendDoubleOptInForUpdatedEmail",data:{_csrf:jPar.wdk.security.getCsrfToken()},success:function(e){jPar.wdk.loadingIndicator.hide($j("#resendEmailButton")),!0===jPar.util.network.hasValidSessionAndCsrfToken(e)?"true"===e.success?$j("#resendEmailSuccess").addClass("is-visible"):($j("#resendEmailError").addClass("is-visible"),jPar.util.log.error("Registration: doubleOptIn",'Could not resend email - Backend returned status "success: false"')):jPar.util.network.reloadIfResponseInvalid(e)},timeout:5e3,error:function(e,t,a){$j("#resendEmailError").addClass("is-visible"),jPar.wdk.loadingIndicator.hide($j("#resendEmailButton")),"timeout"!==t&&0!==e.status&&jPar.util.log.error(t+" - "+a,"doubleOptIn: Change User E-Mail - Could not resend email")}})},showEMailChangedModal:function(){var e=0<$j("#emailDOIConfirmationModal").length,t=localStorage.getItem("personalDataSavedKey");e&&"true"===t&&(jPar.wdk.modalbox.show({modalboxId:"emailDOIConfirmationModal"}),$j("#emailDOIConfirmationModal .js-closeModalbox").on("click",function(){localStorage.removeItem("personalDataSavedKey")}))}}},income:{init:function(){var t=this;$j("#editIncome").on("click keyup",function(e){jPar.util.validate.isMouseclickEnterOrSpaceKey(e.keyCode)&&jPar.wdk.modalbox.show({modalboxId:"editIncomeModal",onBeforeClose:function(){return t.resetFormOnAbort(),!0}})}),$j("#editIncomeModal").on("submit",function(e){e.preventDefault(),t.save($j(this))})},save:function(t){var a=this,r=t.find("button.saveElement");jPar.wdk.loadingIndicator.show(r),$j.ajax({type:"POST",url:t.attr("action"),data:t.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(r),!0===jPar.util.network.hasValidSessionAndCsrfToken(e)?a.handleSuccessResponse(t):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),0!==e.status&&403!==e.status&&jPar.util.log.error(e.status+" - "+a,"dataAndSettings saveIncome failed")),jPar.wdk.loadingIndicator.hide(r)}})},handleSuccessResponse:function(e){var t=e.find('input[type="radio"]:checked');e.find("#currentSavedIncome").val(t.val());var a=t.find("~ label").text();$j("#editIncome p").text(a),jPar.wdk.modalbox.hide()},resetFormOnAbort:function(){var e=$j("#currentSavedIncome").val();$j("#editIncomeModal").find('input[type="radio"]').prop("checked",!1),$j("#editIncomeModal").find('input[value="'+e+'"]').prop("checked",!0)}}}}),jPar.app.dataAndSettings=jPar.app.dataAndSettings||{},$j.extend(!0,jPar.app.dataAndSettings,{personalDataInquiry:{init:function(){0<$j("#dataInquiryForm").length&&this.password.init(),0<$j("#facebookLoginContainer").length&&this.facebook.init(),0<$j("#appleLoginContainer").length&&this.apple.init(),"undefined"!=typeof socialSignOnLib&&socialSignOnLib.init()},password:{init:function(){var t=this;$j("#dataInquiryForm").on("submit",function(e){t.validateAndSubmit(e)})},validateAndSubmit:function(e){e.preventDefault(),jPar.app.dataAndSettings.passwordForm.validateForm(),jPar.app.dataAndSettings.passwordForm.formHasErrors()?this.logPasswordError():this.submitForm()},submitForm:function(){var t=this,e=$j("#dataInquiryForm"),a=e.attr("action");jPar.wdk.loadingIndicator.show($j("#dataInquiryFormSubmit")),$j.post(a,e.serialize()).done(function(e){!0===e.mailingSuccess?t.showSuccessBox(e.inquiryDateTime):e.hasOwnProperty("validationErrors")&&e.validationErrors.includes("password")?t.showPasswordError():t.showErrorBox(e.inquiryDateTime)}).always(function(){jPar.wdk.loadingIndicator.hide($j("#dataInquiryFormSubmit"))}).fail(function(e){jPar.util.network.reloadIfResponseInvalid(e),t.showErrorBox()})},showSuccessBox:function(e){this.hideAll(),$j("#personalDataInquiryPage .inquiryDateTime").text(e),jPar.wdk.hintbox.removeClassNoDisplay($j("#personalDataInquiryResultSuccessHintBox"))},showErrorBox:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.hideAll(),null!==e?($j("#errorBoxNewLine").removeClass("noDisplay"),$j("#personalDataInquiryPage .inquiryDateTime").text(e)):$j("#errorBoxNewLine").addClass("noDisplay"),jPar.wdk.hintbox.addClassIsVisible($j("#personalDataInquiryResultErrorHintBox"))},showPasswordError:function(){this.hideAll(),jPar.wdk.hintbox.addClassIsVisible($j("#backendValidationError")),$j("#dataInquiryForm").removeClass("noDisplay")},hideAll:function(){jPar.wdk.hintbox.removeClassIsVisible($j("#backendValidationError")),$j("#dataInquiryForm").addClass("noDisplay"),jPar.wdk.hintbox.removeClassIsVisible($j("#personalDataInquiryResultErrorHintBox")),jPar.wdk.hintbox.addClassNoDisplay($j("#personalDataInquiryResultSuccessHintBox"))},logResult:function(e){0<e.find("#personalDataInquiryResultSuccessHintBox").length?jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"data_inquiry",targetId:"request_form",action:"success"}):0<e.find("#personalDataInquiryResultErrorHintBox").length&&jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"data_inquiry",targetId:"request_form",action:"failure_send_email"})},logPasswordError:function(){jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"data_inquiry",targetId:"request_form",action:"empty_or_wrong_password"})}},facebook:{init:function(){var e=this;document.addEventListener("facebook-domPrepareDone",function(){e.setEventlistener(),e.initAfterFacebookPopupIfNeeded()})},setEventlistener:function(){var a=this;$j("#facebookDAELoginButton").on("click",function(e){$j("#facebookLoginContainer button#facebookDAELoginButton").hasClass("disabled")||a.loginButtonClicked(e)}),document.addEventListener("facebook-statusConnected",function(t){socialSignOnLib.facebook.withUrlParams.getDeclinedPermissions(function(e){a.statusConnected(t,e)})}),document.addEventListener("facebook-statusTimeout",function(){a.showNotAuthorizedError(),jPar.util.log.ui("FacebookDAELogin","Error","Timeout")}),document.addEventListener("facebook-statusNotAuthorized",function(){a.showTimeoutError(),jPar.util.log.ui("FacebookDAELogin","Error","NotAuthorized")})},showNotAuthorizedError:function(){jPar.wdk.hintbox.addClassIsVisible($j("#personalDataInquiryFacebookNotAuthorizedErrorHintBox"))},showTimeoutError:function(){jPar.wdk.hintbox.addClassIsVisible($j("#personalDataInquiryFacebookTimeoutErrorHintBox"))},hideAllErrors:function(){jPar.wdk.hintbox.removeClassIsVisible($j("#personalDataInquiryFacebookNotAuthorizedErrorHintBox")),jPar.wdk.hintbox.removeClassIsVisible($j("#personalDataInquiryFacebookTimeoutErrorHintBox"))},initAfterFacebookPopupIfNeeded:function(){var e=window.location.href,t="facebook"===socialSignOnLib.util.getGetParamFromUrl(e,"ssoProvider"),a="true"===socialSignOnLib.util.getGetParamFromUrl(e,"qaPreventSdkLoadingForTest");if(t){var r=socialSignOnLib.util.getGetParamFromUrl(e,"currentClickedId");a?socialSignOnLib.facebook.config.currentClickButton=r:socialSignOnLib.facebook.withUrlParams.init(r),$j("#facebookLoginContainer .wdk-icon").addClass("is-visible"),$j("#dataInquiryFacebookForm .buttonRow button#dataInquiryFormSubmit").prop("disabled",!1),$j("#facebookLoginContainer button#facebookDAELoginButton").addClass("disabled")}},loginButtonClicked:function(e){e.preventDefault(),this.hideAllErrors();var t=$j(e.currentTarget).attr("id");socialSignOnLib.facebook.withoutUrlParams.openPopup({clickedId:t})},statusConnected:function(e,t){this.uxTracking(e,t),$j("#facebookLoginContainer button#facebookDAELoginButton").addClass("disabled")},uxTracking:function(e,t){""===e.detail.email&&(!0===-1<$j.inArray("email",t)?jPar.util.log.ui("FacebookDAELogin","Error","noFBMailAuthorization"):jPar.util.log.ui("FacebookDAELogin","Error","noFBMail"));!1===jPar.util.validate.textfieldIsEmpty($j("#loginFormEmail"))&&(jPar.util.log.ui("FacebookDAELogin","Error","withMail"),$j("#loginFormEmail").val(""))}},apple:{init:function(){var e=this;document.addEventListener("apple-domPrepareDone",function(){e.initDom()})},initDom:function(){""!==$j("#dataInquiryAppleForm input[name=id_token]").val()&&($j("#dataInquiryAppleForm #appleLoginContainer .wdk-icon").addClass("is-visible"),$j("#dataInquiryAppleForm #appleLoginContainer .signInWithApple").addClass("disabled"),$j("#dataInquiryAppleForm #appleLoginContainer .signInWithApple").attr("href","#"))}}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{exoticLinks:{init:function(){$j(".exoticLinkForm")&&jPar.wdk.forms.init();try{$j("#forgotPasswordPage").length&&this.forgotPassword.init(),$j("#errorInEmailForm").length&&this.emailCorrection.init(),$j("#renewPasswordForm").length&&this.reNewPassword.init(),$j("#setNewPasswordForm").length&&this.setNewPassword.init()}catch(e){jPar.util.log.error(e,"jPar.app.exoticLinks: Init failed")}},formValidation:{formFieldEmpty:function(e,a){$j.isArray(e)||(e=[e]),$j.isArray(a)||(a=[a]),e.length===a.length?$j.each(e,function(e){var t=$j(this);jPar.util.validate.textfieldIsEmpty(t)?(jPar.wdk.forms.showError(a[e]),jPar.util.putCursorAtEnd(t)):jPar.wdk.forms.hideError(a[e])}):jPar.util.log.error("","jPar.app.exoticLinks.formValidation.formFieldEmpty: Unexpected length of arguments")},invalidEmail:function(e,t){!1===jPar.util.validate.isEmailAddress(e)?(jPar.wdk.forms.showError(t),jPar.util.putCursorAtEnd(e)):jPar.wdk.forms.hideError(t)},hasErrors:function(e){return jPar.wdk.forms.hasVisibleErrors(e)},handleErrorHintBox:function(e){$j.isArray(e)||(e=[e]),$j.each(e,function(){var e=$j(this);if(e.hasClass("is-visible")){var t=e.parents(".wdk-form-text").find("input");jPar.app.exoticLinks.formValidation.toggleErrorHintBox(t,e)}})},toggleErrorHintBox:function(e,t){e.on("keyup",function(){0<e.val().length?jPar.wdk.forms.hideError(t):jPar.wdk.forms.showError(t)})}},forgotPassword:{form:"",init:function(){var t=this;t.form=$j("#formRequestPassword"),t.form.on("submit",function(e){jPar.app.exoticLinks.formValidation.formFieldEmpty($j("#fieldEmailAddress"),$j("#errorInputFieldEmpty")),jPar.wdk.forms.hideError($j("#error_box_SendPasswordRequestEmail")),jPar.app.exoticLinks.formValidation.hasErrors(t.form)&&(e.preventDefault(),jPar.app.exoticLinks.formValidation.handleErrorHintBox($j("#errorInputFieldEmpty")))})}},emailCorrection:{init:function(){var t=this,a=$j("#errorInEmailForm");a.on("submit",function(e){t.save(e,a)})},save:function(e,t){var r=this;jPar.app.exoticLinks.formValidation.formFieldEmpty($j("#fieldEmailAddress"),$j("#emailInvalidError")),jPar.app.exoticLinks.formValidation.invalidEmail($j("#fieldEmailAddress"),$j("#emailInvalidError")),jPar.app.exoticLinks.formValidation.hasErrors(t)?(e.preventDefault(),jPar.app.exoticLinks.formValidation.handleErrorHintBox($j("#errorInputFieldEmpty"))):0<$j("#emailDOIConfirmationModal").length&&(e.preventDefault(),jPar.wdk.loadingIndicator.show($j("button[type=submit]")),$j.ajax({type:"POST",url:t.attr("action"),data:t.serialize(),success:function(e){r.handleSuccess(e)},error:function(e,t,a){r.handleError(e,t,a)}}))},handleSuccess:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):(jPar.wdk.loadingIndicator.hide($j("button[type=submit]")),"true"===e.success?($j("#emailInvalidError").removeClass("is-visible"),this.openEmailSendModalbox()):($j("#emailInvalidError").addClass("is-visible"),jPar.util.log.error("Email Correction: New Email",'Could not send email - Backend returned status "success: false"')))},handleError:function(e,t,a){jPar.wdk.loadingIndicator.hide($j("button[type=submit]")),jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),"timeout"!==t&&0!==e.status&&jPar.util.log.error(e+" - "+t+" - "+a,"Email CorrectionPage: Could not save new Email")},openEmailSendModalbox:function(){var e=this,t=$j("#errorInEmailForm").attr("data-nextPage");jPar.wdk.modalbox.show({modalboxId:"emailDOIConfirmationModal",onSuccess:function(){e.replaceTextWithNewEmail(),$j("#emailDOIConfirmationModal .js-closeModalbox").on("click",function(e){e.preventDefault(),window.location.href="//"+window.location.host+t})}})},replaceTextWithNewEmail:function(){if(0<$j("#emailDOIConfirmationModal .emailSend").length){var e=$j("#emailDOIConfirmationModal .emailSend").text().replace("{0}",$j("#fieldEmailAddress").val());$j("#emailDOIConfirmationModal .emailSend").text(e)}else if(0<$j("#emailDOIConfirmationModal .emailSaved").length){var t=$j("#emailDOIConfirmationModal .emailSaved").text().replace("{0}",$j("#fieldEmailAddress").val());$j("#emailDOIConfirmationModal .emailSaved").text(t)}}},reNewPassword:{form:"",emptyErrorBoxes:[],init:function(){var t=this;t.emptyErrorBoxes.push($j("#errorBoxPasswordEmpty1"),$j("#errorBoxPasswordEmpty2")),t.form=$j("#renewPasswordForm"),jPar.wdk.passwordRestrictionBox.init(),t.form.on("submit",function(e){jPar.app.exoticLinks.formValidation.formFieldEmpty([$j("#newPassword"),$j("#newPasswordRepitition")],t.emptyErrorBoxes),jPar.wdk.forms.hideError($j("#error_box_SendPasswordRequestEmail")),jPar.app.exoticLinks.formValidation.hasErrors(t.form)&&(e.preventDefault(),jPar.app.exoticLinks.formValidation.handleErrorHintBox(t.emptyErrorBoxes))})}},setNewPassword:{form:"",emptyErrorBoxes:[],init:function(){var t=this;t.emptyErrorBoxes.push($j("#errorBoxPasswordEmpty1"),$j("#errorBoxPasswordEmpty2")),t.form=$j("#setNewPasswordForm"),jPar.wdk.passwordRestrictionBox.init(),t.form.on("submit",function(e){jPar.app.exoticLinks.formValidation.formFieldEmpty([$j("#newPassword"),$j("#newPasswordRepitition")],t.emptyErrorBoxes),jPar.wdk.forms.hideError($j("#error_box_SendPasswordRequestEmail")),jPar.app.exoticLinks.formValidation.hasErrors(t.form)&&(e.preventDefault(),jPar.app.exoticLinks.formValidation.handleErrorHintBox(t.emptyErrorBoxes))})}}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{logoutPage:{init:function(){0<$j("#sovendusIntegration").length&&this.writeSovendus()},writeSovendus:function(){var e=$j("#sovendusIntegration"),t=e.data("sessionId"),a=e.data("timestamp"),r=e.data("shopid"),i="";if(jPar.wdk.brands.forBrands(["ps"])){var o=e.data("checksum");i="//api.gutscheinconnection.de/js/client.js",window._gconData=window._gconData||[],window._gconData.push(["_shopId",r],["_bannerId","1"],["_sessionId",t],["_timestamp",a],["_customerSalutation",""],["_customerFirstName",""],["_customerLastName",""],["_customerEmail",""],["_orderId",""],["_orderValue",""],["_orderCurrency",""],["_usedCouponCode",""],["_checksum",o],["_htmlElementId","sovendusIntegration"]),this.loadSovendusAPi(i)}else if(jPar.wdk.brands.forBrands(["ep"])){i="//api.sovendus.com/sovabo/common/js/flexibleIframe.js";var n=e.data("trafficMediumNumber");window.sovIframes=window.sovIframes||[],window.sovIframes.push({trafficSourceNumber:r,trafficMediumNumber:n,sessionId:t,timestamp:a,orderId:"",orderValue:"",orderCurrency:"",usedCouponCode:"",iframeContainerId:"sovendusIntegration"}),this.loadSovendusAPi(i)}},loadSovendusAPi:function(e){var t=document.createElement("script");t.setAttribute("src",e),$j("#sovendusIntegration")[0].appendChild(t),t.onload=function(){window.setTimeout(function(){$j("#sovendusIntegration").addClass("is-visible")},500)}}}}),jPar.app.profilePages=jPar.app.profilePages||{},$j.extend(!0,jPar.app.profilePages,{miniGallery:{conf:{swiperObj:null},init:function(){this.markLastVisible(),$j(window).on("resize",this.markLastVisible);var e=jPar.app.util.getGetParamFromUrl("showGallery"),t=0<$j(".js-openSlideshow").length;e&&t&&jPar.app.profilePages.bigGallery.openSlideshow()},markLastVisible:function(){var e=$j("#miniGallery li"),t=e.filter(":visible:last");e.removeClass("has-more"),"previewPic_1"!==t.attr("id")&&1<parseInt(t.data("remaining"),10)&&t.addClass("has-more")},initSwiper:function(){if(0<$j("#miniGallery .swiperButtonPrev").length){if("undefined"==typeof Swiper)return;this.conf.swiperObj=new Swiper("#miniGallery",{keyboardControl:!0,nextButton:".swiperButtonNext",prevButton:".swiperButtonPrev",spaceBetween:8,slidesPerView:3,slidesPerGroup:3,speed:300})}}},bigGallery:{conf:{swiperObj:null},init:function(){if("undefined"!=typeof Swiper){var t=this;$j("#profileHeader").on("click",".js-openSlideshow",function(e){e.preventDefault(),t.openSlideshow(e),0<$j("body#myProfilePage").length&&(jPar.app.profilePages.tabNaviUtil.showTab($j("#photoTab")),jPar.app.myProfile.photoToolRelated.initPhotoTool())})}},openSlideshow:function(e){var t=null;void 0!==e&&(t=e.currentTarget);var a=this;jPar.wdk.modalbox.show({modalboxId:"galleryModalbox",onSuccess:function(){a.initSwiper($j(t).data("imageIndex"))},onBeforeClose:function(){return a.closeSlideshow(),!0}})},closeSlideshow:function(){this.conf.swiperObj&&(this.conf.swiperObj.destroy(!0,!0),this.conf.swiperObj=null)},initSwiper:function(e){if(0<$j(".ie9").length){var t=$j("#gallerySwiper").width(),a=$j("#gallerySwiper .swiper-slide").length;$j("#gallerySwiper .swiper-slide").css({width:t}),$j("#gallerySwiper .swiper-wrapper").css({width:t*a})}else{if(this.conf.swiperObj=new Swiper("#gallerySwiper",{pagination:".swiper-pagination",paginationClickable:!0,keyboardControl:!0,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",speed:0,a11y:!0}),!this.conf.swiperObj)return;this.conf.swiperObj.slideTo(e),this.conf.swiperObj.params.speed=300}}}}),jPar.app.profilePages=jPar.app.profilePages||{},$j.extend(!0,jPar.app.profilePages,{matchingWheel:{conf:{matchingWheel:{},lastScreenSize:null,extraOffset:0,options:{scaleOverride:!0,scaleSteps:1,scaleStepWidth:140,scaleStartValue:0,scaleShowLine:!1,scaleFontSize:0,scaleShowLabels:!1,segmentStrokeColor:"#fff",segmentStrokeWidth:1,animationEasing:"easeOutQuart",animateRotate:!0,animateScale:!1,responsive:!1,showTooltips:!0,tooltipEvents:["mousemove","mouseout"],tooltipTemplate:function(e){return e.label?e.label:""},customTooltips:function(e){jPar.wdk.screensize.isBreakpoint(["L","XL"])&&jPar.app.profilePages.matchingWheel.createCustomTooltip(e)}}},init:function(){var a=this;this.conf.lastScreenSize=jPar.wdk.screensize.getCurrentScreenSize(),this.conf.extraOffset=jPar.wdk.screensize.isBreakpoint(["L","XL"])?100:50,$j("#matchingWheel a").on("click",function(e){e.preventDefault();var t=$j(this).data("linktarget");jPar.app.partnerProfile.matchingTabPsEh.showTab($j("#"+t)),jPar.util.scrollToElement($j("#detailCard"),-a.conf.extraOffset)}),$j(window).on("resize",function(){a.handleResize()}),$j(window).add("#pageWrapper").on("scroll.matchingWheel",function(){$j("#matchingWheel").hasClass("has-rendered")?$j(window).off("scroll.matchingWheel"):a.render()}),a.render()},handleResize:function(){var e=jPar.wdk.screensize.getCurrentScreenSize(),t=-1<["S","M"].indexOf(e),a=-1<["L","XL"].indexOf(e),r=-1<["S","M"].indexOf(this.conf.lastScreenSize),i=-1<["L","XL"].indexOf(this.conf.lastScreenSize);(t&&i||a&&r)&&(this.conf.lastScreenSize=e,$j("#matchingWheel").removeClass("has-rendered"),this.render())},render:function(){var e=0<$j("#matchingTab.active").length,t=0<$j("#testresultTab.active").length,a=$j("#matchingWheel #innerCircle").isOnScreen();if((e||t)&&a){var r,i=this,o=generatedMatchingWheelData||{};this.setColorsForChart(o),jPar.wdk.screensize.isBreakpoint(["S","M"])?(r=$j("#matchingWheelChartSM")[0],this.conf.options.segmentStrokeColor="rgba(255,255,255,0.5)",this.conf.options.animationSteps=10):(r=$j("#matchingWheelChartLXL")[0],this.conf.options.animationSteps=30);var n=r.getContext("2d");this.conf.matchingWheel=new Chart(n).PolarArea(o,this.conf.options),$j("#matchingWheel").addClass("has-rendered"),$j(r).on("mousemove",function(e){i.setColorForTooltip(e)}),$j(r).on("click",function(e){i.handleClickOnWheel(e)})}},setColorsForChart:function(e){var t=$j("#myProfilePage").length,a=$j("#partnerProfilePage").length,r=1,i=1,o=1;for(var n in e)if(e.hasOwnProperty(n)){var s=0,l=n%2;s=1===l?n-1:n,a?51<n?jPar.wdk.brands.forBrands(["ps"])?(e[n].color="hsl(30, 100%,"+(2*(s-o-40)+41)+"%)",e[n].highlight="hsl(30, 100%,"+(2*(s-o-40)+46)+"%)"):(e[n].color="hsl(223, 47%,"+(2*(s-o-46)+50)+"%)",e[n].highlight="hsl(223, 47%,"+(2*(s-o-46)+45)+"%)"):39<n?(0===l&&r++,jPar.wdk.brands.forBrands(["ps"])?(e[n].color="hsl(44, 100%,"+(3*(s-r-40)+50)+"%)",e[n].highlight="hsl(44, 100%,"+(3*(s-r-40)+45)+"%)"):(e[n].color="hsl(4, 83%,"+(4*(s-r-40)+56)+"%)",e[n].highlight="hsl(4, 83%,"+(4*(s-r-40)+49)+"%)")):17<n?(0===l&&i++,jPar.wdk.brands.forBrands(["ps"])?(e[n].color="hsl(330, 100%,"+(3*(s-i-9)+8)+"%)",e[n].highlight="hsl(330, 100%,"+(3*(s-i-9)+3)+"%)"):(e[n].color="hsl(342, 52%,"+(4*(s-i-18)+29)+"%)",e[n].highlight="hsl(342, 52%,"+(4*(s-i-18)+24)+"%)")):(0===l&&o++,jPar.wdk.brands.forBrands(["ps"])?(e[n].color="hsl(351, 100%,"+(3*(s-o+2)+32)+"%)",e[n].highlight="hsl(351, 100%,"+(3*(s-o+2)+27)+"%)"):(e[n].color="hsl(185, 90%,"+(2*(s-o+2)+23)+"%)",e[n].highlight="hsl(185, 90%,"+(2*(s-o+2)+18)+"%)")):t&&(25<n?jPar.wdk.brands.forBrands(["ps"])?(e[n].color="hsl(30, 100%,"+(3*(n-26)+47)+"%)",e[n].highlight="hsl(30, 100%,"+(3*(n-26)+42)+"%)"):(e[n].color="hsl(223, 47%,"+(4*(n-26)+50)+"%)",e[n].highlight="hsl(223, 47%,"+(4*(n-26)+45)+"%)"):19<n?jPar.wdk.brands.forBrands(["ps"])?(e[n].color="hsl(44, 100%,"+(3*(n-20)+44)+"%)",e[n].highlight="hsl(44, 100%,"+(3*(n-20)+39)+"%)"):(e[n].color="hsl(4, 83%,"+(4*(n-20)+56)+"%)",e[n].highlight="hsl(4, 83%,"+(4*(n-20)+49)+"%)"):8<n?jPar.wdk.brands.forBrands(["ps"])?(e[n].color="hsl(330, 100%,"+(3*(n-9)+28)+"%)",e[n].highlight="hsl(330, 100%,"+(3*(n-9)+23)+"%)"):(e[n].color="hsl(342, 52%,"+(4*(n-9)+29)+"%)",e[n].highlight="hsl(342, 52%,"+(4*(n-9)+24)+"%)"):jPar.wdk.brands.forBrands(["ps"])?(e[n].color="hsl(351, 100%,"+(3*n+32)+"%)",e[n].highlight="hsl(351, 100%,"+(3*n+27)+"%)"):(e[n].color="hsl(185, 90%,"+(2*n+23)+"%)",e[n].highlight="hsl(185, 90%,"+(2*n+18)+"%)"))}},createCustomTooltip:function(e){var t=$j("#chartjsTooltip");if(e){t.addClass("is-visible");var a=e.text.replace(/^[^\)]+\)/,"");t.html(a)}else t.removeClass("is-visible")},setColorForTooltip:function(e){var t=this.conf.matchingWheel.getSegmentsAtEvent(e);if(0<t.length){var a=t[0].highlightColor;$j("#chartjsTooltip").css({backgroundColor:a})}},handleClickOnWheel:function(e){e.preventDefault();var t=this.conf.matchingWheel.getSegmentsAtEvent(e);if(0<t.length){var a=t[0].label;a.match(/^\((\d+)\)/),""!==(a=RegExp.$1)&&("1"===a?jPar.app.partnerProfile.matchingTabPsEh.showTab($j("#personalityStructure")):"2"===a?jPar.app.partnerProfile.matchingTabPsEh.showTab($j("#ambitionsAndTendancies")):"3"===a?jPar.app.partnerProfile.matchingTabPsEh.showTab($j("#everydayBehaviour")):"4"===a&&jPar.app.partnerProfile.matchingTabPsEh.showTab($j("#communicationStyle")),$j("body").hasClass("openedInMessenger")?$j("#detailCard")[0].scrollIntoView():jPar.util.scrollToElement($j("#detailCard"),-this.conf.extraOffset))}}}}),jPar.app.profilePages=jPar.app.profilePages||{},$j.extend(!0,jPar.app.profilePages,{matchingDiagram:{init:function(){if(0<$j(".matchingResultsGraph").length){var e=this;$j(window).add("#pageWrapper").on("scroll.matchingDiagramAnimation touchmove.matchingDiagramAnimation",function(){e.animateMatchingDiagram()}),e.animateMatchingDiagram()}$j(".js-openScaleModal").on("click",function(e){e.preventDefault();var t=$j(this).data("modalbox");jPar.wdk.modalbox.show({modalboxId:"#"+t})})},animateMatchingDiagram:function(){$j(".matchingResultsGraph").each(function(){var e=$j(this);e.isOnScreen()&&!e.hasClass("animate")&&e.addClass("animate")})}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{consentPage:{init:function(){0<$j(".isConsentGiven").length?this.showOptinGivenLayer():this.showOptinLayer()},showOptinLayer:function(){var e=this;jPar.wdk.modalbox.show({modalboxId:"nameAndPhotoOptinModal",onSuccess:function(){$j("#nameAndPhotoOptinModal button[type=submit]").on("click",function(){e.sendOptin()})}})},showOptinGivenLayer:function(){jPar.wdk.modalbox.show({modalboxId:"nameAndPhotoOptinAccepted"})},sendOptin:function(){var t=this,a=$j("#nameAndPhotoOptinModal button[type=submit]");jPar.wdk.loadingIndicator.show(a),$j("#serverErrorMessage").removeClass("is-visible"),$j.ajax({type:"POST",url:"/profile/saveFirstNameAndUnblurredPhotoConsent",cache:!1,data:{_csrf:jPar.wdk.security.getCsrfToken()},success:function(e){jPar.wdk.loadingIndicator.hide(a),!0===t.isValidSuccessJson(e)?t.showOptinGivenLayer():t.handleInvalidResponse(e)},error:function(e,t){jPar.wdk.loadingIndicator.hide(a),"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):$j("#serverErrorMessage").addClass("is-visible")}})},isValidSuccessJson:function(e){try{return"object"===_typeof(e)&&void 0!==e.success&&!0===e.success}catch(e){return!1}},handleInvalidResponse:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):$j("#serverErrorMessage").addClass("is-visible")}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{myProfile:{init:function(){try{var t=this;this.profileMenue.init(),this.editLayer.init(),jPar.wdk.forms.init(),jPar.app.profilePages.bigGallery.init(),jPar.app.profilePages.miniGallery.init(),jPar.app.myProfile.aboutMe.init(),jPar.wdk.cardDeck.init(),this.tabNavigation.init(),$j("#photoTab").hasClass("active")&&this.photoToolRelated.initPhotoTool(),$j("#myProfilePage").on("click",".js-showPhototab",function(e){e.preventDefault(),t.photoToolRelated.showPhototab()}),$j("#approvalInHeader").on("click",function(e){e.preventDefault(),t.photoToolRelated.showPhototab()}),$j("#rejectionInHeader").on("click",function(e){e.preventDefault(),t.photoToolRelated.showPhototab()}),0<$j("#profileCompletionFigure").length&&t.initProfileCompletionAnimation(),$j(".js-showMyNameInfoModal").on("click",function(e){e.preventDefault(),t.openMyNameInfoModalbox()})}catch(e){jPar.util.log.error(e,"jPar.app.myProfile.init: Init failed")}},initProfileCompletionAnimation:function(){var e=$j("#profileCompletionFigure");e.isOnScreen()?e.addClass("is-animated"):$j(window).on("scroll.profileCompletionAnimation touchmove.profileCompletionAnimation",function(){e.isOnScreen()&&!e.hasClass("is-animated")?(e.addClass("is-animated"),$j(window).off(".profileCompletionAnimation")):e.hasClass("is-animated")&&$j(window).off(".profileCompletionAnimation")})},photoToolRelated:{updatePhotosInHeader:function(e){var t=0<e.length,a=0===$j("#photoBox .is-inProfileApproval").length;t&&a&&(this.setNewProfilePicInNavi(e),$j.ajax({type:"GET",url:$j("#photosInHeader").data("photoupdateUrl"),cache:!1,async:!0,success:function(e){-1<e.indexOf("photosInHeader")&&($j("#photosInHeader").replaceWith(e),jPar.app.profilePages.miniGallery.init())},error:function(){}}),jPar.wdk.brands.forBrands(["ep"])&&$j.ajax({type:"GET",url:$j("#photosInHeader").data("photoupdateUrl"),data:"miniGalleryEp=true",cache:!1,async:!0,success:function(e){-1<e.indexOf("miniGallery")&&($j("#miniGallery").replaceWith(e),jPar.app.profilePages.miniGallery.init())},error:function(){}}))},setNewProfilePicInNavi:function(e){if(0<$j("#topNavi #myProfile .userHead").length&&0<e.length){var t=e[0],a=$j("#listContainer").find("li[data-index="+t+"]"),r=0<e[0].length,i=0===a.find(".js-status-new.show").length&&0===a.find(".js-status-rejected.show").length;if(r&&i){var o=a.find("span.js-fotoClear").css("background-image");$j(".userHead").removeClass("noPic").css("background-image",o)}}},updateApprovalStatusHint:function(){var e=0<$j("#listContainer").find("li").find(".js-status-new.show").length;e?$j("#approvalInHeader").addClass("has-photosInApproval"):$j("#approvalInHeader").removeClass("has-photosInApproval");var t=0<$j("#listContainer").find("li").find(".js-status-rejected.show").length;!1===e&&t?$j("#rejectionInHeader").addClass("has-rejectedPhotos"):$j("#rejectionInHeader").removeClass("has-rejectedPhotos")},showPhototab:function(){jPar.app.myProfile.profileMenue.close(),jPar.app.myProfile.tabNavigation.switchTab($j("#photoTab"))},initPhotoTool:function(){$j("#photoTab").hasClass("active")&&!1===$j("#photoTab").hasClass("js-is-ready")&&(jPar.util.loadScript("phototool_v2_combined",function(){jPar.util.phototoolV2.init(),jPar.app.myProfile.photoOrganizer.init()}),$j("#photoTab").addClass("js-is-ready"),jPar.Tracking.trackVirtualPage("profile/PHOTOTOOL_TAB"))}},updateProfileCompletion:function(){$j.ajax({type:"GET",url:$j("#profilecompletenessCard").data("ajaxUrl"),cache:!1,success:function(e){if(-1<e.indexOf("profilecompletenessCard")){var t=$j("#profilecompletenessCard").find("#percentLabel").text();if($j("#profilecompletenessCard").replaceWith(e),t!==$j("#profilecompletenessCard").find("#percentLabel").text()){var a=$j("#profilecompletenessCard").find("#percentLabel");a.on(jPar.util.prefixedAnimationEndEvent,function(){a.removeClass("is-animated")}),a.addClass("is-animated")}}},error:function(){}})},openMyNameInfoModalbox:function(){jPar.wdk.modalbox.show({modalboxId:"myNameInfoModal"})}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{partnerProfile:{init:function(){var e=this;try{this.messaging.init(),this.initProfileHeader(),this.initActiveTab(!1),this.like.init(),this.trackVisitedProfile(),this.initLoadedFromMessenger(),this.tweakPaywallLinksForIframe(),$j(".js-toggleCollapse").on("click",function(){e.collapseFactfileItems($j(this))}),jPar.app.partnerProfile.tracking.init()}catch(e){jPar.util.log.error(e,"jPar.app.partnerProfile.init: Init failed")}},initProfileHeader:function(){var e=this;try{this.tabNavigation.init(),jPar.app.profilePages.bigGallery.init(),this.profileMenue.init(),this.favorite.init(),this.initPhotoBox(),jPar.app.profilePages.miniGallery.init(),this.initIdSecureModal(),$j(".partnerPager.disabled").on("click",function(e){e.preventDefault()}),$j("#matchingPoints").on("click",function(){e.tabNavigation.switchTab($j("#matchingTab")),jPar.app.profilePages.tabNaviUtil.scrollToTabNavi()})}catch(e){jPar.util.log.error(e,"jPar.app.partnerProfile.initProfileHeader: Init failed")}},favorite:{init:function(){var t=this;document.querySelectorAll("#favoriteProfile").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.onClickFavorite(e)})})},onClickFavorite:function(e){console.log("clicker");var t=this,a=e.currentTarget;jPar.wdk.brands.forBrands(["ep"])&&jPar.util.vibrate(),jPar.wdk.loadingIndicator.show(a),jPar.app.ajaxCommands.favoriteToggle(a).then(function(e){"addFavorite"===e?t.handleAddFavorite(a):"removeFavorite"===e&&t.handleRemoveFavorite(a),jPar.app.partnerProfile.profileMenue.close()},function(e){t.handleReject(a,e.message)})},handleAddFavorite:function(e){jPar.wdk.loadingIndicator.hide(e),e.classList.add("is-animated"),e.classList.add("is-favorite"),e.setAttribute("aria-pressed","true"),e.addEventListener(jPar.util.prefixedAnimationEndEvent,function(){e.classList.remove("is-animated")},{once:!0}),jPar.wdk.toast.show("#favoriteProfileSuccess",2500),jPar.wdk.brands.forBrands(["ps","eh"])&&$j("#mainUserInfo .favoredProfile").addClass("is-favorite")},handleRemoveFavorite:function(e){jPar.wdk.loadingIndicator.hide(e),e.classList.remove("is-favorite"),e.setAttribute("aria-pressed","false"),jPar.wdk.toast.show("#unfavoriteProfileSuccess",2500),jPar.wdk.brands.forBrands(["ps","eh"])&&$j("#mainUserInfo .favoredProfile").removeClass("is-favorite")},handleReject:function(e,t){jPar.wdk.loadingIndicator.hide(e),"successFalse"===t&&jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),"sessionExpired"===t&&jPar.util.network.reloadForSessionExpired(),"browserTimeout"===t&&jPar.wdk.toast.show("#timeoutNotification"),"genericError"===t&&jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"})}},handleFavoriteResolve:function(e,t){var a=$j(e.currentTarget);jPar.wdk.loadingIndicator.hide($j(e.currentTarget)),"addFavorite"===t&&(a.attr("aria-pressed","true"),jPar.wdk.brands.forBrands(["ep"])?(a.addClass("is-animated"),a.one(jPar.util.prefixedAnimationEndEvent,function(){a.removeClass("is-animated"),a.addClass("is-favorite"),jPar.app.util.switchIcon(a.find("svg"),"icon_pin_plus","icon_pin_minus")})):(a.addClass("is-favorite"),0<a.find("img").length&&jPar.app.util.switchIcon(a.find("img"),"icon_favorite_off","icon_favorite_on")),jPar.wdk.toast.show("#favoriteProfileSuccess",2500),jPar.wdk.brands.forBrands(["ps","eh"])&&$j("#mainUserInfo .favoredProfile").addClass("is-favorite")),"removeFavorite"===t&&(a.removeClass("is-favorite"),a.attr("aria-pressed","false"),jPar.wdk.brands.forBrands(["ep"])?jPar.app.util.switchIcon(a.find("svg"),"icon_pin_minus","icon_pin_plus"):0<a.find("img").length&&jPar.app.util.switchIcon(a.find("img"),"icon_favorite_on","icon_favorite_off"),jPar.wdk.toast.show("#unfavoriteProfileSuccess",2500),jPar.wdk.brands.forBrands(["ps","eh"])&&$j("#mainUserInfo .favoredProfile").removeClass("is-favorite"))},handleFavoriteReject:function(e,t){jPar.wdk.loadingIndicator.hide($j(e.currentTarget)),"successFalse"===t&&jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),"sessionExpired"===t&&jPar.util.network.reloadForSessionExpired(),"browserTimeout"===t&&jPar.wdk.toast.show("#timeoutNotification"),"genericError"===t&&jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"})},initPhotoBox:function(){$j("#photoBox .photo").addClass("clearPhoto"),$j(".touchevents").on("click","#profilePicBM",function(){var e=$j(this);return!!e.hasClass("has-hover")||(e.addClass("has-hover"),!1)})},initActiveTab:function(e){$j("#profileTab").hasClass("active")?this.profileTab.init(e):$j("#matchingTab").hasClass("active")&&(jPar.wdk.brands.forBrands(["ps","eh"])?this.matchingTabPsEh.init():this.matchingTabEP.init())},initIdSecureModal:function(){$j(".idSecured").on("click",function(e){e.preventDefault(),jPar.wdk.modalbox.show({modalboxId:"idSecuredModal"})})},initLoadedFromMessenger:function(){var e=void 0!==jPar.app.util.getGetParamFromUrl("openedInMessenger");0<$j("html.no-touchevents").length&&e&&new PerfectScrollbar("#pageWrapper"),e&&parent.postMessage({domLoaded:"partnerProfilePage"},window.location.origin)},tweakPaywallLinksForIframe:function(){var e=window.self!==window.top,t=0===$j("body.premiumUser").length;e&&t&&$j("#photoBox a#profilePicBM, #miniGallery a, a.linkToDistance").on("click",function(e){e.preventDefault(),parent.postMessage({redirect:e.currentTarget.href},window.location.origin)})},tracking:{endOfPageReached:null,previousTab:"",init:function(){this.endOfPageReached=!1,this.trackPartnerProfileVists(),this.trackPartnerProfileEndOfPageReached()},trackPartnerProfileVists:function(){var t=this,a=document.querySelector("#profileHeader").dataset.partnerChiffre;this.isProfileActive()&&(this.previousTab="profile",jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"partner_profile",subcategory:"profile",targetId:a,action:"view_start"})),this.getElementsThatExitProfile().forEach(function(e){t.addTrackingEventListener(e,a)})},trackPartnerProfileEndOfPageReached:function(){var e=this;window.addEventListener("scroll",function(){!0===(e.isElementVisible(document.querySelector("#footerUnified"))&&!1===e.endOfPageReached&&null!==document.querySelector("#profileTab.active"))&&(e.endOfPageReached=!0,jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"partner_profile",subcategory:"profile",targetId:"end_of_profile",action:"view"}))})},addTrackingEventListener:function(e,n){var s=this;e.addEventListener("click",function(e){var t=!1,a=!1,r=!1,i=e.target.closest("li");if(null!==i&&(t="profileTab"===i.id,a="matchingTab"===i.id,r="messagesTab"===i.id),!0===t)"profile"!==s.previousTab&&(s.triggerViewEndEvent(n),s.triggerViewStartEvent(n,"profile"),s.previousTab="profile");else if(!0===a)"matching_result"!==s.previousTab&&(s.triggerViewEndEvent(n),s.triggerViewStartEvent(n,"matching_result"),s.endOfPageReached=!1,s.previousTab="matching_result");else if(!0===r){var o=null===document.querySelector("#messagesTab a.is-disabled");"messages"!==s.previousTab&&o&&(s.triggerViewEndEvent(n),s.triggerViewStartEvent(n,"messages"),s.endOfPageReached=!1,s.previousTab=null)}else s.triggerViewEndEvent(n)})},triggerViewEndEvent:function(e){null!==this.previousTab&&jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"partner_profile",subcategory:this.previousTab,targetId:e,action:"view_end"})},triggerViewStartEvent:function(e,t){jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"partner_profile",subcategory:t,targetId:e,action:"view_start"})},getElementsThatExitProfile:function(){var e=Array.from(document.querySelectorAll("#topNavi li:not(#myProfile):not(#openBurger) a")),t=Array.from(document.querySelectorAll("#burgerMenu li a:not([target=_blank])")),a=Array.from(document.querySelectorAll(".secondaryNaviWrapper li a")),r=Array.from(document.querySelectorAll("#myProfileDropdown li a")),i=Array.from(document.querySelectorAll(".partnerPager")),o=Array.from(document.querySelectorAll("#profileTabNavi li")),n=Array.from(document.querySelectorAll("#footerUnified li a:not([target=_blank])"));return e.concat(a).concat(t).concat(r).concat(i).concat(o).concat(n)},isProfileActive:function(){return null!==document.querySelector("#profileTab.active")},isElementVisible:function(e){var t=e.getBoundingClientRect();return e.contains(document.elementFromPoint(t.left,t.top))||e.contains(document.elementFromPoint(t.right,t.top))||e.contains(document.elementFromPoint(t.right,t.bottom))||e.contains(document.elementFromPoint(t.left,t.bottom))}},trackVisitedProfile:function(){var e=$j("#profileHeader"),t=e.data("partnerChiffre"),a=$j("#profileTabNavi li.active").data("trackingName"),r={partnerChiffre:t,tab:a,list:e.data("comeFromList"),_csrf:jPar.wdk.security.getCsrfToken()};$j.ajax({type:"POST",url:e.data("visitedUrl"),data:r}),jPar.Tracking.trackVirtualPage("partner/"+a)},collapseFactfileItems:function(e){$j("#factfileCard").toggleClass("is-close is-open"),e.parent().hasClass("buttonMore")&&$j("#factfileCard").hasClass("is-open")?jPar.util.scrollToElement($j("#factfileCard h2"),0,800):e.parent().hasClass("buttonLess")&&$j("#factfileCard").hasClass("is-close")&&jPar.util.scrollToElement($j("#factfileCard h2"),-40,1200)}}}),jPar.app.profilePages=jPar.app.profilePages||{},$j.extend(!0,jPar.app.profilePages,{tabNaviUtil:{scrollToTabNavi:function(){var e=jPar.wdk.screensize.isBreakpoint(["S","M"])?50:100;void 0!==jPar.app.util.getGetParamFromUrl("openedInMessenger")&&(e=0),jPar.util.scrollToElement($j("#profileTabNavi"),-e)},showTab:function(e){jPar.wdk.loadingIndicator.hide(e),$j("#profileTabNavi li").removeClass("active"),$j("#tabContents > div").removeClass("active").attr("aria-hidden","true").attr("inert","true"),e.addClass("active"),$j("#"+e.attr("id")+"Content").addClass("active").removeAttr("aria-hidden").removeAttr("inert"),!1===e.is("#profileTab")&&jPar.app.profilePages.tabNaviUtil.scrollToTabNavi()},swiper:{init:function(){void 0!==dragscroll&&dragscroll.reset(),this.showSwiperArrowAnimation()},showSwiperArrowAnimation:function(){if(0<$j("html.localstorage").length){var e="partnerProfileTabs.swiperSessionCount",t="partnerProfileTabs.swiperCount";null===sessionStorage.getItem(e)&&sessionStorage.setItem(e,1),null===localStorage.getItem(t)&&localStorage.setItem(t,1);var a=parseInt(sessionStorage.getItem(e),10),r=parseInt(localStorage.getItem(t),10);a<=4&&r<=12&&($j("#profileTabNavi").addClass("showSwiperArrows"),sessionStorage.setItem(e,a+1),localStorage.setItem(t,r+1))}}}}}),jPar.app.partnerProfile.ajaxFormLayer=jPar.app.partnerProfile.ajaxFormLayer||{},$j.extend(!0,jPar.app.partnerProfile.ajaxFormLayer,{aliasForm:{$form:null,layerUtil:null,init:function(){var t=this;this.layerUtil=jPar.app.partnerProfile.ajaxFormLayer.util,t.$form=$j("form#aliasForm");var e=t.$form.find("#alias");jPar.util.putCursorAtEnd(e),t.$form.on("submit",function(e){e.preventDefault(),t.sendMessage()})},sendMessage:function(){var r=this;this.layerUtil.showLoadingAndDisableButtons(),$j.ajax({type:r.$form.attr("method"),url:r.$form.attr("action"),data:r.$form.serialize(),success:function(e){if(r.layerUtil.hideLoadingAndEnableButtons(),r.isValidSuccessResponse(e)){var t=e.saveAliasResponseView.alias;0<$j("#mainUserInfo.isDisplayNameEnabled").length&&""!==t?$j("#mainUserInfo .partnerDisplayName").html(t):""!==t?($j("#mainUserInfo h2 .givenAliasName").html(t),$j("#mainUserInfo").addClass("has-givenAlias"),$j("#aliasButton").addClass("has-givenAlias"),$j("#conversationHeader .alias").html(t+" &bull;"),$j("#conversationHeader .alias").addClass("has-givenAlias"),$j(".contactswrapper a.is-active .alias").html(t+" &bull;"),$j(".contactswrapper a.is-active .alias").addClass("has-givenAlias")):($j("#mainUserInfo h2 .givenAliasName").html(""),$j("#aliasButton").removeClass("has-givenAlias"),$j("#mainUserInfo").removeClass("has-givenAlias"),$j("#conversationHeader .alias").html(""),$j("#conversationHeader .alias").removeClass("has-givenAlias"),$j(".contactswrapper a.is-active .alias").html(""),$j(".contactswrapper a.is-active .alias").removeClass("has-givenAlias")),jPar.wdk.toast.show("#editAliasSuccessfull"),jPar.wdk.modalbox.hide()}else r.handleInvalidResponse(e)},error:function(e,t,a){r.layerUtil.handleNetworkErrorOnSubmit(e,t,a)}})},handleInvalidResponse:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):(jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error($j("body").attr("id"),"giveAlias errorOnSubmit - reallyBadError")),this.layerUtil.scrollToFirstError()},isValidSuccessResponse:function(e){try{return"object"===_typeof(e)&&void 0!==e.saveAliasResponseView&&!0===e.saveAliasResponseView.success}catch(e){return jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),!1}}}}),jPar.app.partnerProfile.ajaxFormLayer=jPar.app.partnerProfile.ajaxFormLayer||{},$j.extend(!0,jPar.app.partnerProfile.ajaxFormLayer,{commentForm:{$form:null,layerUtil:null,init:function(){var t=this;this.layerUtil=jPar.app.partnerProfile.ajaxFormLayer.util,t.layerUtil.setFocusToMsgBody(),t.$form=$j("form#newCommentMessage"),t.$form.on("submit",function(e){e.preventDefault(),t.layerUtil.resetNonBlockingErrors(t.$form),t.validateAllFields(),!1===t.formHasErrors()?t.sendMessage():t.layerUtil.scrollToFirstError()}),$j("#messageBody").on("keyup change",function(e){jPar.util.validate.isNotTabOrShiftKey(e.keyCode)&&t.validateBody()})},validateAllFields:function(){this.validateBody()},formHasErrors:function(){return 0<this.$form.find(".js-submitBlocking.is-visible").length},validateBody:function(){var e=$j("#messageBody"),t=$j("#EMPTY_BODY");jPar.util.validate.textfieldIsEmpty(e)?jPar.wdk.forms.showError(t):jPar.wdk.forms.hideError(t)},sendMessage:function(){var r=this;this.layerUtil.showLoadingAndDisableButtons(),$j.ajax({type:"POST",url:r.$form.attr("action"),data:r.$form.serialize(),success:function(e){r.layerUtil.hideLoadingAndEnableButtons(),r.layerUtil.isValidSuccessResponse(e)?(jPar.wdk.modalbox.hide(),jPar.wdk.toast.show("#commentMessageSendSuccessfull"),r.layerUtil.refreshCommunicationElements(),jPar.util.log.ui("messaging",r.$form.data("tracking_messagetype"),"web")):r.handleErrorCodes(e)},error:function(e,t,a){r.layerUtil.handleNetworkErrorOnSubmit(e,t,a)}})},handleErrorCodes:function(e){jPar.util.network.hasValidSessionAndCsrfToken(e)&&this.layerUtil.hasErrorCodes(e)?this.layerUtil.showErrorsForCodes(e.writeMessageResponse.errorCodes):this.layerUtil.handleInvalidResponse(e)}}}),jPar.app.partnerProfile.ajaxFormLayer=jPar.app.partnerProfile.ajaxFormLayer||{},$j.extend(!0,jPar.app.partnerProfile.ajaxFormLayer,{imagereleaseForm:{$form:null,layerUtil:null,init:function(){var t=this;this.layerUtil=jPar.app.partnerProfile.ajaxFormLayer.util,t.layerUtil.setFocusToMsgBody(),0<$j("form#newImagereleaseMessage").length?t.$form=$j("form#newImagereleaseMessage"):t.$form=$j("form#newImageunreleaseMessage"),t.$form.on("submit",function(e){e.preventDefault(),t.layerUtil.resetNonBlockingErrors(t.$form),t.sendMessage()})},sendMessage:function(){var r=this;this.layerUtil.showLoadingAndDisableButtons(),$j.ajax({type:"POST",url:r.$form.attr("action"),data:r.$form.serialize(),success:function(e){r.layerUtil.hideLoadingAndEnableButtons(),r.layerUtil.isValidSuccessResponse(e)?(jPar.wdk.modalbox.hide(),"newImagereleaseMessage"===r.$form.attr("id")?jPar.wdk.toast.show("#imagereleaseSendSuccessfull"):jPar.wdk.toast.show("#imageunreleaseSendSuccessfull"),r.layerUtil.refreshCommunicationElements(),jPar.util.log.ui("messaging",r.$form.data("tracking_messagetype"),"web")):r.layerUtil.handleInvalidResponse(e)},error:function(e,t,a){r.layerUtil.handleNetworkErrorOnSubmit(e,t,a)}})}}}),jPar.app.partnerProfile=jPar.app.partnerProfile||{},$j.extend(!0,jPar.app.partnerProfile,{ajaxFormLayer:{currentMessageType:null,openAjaxForm:function(e){var t=this,a=$j(e.currentTarget);t.currentMessageType=a.attr("id")+"Layer",jPar.wdk.loadingIndicator.show(a),jPar.wdk.modalbox.show({modalboxId:a.data("openModalboxId"),onSuccess:function(){t.initLoadedLayer(),jPar.app.partnerProfile.messaging.messageMenu.close()},onAlways:function(){jPar.wdk.loadingIndicator.hide(a)},onBeforeClose:function(){return t.textMessageForm.draft.stopAutoSave(),!0}})},initLoadedLayer:function(){var e=this;0<$j("#newTextMessage").length&&(jPar.wdk.forms.init("#newTextMessage"),e.textMessageForm.init()),0<$j("#newSmileMessage").length&&(jPar.wdk.forms.init("#newSmileMessage"),e.smileForm.init()),(0<$j("#newImagereleaseMessage").length||0<$j("#newImageunreleaseMessage").length)&&(jPar.wdk.forms.init("#newImagereleaseMessage"),e.imagereleaseForm.init()),0<$j("#newCommentMessage").length&&(jPar.wdk.forms.init("#newCommentMessage"),e.commentForm.init()),0<$j("#rejectProfileForm").length&&(e.rejectProfileForm.init(),jPar.app.partnerProfile.profileMenue.close()),0<$j("#rejectContactForm").length&&(jPar.wdk.forms.init("#rejectContactForm"),e.rejectContactForm.init(),jPar.app.partnerProfile.profileMenue.close()),0<$j("#reportProfileForm").length&&(jPar.wdk.forms.init("#reportProfileForm"),e.reportForm.init(),jPar.app.partnerProfile.profileMenue.close()),0<$j("#aliasForm").length&&(jPar.wdk.forms.init("#aliasForm"),e.aliasForm.init(),jPar.app.partnerProfile.profileMenue.close()),(0<$j("#partnerIsScammer").length||0<$j("#contactRejected").length)&&$j(".js-reloadPage").on("click",function(e){e.preventDefault(),window.location.reload()})},util:{showLoadingAndDisableButtons:function(){jPar.wdk.loadingIndicator.show($j(".wdk-modalbox .sendMessage")),$j("#saveDraft, .wdk-modalbox.is-open .js-closeModalbox").prop("disabled",!0),$j(".wdk-modalbox.is-open .closeX").addClass("disabled")},hideLoadingAndEnableButtons:function(){jPar.wdk.loadingIndicator.hide($j(".wdk-modalbox .sendMessage")),$j("#saveDraft, .wdk-modalbox.is-open .js-closeModalbox, .wdk-modalbox.is-open .closeX").prop("disabled",!1),$j(".wdk-modalbox.is-open .closeX").removeClass("disabled")},handleNetworkErrorOnSubmit:function(e,t,a){this.hideLoadingAndEnableButtons(),"timeout"===t?jPar.wdk.forms.showError($j("#requestTimeout")):(jPar.wdk.forms.showError($j(".wdk-modalbox.is-open #serverError")),0!==e.status&&403!==e.status&&jPar.util.log.error($j("body").attr("id")+" - "+e.status+" - "+a,"Error for MessageType "+jPar.app.partnerProfile.ajaxFormLayer.currentMessageType)),this.scrollToFirstError()},isValidSuccessResponse:function(e){try{return"object"===_typeof(e)&&void 0!==e.writeMessageResponse&&!0===e.writeMessageResponse.success}catch(e){return jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error(e,"jPar.app.partnerProfile.messaging: sendSmileMessage Ajax-Success-Handling failed"),!1}},hasErrorCodes:function(e){return void 0!==e.writeMessageResponse&&0<e.writeMessageResponse.errorCodes.length},handleInvalidResponse:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.wdk.forms.showError($j("#sessionExpiredOnSend")):!1===this.hasErrorCodes(e)?(jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error($j("body").attr("id")+" "+jPar.app.partnerProfile.ajaxFormLayer.currentMessageType,"AjaxFormLayer errorOnSubmit - no errorCodes provided")):(jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error($j("body").attr("id")+" - "+jPar.app.partnerProfile.ajaxFormLayer.currentMessageType,"AjaxFormLayer errorOnSubmit - reallyBadError")),this.scrollToFirstError()},showErrorsForCodes:function(e){jQuery.each(e,function(){0<$j("#"+this).length?jPar.wdk.forms.showError($j("#"+this)):(jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error($j("body").attr("id")+" - "+jPar.app.partnerProfile.ajaxFormLayer.currentMessageType+" - "+this,"AjaxFormLayer errorOnSubmit - unknown errorCode"))}),this.scrollToFirstError()},resetNonBlockingErrors:function(e){e.find('.wdk-styledHintBox[class*=" t-error"]').not(".js-submitBlocking").each(function(){jPar.wdk.forms.hideError($j(this))})},refreshCommunicationElements:function(){jPar.app.partnerProfile.messaging.reloadContactButtons(),jPar.app.partnerProfile.tabNavigation.reloadMessageTabIfActive(),$j("#messagesTab a").removeClass("is-disabled"),$j("#rejectButton").addClass("is-contact")},scrollToFirstError:function(){var e=$j(".wdk-modalbox.is-open form"),t=e.find('.wdk-styledHintBox[class*=" t-error"].is-visible').first();if(0<t.length){e.find(".wdk-form-text.has-error").first().find("input, textarea").trigger("focus");var a=e.offset().top;e.find(".scrollingContent").animate({scrollTop:t.offset().top-a-70},300)}},setFocusToMsgBody:function(){0<$j("#messageBody").length&&$j(".no-touchevents #messageBody").trigger("focus")},prepareImagereleaseReminder:function(){var e=$j(".messagingLayer #imageRelease"),t=0<e.length,a=!1===e.is(":checked");$j(document).on("wdk:modalbox:isHidden",function(){t&&a&&$j("#sendImagereleaseReminderFakeBut").trigger("click"),$j(document).off("wdk:modalbox:isHidden")})}}}}),jPar.app.partnerProfile.ajaxFormLayer=jPar.app.partnerProfile.ajaxFormLayer||{},$j.extend(!0,jPar.app.partnerProfile.ajaxFormLayer,{rejectContactForm:{$form:null,layerUtil:null,init:function(){var t=this;t.$form=$j("form#rejectContactForm"),this.layerUtil=jPar.app.partnerProfile.ajaxFormLayer.util,t.$form.on("submit",function(e){e.preventDefault(),t.sendMessage()})},sendMessage:function(){var r=this;this.layerUtil.showLoadingAndDisableButtons(),$j.ajax({type:"POST",url:r.$form.attr("action"),data:r.$form.serialize(),success:function(e){r.isValidSuccessResponse(e)?-1<location.pathname.indexOf("/messenger")?window.location=window.location.pathname+"?rejected":""!==e.rejectionResponseView.redirectUrl?location.href=e.rejectionResponseView.redirectUrl:location.reload():(r.layerUtil.hideLoadingAndEnableButtons(),r.handleErrorCodes(e))},error:function(e,t,a){r.layerUtil.handleNetworkErrorOnSubmit(e,t,a)}})},handleErrorCodes:function(e){jPar.util.network.hasValidSessionAndCsrfToken(e)?(jPar.wdk.forms.showError($j(".wdk-modalbox #panicIDontKnowWhatHappenedError")),jPar.util.log.error($j("body").attr("id")+" - "+jPar.app.partnerProfile.ajaxFormLayer.currentMessageType,"RejectContact errorOnSubmit - reallyBadError"),this.layerUtil.scrollToFirstError()):jPar.util.network.reloadIfResponseInvalid(e)},isValidSuccessResponse:function(e){try{return"object"===_typeof(e)&&void 0!==e.rejectionResponseView&&!0===e.rejectionResponseView.success}catch(e){return jPar.wdk.forms.showError($j(".wdk-modalbox #panicIDontKnowWhatHappenedError")),jPar.util.log.error(e,"jPar.app.partnerProfile.messaging: Ajax-Success-Handling for rejection failed"),!1}}}}),jPar.app.partnerProfile.ajaxFormLayer=jPar.app.partnerProfile.ajaxFormLayer||{},$j.extend(!0,jPar.app.partnerProfile.ajaxFormLayer,{rejectProfileForm:{$form:null,layerUtil:null,init:function(){var t=this;this.layerUtil=jPar.app.partnerProfile.ajaxFormLayer.util,t.$form=$j("form#rejectProfileForm"),t.$form.on("submit",function(e){e.preventDefault(),t.sendMessage()})},sendMessage:function(){var t=this,e=$j("#rejectProfileForm [name=partnerUser]").val();this.layerUtil.showLoadingAndDisableButtons(),jPar.app.ajaxCommands.rejectSuggestion(e).then(function(e){jPar.app.shellLayout.loadAppShellContent(e)},function(e){t.handleError(e)})},handleError:function(e){this.layerUtil.hideLoadingAndEnableButtons(),"browserTimeout"===e?jPar.wdk.toast.show("#timeoutNotification"):"sessionExpired"===e?jPar.util.network.reloadForSessionExpired():(jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),this.layerUtil.scrollToFirstError())}}}),jPar.app.partnerProfile.ajaxFormLayer=jPar.app.partnerProfile.ajaxFormLayer||{},$j.extend(!0,jPar.app.partnerProfile.ajaxFormLayer,{reportForm:{$form:null,layerUtil:null,init:function(){var t=this;this.layerUtil=jPar.app.partnerProfile.ajaxFormLayer.util,t.$form=$j("form#reportProfileForm"),$j('input[name="reportReason"]').on("keyup change",function(e){jPar.util.validate.isNotTabOrShiftKey(e.keyCode)&&t.validateReasonRadio()}),$j("#reasonText").on("keyup change",function(e){jPar.util.validate.isNotTabOrShiftKey(e.keyCode)&&t.validateReasonText()}),t.$form.on("submit",function(e){e.preventDefault(),t.layerUtil.resetNonBlockingErrors(t.$form),t.validateAllFields(),!1===t.formHasErrors()&&t.sendMessage()})},validateAllFields:function(){this.validateReasonRadio(),this.validateReasonText()},validateReasonRadio:function(){var e=$j("#emptyReasonRadio");!1===jPar.util.validate.radioIsSelected($j('input[name="reportReason"]'))?jPar.wdk.forms.showError(e):jPar.wdk.forms.hideError(e)},validateReasonText:function(){var e=$j("#reasonText"),t=$j("#emptyReason");jPar.util.validate.textfieldIsEmpty(e)?jPar.wdk.forms.showError(t):jPar.wdk.forms.hideError(t)},formHasErrors:function(){return 0<this.$form.find(".js-submitBlocking.is-visible").length},sendMessage:function(){var r=this;this.layerUtil.showLoadingAndDisableButtons(),$j.ajax({type:r.$form.attr("method"),url:r.$form.attr("action"),data:r.$form.serialize(),success:function(e){r.layerUtil.hideLoadingAndEnableButtons(),r.isValidSuccessResponse(e)?(jPar.wdk.modalbox.hide(),jPar.wdk.toast.show("#reportProfileSuccessfull")):r.layerUtil.handleInvalidResponse(e)},error:function(e,t,a){r.layerUtil.handleNetworkErrorOnSubmit(e,t,a)}})},isValidSuccessResponse:function(e){try{return"object"===_typeof(e)&&void 0!==e.successful&&!0===e.successful}catch(e){return jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),!1}}}}),jPar.app.partnerProfile.ajaxFormLayer=jPar.app.partnerProfile.ajaxFormLayer||{},$j.extend(!0,jPar.app.partnerProfile.ajaxFormLayer,{smileForm:{$form:null,layerUtil:null,init:function(){var t=this;this.layerUtil=jPar.app.partnerProfile.ajaxFormLayer.util,t.layerUtil.setFocusToMsgBody(),t.$form=$j("form#newSmileMessage"),t.$form.on("submit",function(e){e.preventDefault(),t.layerUtil.resetNonBlockingErrors(t.$form),t.sendMessage()})},sendMessage:function(){var r=this;this.layerUtil.showLoadingAndDisableButtons(),$j.ajax({type:"POST",url:r.$form.attr("action"),data:r.$form.serialize(),success:function(e){r.layerUtil.hideLoadingAndEnableButtons(),r.layerUtil.isValidSuccessResponse(e)?(r.layerUtil.prepareImagereleaseReminder(),jPar.wdk.modalbox.hide(),jPar.wdk.toast.show("#smileMessageSendSuccessfull"),r.layerUtil.refreshCommunicationElements(),jPar.util.log.ui("messaging",r.$form.data("tracking_messagetype"),"web")):r.handleErrorCodes(e)},error:function(e,t,a){r.layerUtil.handleNetworkErrorOnSubmit(e,t,a)}})},handleErrorCodes:function(e){jPar.util.network.hasValidSessionAndCsrfToken(e)&&this.layerUtil.hasErrorCodes(e)?this.layerUtil.showErrorsForCodes(e.writeMessageResponse.errorCodes):this.layerUtil.handleInvalidResponse(e)}}}),jPar.app.partnerProfile.ajaxFormLayer=jPar.app.partnerProfile.ajaxFormLayer||{},$j.extend(!0,jPar.app.partnerProfile.ajaxFormLayer,{textMessageForm:{$form:null,layerUtil:null,submitInProgress:!1,init:function(){var t=this;this.layerUtil=jPar.app.partnerProfile.ajaxFormLayer.util,t.setFocus(),t.$form=$j("form#newTextMessage"),t.$form.data("submitInProgress",!1),t.$form.on("submit",function(e){e.preventDefault(),t.layerUtil.resetNonBlockingErrors(t.$form),t.validateAllFields(),!1===t.formHasErrors()?t.sendMessage():t.layerUtil.scrollToFirstError()}),$j("#messageBody").on("keyup change",function(e){jPar.util.validate.isNotTabOrShiftKey(e.keyCode)&&t.validateBody()}),$j("#saveDraft").on("click",function(e){e.preventDefault(),t.validateAllFields(),!1===t.formHasErrors()?(t.draft.save(),t.layerUtil.refreshCommunicationElements()):t.layerUtil.scrollToFirstError()}),this.draft.init()},validateAllFields:function(){this.validateBody()},formHasErrors:function(){return 0<$j("#newTextMessage").find(".js-submitBlocking.is-visible").length},validateBody:function(){var e=$j("#messageBody"),t=$j("#EMPTY_BODY");jPar.util.validate.textfieldIsEmpty(e)?jPar.wdk.forms.showError(t):jPar.wdk.forms.hideError(t)},sendMessage:function(){var r=this;!1===r.$form.data("submitInProgress")&&(r.$form.data("submitInProgress",!0),this.layerUtil.showLoadingAndDisableButtons(),$j.ajax({type:"POST",url:r.$form.attr("action"),data:r.$form.serialize(),success:function(e){r.$form.data("submitInProgress",!1),r.layerUtil.hideLoadingAndEnableButtons(),r.draft.deleteDraftFromLocalStorage(),r.layerUtil.isValidSuccessResponse(e)?(r.layerUtil.prepareImagereleaseReminder(),jPar.wdk.modalbox.hide(),jPar.wdk.toast.show("#textMessageSendSuccessfull"),r.layerUtil.refreshCommunicationElements(),jPar.util.log.ui("messaging",r.$form.data("tracking_messagetype"),"web")):r.handleErrorCodes(e)},error:function(e,t,a){r.$form.data("submitInProgress",!1),r.layerUtil.handleNetworkErrorOnSubmit(e,t,a)}}))},handleErrorCodes:function(e){jPar.util.network.hasValidSessionAndCsrfToken(e)&&this.layerUtil.hasErrorCodes(e)?this.layerUtil.showErrorsForCodes(e.writeMessageResponse.errorCodes):this.layerUtil.handleInvalidResponse(e)},setFocus:function(){$j(".no-touchevents #messageBody").trigger("focus")},draft:{myUserId:null,autoSaveTimer:null,$textMsgForm:null,layerUtil:jPar.app.partnerProfile.ajaxFormLayer.util,init:function(){this.myUserId=$j("#domPageVars").data("userId"),this.$textMsgForm=jPar.app.partnerProfile.ajaxFormLayer.textMessageForm.$form,this.prefillTextrareaWithLocalStorage(),this.startAutoSave()},startAutoSave:function(){var e=this;e.$textMsgForm=jPar.app.partnerProfile.ajaxFormLayer.textMessageForm.$form;var t=1e3*parseInt(e.$textMsgForm.data("autoSaveInterval"),10),a=$j("#messageBody");this.autoSaveTimer=window.setInterval(function(){jPar.util.validate.textfieldIsEmpty(a)||e.autoSave()},t)},stopAutoSave:function(){window.clearInterval(this.autoSaveTimer)},save:function(){var r=this;!1===r.$textMsgForm.data("submitInProgress")&&(r.$textMsgForm.data("submitInProgress",!0),r.layerUtil.resetNonBlockingErrors(r.$textMsgForm),r.showLoadingAndDisableButtonsDraft(),$j.ajax({type:"POST",url:r.$textMsgForm.data("drafturl"),data:r.$textMsgForm.serialize(),success:function(e){r.$textMsgForm.data("submitInProgress",!1),r.hideLoadingAndEnableButtonsDraft(),r.deleteDraftFromLocalStorage(),r.layerUtil.isValidSuccessResponse(e)?r.handleSaveDraftSuccess(e):!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.wdk.forms.showError($j("#sessionExpiredOnSend")):(jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error($j("body").attr("id"),"saveDraft failed: errorOnSubmit - reallyBadError"))},error:function(e,t,a){r.$textMsgForm.data("submitInProgress",!1),r.hideLoadingAndEnableButtonsDraft(),"timeout"===t?jPar.wdk.forms.showError($j("#requestTimeout")):(jPar.wdk.forms.showError($j("#serverError")),0!==e.status&&403!==e.status&&jPar.util.log.error($j("body").attr("id")+" - "+e.status+" - "+a,"saveDraft failed"))}}))},autoSave:function(){var r=this;!1===r.$textMsgForm.data("submitInProgress")&&(r.$textMsgForm.data("submitInProgress",!0),r.layerUtil.resetNonBlockingErrors(r.$textMsgForm),$j.ajax({type:"POST",url:r.$textMsgForm.data("drafturl"),data:r.$textMsgForm.serialize(),success:function(e){r.$textMsgForm.data("submitInProgress",!1),r.layerUtil.isValidSuccessResponse(e)?r.handleAutosaveDraftSuccess(e):!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?r.stopAutoSave():jPar.util.log.error($j("body").attr("id"),"autoSaveDraft failed errorOnSubmit - reallyBadError")},error:function(e,t,a){r.$textMsgForm.data("submitInProgress",!1),"timeout"===t||(r.stopAutoSave(),0!==e.status&&403!==e.status&&jPar.util.log.error($j("body").attr("id")+" - "+e.status+" - "+a,"autoSaveDraft failed"))}}))},handleAutosaveDraftSuccess:function(e){$j("#messageId").val(e.writeMessageResponse.messageId);var t=new Date,a=t.getHours()<10?"0":"",r=t.getMinutes()<10?"0":"",i=a+t.getHours()+":"+r+t.getMinutes(),o=$j("#autosaveDraftSuccessfull").data("sotext").replace("{0}",i);$j("#autosaveDraftSuccessfull").text(o),$j("#autosaveDraftSuccessfull").addClass("is-visible"),$j("#saveDraftSuccessfull").removeClass("is-visible"),jPar.app.partnerProfile.tabNavigation.reloadMessageTabIfActive()},handleSaveDraftSuccess:function(e){$j("#messageId").val(e.writeMessageResponse.messageId),$j("#saveDraftSuccessfull").addClass("is-visible"),$j("#autosaveDraftSuccessfull").removeClass("is-visible"),jPar.app.partnerProfile.tabNavigation.reloadMessageTabIfActive()},showLoadingAndDisableButtonsDraft:function(){jPar.wdk.loadingIndicator.show($j(".wdk-modalbox.is-open #saveDraft")),$j(".wdk-modalbox.is-open .sendMessage, .wdk-modalbox.is-open .js-closeModalbox").prop("disabled",!0),$j(".wdk-modalbox.is-open .closeX").addClass("disabled")},hideLoadingAndEnableButtonsDraft:function(){jPar.wdk.loadingIndicator.hide($j(".wdk-modalbox.is-open #saveDraft")),$j(".wdk-modalbox.is-open .sendMessage, .wdk-modalbox.is-open .js-closeModalbox").prop("disabled",!1),$j(".wdk-modalbox.is-open .closeX").removeClass("disabled")},prefillTextrareaWithLocalStorage:function(){var e=$j("#newTextMessage").find("textarea");if(0<$j("html.localstorage").length){var t=$j("#profileHeader").data("partnerChiffre"),a=localStorage.getItem(this.myUserId+"_draft_for_"+t);e.text(a),jPar.util.putCursorAtEnd(e)}},deleteDraftFromLocalStorage:function(){if(0<$j("html.localstorage").length){var e=$j("#profileHeader").data("partnerChiffre");localStorage.removeItem(this.myUserId+"_draft_for_"+e)}}}}}),jPar.app.partnerProfile=jPar.app.partnerProfile||{},$j.extend(!0,jPar.app.partnerProfile,{like:{init:function(){var t=this;t.setInitialLikeStatus(),$j(document).on("click",".likeIt.is-liked, .likeIt.is-disabled",function(e){e.preventDefault()}),$j(document).on("click",".likeIt:not(.is-liked, .is-disabled)",function(e){e.preventDefault(),t.send($j(this))})},setInitialLikeStatus:function(){$j.ajax({url:"/like/likedElements",data:{partnerChiffre:$j("#profileHeader").data("partnerChiffre")},dataType:"json",type:"GET",success:function(e){if(jPar.util.network.hasValidSessionAndCsrfToken(e)){var t=e.resultView;$j.each(t.likeElements,function(e,t){$j("#like_"+t).addClass("is-liked")}),t.likeDisabled&&$j(".likeIt").not(".is-liked").addClass("is-disabled")}},error:function(e,t,a){"timeout"!==t&&0!==e.status&&jPar.util.log.error($j("body").attr("id")+" - "+e.status+" - "+a,"getLikeStatus Failed")}})},send:function(r){var t=this;void 0!==window.navigator.vibrate&&window.navigator.vibrate(50),r.addClass("is-animated"),r.one(jPar.util.prefixedAnimationEndEvent,function(){r.removeClass("is-animated")}),$j.ajax({type:"POST",url:r.data("likeurl"),data:{_csrf:jPar.wdk.security.getCsrfToken(),partnerChiffre:$j("#profileHeader").data("partnerChiffre")},success:function(e){jPar.util.network.hasValidSessionAndCsrfToken(e)?t.handleSuccess(e.resultView,r):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),0!==e.status&&403!==e.status&&jPar.util.log.error($j("body").attr("id")+" error on "+r.attr("id")+" - "+e.status+" - "+a,"like failed"))}})},handleSuccess:function(e,t){!0===e.success?(t.addClass("is-liked"),"photos"===e.likeElements[0]&&-1!==navigator.userAgent.indexOf("iPad")&&window.setTimeout(function(){t.addClass("noDisplay")},400),jPar.app.partnerProfile.ajaxFormLayer.util.refreshCommunicationElements(),e.likeDisabled&&$j(".likeIt").not(".is-liked").addClass("is-disabled"),void 0!==jPar.app.util.getGetParamFromUrl("openedInMessenger")?parent.postMessage("likeOnPartnerProfile",window.location.origin):jPar.wdk.toast.show("#likeSuccess")):"PROFILE_COMPLETE_NOT_ENOUGH"===e.errorCode?jPar.wdk.modalbox.show({modalboxId:"profileCompletenessModalBox"}):(null!==e.errorMessage&&""!==e.errorMessage&&$j("#likeFailed").text(e.errorMessage),jPar.wdk.toast.show("#likeFailed"))}}}),jPar.app.partnerProfile=jPar.app.partnerProfile||{},$j.extend(!0,jPar.app.partnerProfile,{matchingTabEP:{init:function(){jPar.wdk.cardDeck.init(),this.matchingTeaser.init(),jPar.app.profilePages.matchingDiagram.init(),$j(".js-openMotiveModal, .js-openPrincipleModal").on("click",function(e){e.preventDefault();var t=$j(this).data("modalbox");jPar.wdk.modalbox.show({modalboxId:"#"+t})})},matchingTeaser:{init:function(){if(0<$j("#matchingTabContent .matchingPointsGraph").length){var e=this;$j(window).add("#pageWrapper").on("scroll.matchingTabTeaserAnimation touchmove.matchingTabTeaserAnimation",function(){e.animateMatchingTeaser()}),e.animateMatchingTeaser()}},animateMatchingTeaser:function(){var e=$j("#matchingTabContent .matchingPointsGraph");e.find(".myPicContainer").isOnScreen()&&!e.hasClass("animate")&&e.addClass("animate"),e.hasClass("animate")&&$j(window).off(".matchingTabTeaserAnimation")}}}}),jPar.app.partnerProfile=jPar.app.partnerProfile||{},$j.extend(!0,jPar.app.partnerProfile,{matchingTabPsEh:{init:function(){$j(".js-openRestartQuestionaireConfirmModal").on("click",function(e){e.preventDefault(),jPar.wdk.modalbox.show({modalboxId:"#restartQuestionaireConfirmModal"})}),$j(".js-openMatchingExplanationModal").on("click",function(e){e.preventDefault();var t=$j(this).data("modalbox")+"Modal";jPar.wdk.modalbox.show({modalboxId:"#"+t})}),0<$j("#matchingWheel").length&&jPar.util.loadScript("chartjs_combined",function(){jPar.app.profilePages.matchingWheel.init()}),this.initSubTabs()},initSubTabs:function(){var a=this;$j("#matchingSubTabs a").on("click",function(e){e.preventDefault();var t=$j(this).parent();a.showTab(t)})},showTab:function(e){$j("#matchingSubTabs li, #subTabContents > div").removeClass("active"),e.addClass("active"),$j("#"+e.attr("id")+"Content").addClass("active")}}}),jPar.app.partnerProfile=jPar.app.partnerProfile||{},$j.extend(!0,jPar.app.partnerProfile,{messaging:{currentMessageType:null,init:function(){var t=this;t.messageMenu.showAnimation(),$j("#profileHeader").on("click","#communicationButtons button#sendTextMessage",function(e){e.preventDefault(),jPar.app.partnerProfile.ajaxFormLayer.openAjaxForm(e)}),$j("#profileHeader").on("click","#communicationButtons #sendSmile",function(e){e.preventDefault(),jPar.app.partnerProfile.ajaxFormLayer.openAjaxForm(e)}),$j("#profileHeader").on("click","#communicationButtons #sendImagerelease",function(e){e.preventDefault(),jPar.app.partnerProfile.ajaxFormLayer.openAjaxForm(e)}),$j("#profileHeader").on("click","#communicationButtons #sendImagereleaseReminderFakeBut",function(e){e.preventDefault(),jPar.app.partnerProfile.ajaxFormLayer.openAjaxForm(e)}),$j("#profileHeader").on("click","#communicationButtons .js-sendIcebreaker",function(e){e.preventDefault(),jPar.app.sharedFeatures.icebreaker.play.openLayer(e)}),$j("#profileHeader").on("click","#communicationButtons .js-answerIcebreaker",function(e){e.preventDefault(),jPar.app.sharedFeatures.icebreaker.play.openLayer(e)}),$j("#profileHeader").on("click","#communicationButtons #selectMessage",function(e){e.preventDefault(),t.messageMenu.open()})},reloadContactButtons:function(){$j.ajax({type:"GET",url:$j("#communicationButtons").data("reloadUrl"),cache:!1,success:function(e){-1<e.indexOf("communicationButtonsList")&&$j("#communicationButtonsList").replaceWith(e)},error:function(){}})},messageMenu:{showAnimation:function(){if(0<$j("html.localstorage").length){null===localStorage.getItem("PartnerProfileMsgButtonAniCount")&&localStorage.setItem("PartnerProfileMsgButtonAniCount",0);var e=parseInt(localStorage.getItem("PartnerProfileMsgButtonAniCount"),10);e<5&&($j("#selectMessage").addClass("showAnimation"),localStorage.setItem("PartnerProfileMsgButtonAniCount",e+1))}},open:function(){var a=this;$j("html").addClass("has-openMessageMenu"),$j("#communicationButtonsList #sendTextMessage .trippleDot").addClass("t-dark"),$j("#pageWrapper").on("click.closeMessageMenu touchstart.closeMessageMenu",function(e){var t=$j(e.target);t.is("#communicationButtons")||t.parents("#communicationButtons").length||(e.preventDefault(),a.close())}),$j(window).on("resize.closeMessageMenu",function(){jPar.wdk.screensize.isBreakpoint(["S"])||a.close()})},close:function(){$j("html").removeClass("has-openMessageMenu"),$j("#pageWrapper").off(".closeMessageMenu"),$j("#communicationButtonsList #sendTextMessage .trippleDot").removeClass("t-dark")}}}}),jPar.app.partnerProfile=jPar.app.partnerProfile||{},$j.extend(!0,jPar.app.partnerProfile,{profileMenue:{init:function(){var t=this;$j("body").on("click",".openProfilemenu, #closePartnerProfileMenu",function(e){e.preventDefault(),$j("html").hasClass("has-openProfileMenu")?t.close():t.open()})},open:function(){var a=this;$j("#profileMenu > a").attr("aria-expanded","true"),$j("html").addClass("has-openProfileMenu"),$j("#profileMenuList").attr("aria-hidden",!1),$j("#topNavi, #tabContents, #footerUnified, .headerWrapper2, #profileTabNavi, #photoBox .photoWrapper a").attr("inert","true"),$j("#rejectProfile").on("click.partnerProfileMenu",function(e){e.preventDefault(),jPar.app.partnerProfile.ajaxFormLayer.openAjaxForm(e)}),$j("#rejectContact").on("click.partnerProfileMenu",function(e){e.preventDefault(),jPar.app.partnerProfile.ajaxFormLayer.openAjaxForm(e)}),$j("#removeContact").on("click.partnerProfileMenu",function(e){e.preventDefault(),a.removeContact()}),$j("#reportProfile").on("click.partnerProfileMenu",function(e){e.preventDefault(),jPar.app.partnerProfile.ajaxFormLayer.openAjaxForm(e)}),$j("#giveAlias, #editAlias").on("click.partnerProfileMenu",function(e){e.preventDefault(),jPar.app.partnerProfile.ajaxFormLayer.openAjaxForm(e)}),$j("#pageWrapper").on("click.partnerProfileMenu",function(e){var t=$j(e.target);t.is("#profileMenuList")||t.parents("#profileMenuList").length||t.is(".openProfilemenu")||(e.preventDefault(),a.close())})},removeContact:function(){var e=this;$j.ajax({type:"POST",url:$j("#removeContact").data("target"),data:{_csrf:jPar.wdk.security.getCsrfToken()},success:function(){window.location=window.location.pathname+"?deleted"},error:function(){e.close()}})},close:function(){$j("html").removeClass("has-openProfileMenu"),$j("#profileMenu > a").attr("aria-expanded","false"),$j("#profileMenuList").attr("aria-hidden",!0),$j("#pageWrapper, #profileMenuList a").off(".partnerProfileMenu"),$j("#topNavi, #tabContents, #footerUnified, .headerWrapper2, #profileTabNavi, #photoBox .photoWrapper a").removeAttr("inert")}}}),jPar.app.partnerProfile=jPar.app.partnerProfile||{},$j.extend(!0,jPar.app.partnerProfile,{profileTab:{init:function(e){var t=this;jPar.wdk.cardDeck.init(),this.slideUpCards(),this.initZipMap(),this.matchingTeaser.init(),$j(window).add("#pageWrapper").on("scroll.slideUpAnimationEvent touchmove.slideUpAnimationEvent resize.slideUpAnimationEvent",function(){var e=t.slideUpCards();e.allCardsWidthSlideUpAnimation===e.startedSlideUpElements&&$j(this).off(".slideUpAnimationEvent")}),e&&jPar.app.partnerProfile.like.setInitialLikeStatus()},slideUpCards:function(){return $j("#leisureCard, #matchingCard, #profileTabContent .linkListCard, #profileTabContent .urcCard").addClass("has-slideUpAnimation"),jPar.wdk.screensize.isBreakpoint(["S","M"])&&0<$j("#aboutmeCard").length&&$j("#aboutmeCard").addClass("has-slideUpAnimation"),0<$j("#leisureCard").length&&$j("#leisureCard").isOnScreen()&&$j("#leisureCard.has-slideUpAnimation").addClass("startSlideUp"),0<$j("#matchingCard").length&&$j("#matchingCard").isOnScreen()&&$j("#matchingCard.has-slideUpAnimation").addClass("startSlideUp"),0<$j("#aboutmeCard").length&&$j("#aboutmeCard").isOnScreen()&&$j("#aboutmeCard.has-slideUpAnimation").addClass("startSlideUp"),0<$j("#profileTabContent .linkListCard").length&&$j("#profileTabContent .linkListCard").isOnScreen()&&$j(".linkListCard.has-slideUpAnimation").addClass("startSlideUp"),$j("#profileTabContent .urcCard.has-slideUpAnimation").each(function(){$j(this).isOnScreen()&&$j(this).addClass("startSlideUp")}),{startedSlideUpElements:(0<$j("#profileTabContent .wdk-cardDeck .startSlideUp").length&&$j("#profileTabContent .wdk-cardDeck .startSlideUp")).length,allCardsWidthSlideUpAnimation:$j("#profileTabContent .wdk-cardDeck .has-slideUpAnimation").length}},initZipMap:function(){$j(".js-openZipMap").on("click",function(e){e.preventDefault();var t=$j("#zipMapModal img");t.attr("src",t.data("src")),jPar.wdk.modalbox.show({modalboxId:"zipMapModal"})})},matchingTeaser:{init:function(){var e=this;$j("#matchingCard").on("click",function(){jPar.app.partnerProfile.tabNavigation.switchTab($j("#matchingTab"))}),$j(window).add("#pageWrapper").on("scroll.matchingTeaserAnimation touchmove.matchingTeaserAnimation",function(){e.animateMatchingTeaser()}),e.animateMatchingTeaser()},animateMatchingTeaser:function(){if(jPar.wdk.brands.forBrands(["ps","eh"])){var e=$j("#matchingCircle");e.find(".displayMP").isOnScreen()&&!e.hasClass("animate")&&e.addClass("animate"),e.hasClass("animate")&&$j(window).off(".matchingTeaserAnimation")}else if(jPar.wdk.brands.forBrands(["ep"])){var t=$j("#profileTabContent .matchingPointsGraph");t.find(".myPicContainer").isOnScreen()&&!t.hasClass("animate")&&t.addClass("animate"),t.hasClass("animate")&&$j(window).off(".matchingTeaserAnimation")}}}}}),jPar.app.partnerProfile=jPar.app.partnerProfile||{},$j.extend(!0,jPar.app.partnerProfile,{tabNavigation:{init:function(){var a=this;jPar.app.profilePages.tabNaviUtil.swiper.init(),$j("#profileTabNavi a:not([data-is-page-link-only=true])").on("click",function(e){e.preventDefault();var t=$j(this).parent();!1===t.is(".active")&&!1===t.is(".disabled")&&a.switchTab(t)}),jPar.app.util.initPopState(function(){a.updatePageFromUrl();var e=document.location.href,t=document.querySelector("#profileHeader").dataset.partnerChiffre;e.includes("partnersuggestions")?jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"partner_profile",subcategory:"profile",targetId:t,action:"view_end"}):e.includes("partnerandme")?(jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"partner_profile",subcategory:"profile",targetId:t,action:"view_end"}),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"partner_profile",subcategory:"matching_result",targetId:t,action:"view_start"})):e.includes("factfilepartner")&&jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"partner_profile",subcategory:"matching_result",targetId:t,action:"view_end"})},".profileTabNavi"),!0===$j("#profileTabNavi").data("scrollToTabNavi")&&jPar.app.profilePages.tabNaviUtil.scrollToTabNavi()},switchTab:function(r,e){var t=!1;void 0!==e&&!0===e.preventPushstate&&(t=!0),jPar.wdk.loadingIndicator.show(r),r.data("contentLoaded")?jPar.app.profilePages.tabNaviUtil.showTab(r):$j.ajax({type:"GET",url:r.data("contentUrl"),success:function(e){jPar.util.network.hasValidSessionAndCsrfToken(e)?(r.data("contentLoaded",!0),$j("#"+r.attr("id")+"Content").html(e),jPar.app.profilePages.tabNaviUtil.showTab(r),jPar.app.partnerProfile.initActiveTab(!0),jPar.app.partnerProfile.trackVisitedProfile()):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){jPar.wdk.loadingIndicator.hide(r),"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),0!==e.status&&403!==e.status&&jPar.util.log.error($j("body").attr("id"),NaN+r.attr("id")+" - "+e.status+" - "+a,"tabNavigation error on opening tab"))}}),!1===t&&this.setPushState(r)},reloadMessageTabIfActive:function(){$j("#messagesTab").data("contentLoaded")&&($j("#messagesTab").data("contentLoaded",!1),$j("#messagesTab").hasClass("active")&&this.switchTab($j("#messagesTab")))},setPushState:function(e){var t=$j("#profileHeader").data("partnerChiffre"),a=void 0===jPar.app.util.getGetParamFromUrl("openedInMessenger");0<$j("html.history").length&&a&&(e.is("#profileTab")?history.pushState(null,null,"/partner/factfilepartner?match="+t):e.is("#matchingTab")&&history.pushState(null,null,"/partner/partnerandme?match="+t))},updatePageFromUrl:function(){var e=document.location.href;jPar.wdk.modalbox.closeCurrentModalbox(),-1<e.indexOf("partner/factfilepartner")?this.switchTab($j("#profileTab"),{preventPushstate:!0}):-1<e.indexOf("partner/partnerandme")&&this.switchTab($j("#matchingTab"),{preventPushstate:!0})}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app.myProfile,{aboutMe:{init:function(){var t=this;t.sorting.init(),t.deleting.init(),$j("#aboutmeCard").on("click","#addAboutMeQuestion",function(e){e.preventDefault(),t.openNewQuestionLayer(e)}),$j("#aboutmeCard").on("click","#aboutMeQuestions li",function(e){e.preventDefault(),t.openEditQuestionLayer(e)})},openNewQuestionLayer:function(e){var t=this,a=$j(e.currentTarget);jPar.wdk.loadingIndicator.show(a),jPar.wdk.modalbox.show({modalboxId:"addAboutMeQuestionModalWrapper",ajaxSettings:{type:"GET",data:{_csrf:$j("meta[name=_csrf]").attr("content")}},onSuccess:function(){t.editLayer.initAddAboutMeLayer()},onAlways:function(){jPar.wdk.loadingIndicator.hide(a)}})},openEditQuestionLayer:function(e){var t=this,a=$j(e.currentTarget),r=a.find(".openEditIcon");jPar.wdk.loadingIndicator.show(r),jPar.wdk.modalbox.show({modalboxId:"aboutMeQuestionModalboxWrapper"+a.data("questionId"),ajaxSettings:{type:"GET",data:{_csrf:$j("meta[name=_csrf]").attr("content")}},onSuccess:function(){t.editLayer.initEditAboutMeLayer()},onAlways:function(){jPar.wdk.loadingIndicator.hide(r)}})},updateAboutMeCard:function(){$j.ajax({type:"GET",cache:!1,url:"/profile/my_profile/aboutme_questions",success:function(e){$j("#aboutmeCard .aboutMeQuestionsWrapper").replaceWith(e),jPar.app.myProfile.aboutMe.sorting.updateArrowsStatus()}})},editLayer:{$editForm:null,freetext:null,questionId:null,initAddAboutMeLayer:function(){var t=this;t.$editForm=$j(".addAboutMeQuestionModal.is-open"),t.$editForm.find(".saveElement").on("click",function(e){e.preventDefault(),t.save()}),t.$editForm.find("#aboutMeEditInput").on("keyup change",function(e){jPar.util.validate.isNotTabOrShiftKey(e.keyCode)&&t.validateAboutMeField()}),jPar.wdk.forms.textElement.init(".addAboutMeQuestionModal.is-open"),$j("#aboutMeEditInput").prop("disabled",!0),$j("#aboutMeEditInput").parents(".wdk-form-text").addClass("is-disabled"),jPar.wdk.forms.customDropdown.init(".addAboutMeQuestionModal.is-open",function(){var e=t.$editForm.find("input[name=selectedItem]").val();t.$editForm.find("input[name=questionId]").val(e),t.activateTextarea(),t.resetScrollPosition()})},initEditAboutMeLayer:function(){var t=this;t.$editForm=$j(".editAboutMeQuestionModal.is-open"),t.questionId=t.$editForm.find('[name="questionId"]').val(),t.freetext=t.getTextByQuestionId(t.questionId);var e=t.$editForm.find("textarea");if(0<e.length){var a=e.data("currentSavedValue").replace(/<br \/>/g,"\n");e.val(jPar.wdk.security.htmlEntitiesToChars(a))}t.$editForm.find(".saveElement").on("click",function(e){e.preventDefault(),t.save()}),t.$editForm.find("#aboutMeAnswerInput").on("keyup",function(){jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))}),jPar.wdk.forms.textElement.init(".editAboutMeQuestionModal.is-open"),jPar.app.util.editLayer.setFocusToMainField(".editAboutMeQuestionModal.is-open")},textHasChanged:function(e){return e!==this.freetext},getTextByQuestionId:function(e){return $j("#question_"+e).find(".questionText").text()},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r.$editForm),r.validateAboutMeField(),this.textHasChanged(r.$editForm.find("#aboutMeAnswerInput").val())?!1===this.formHasErrors()&&(jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"profile_questions",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})):jPar.wdk.modalbox.hide()},validateAboutMeField:function(){this.$editForm.is(".addAboutMeQuestionModal")&&("-1"===this.$editForm.find("input[name=questionId]").val()?jPar.wdk.forms.showError(this.$editForm.find(".selectQuestionError")):0===$j("#aboutMeEditInput").val().length?jPar.wdk.forms.showError(this.$editForm.find(".answerEmptyError")):jPar.wdk.forms.hideError(this.$editForm.find(".answerEmptyError")))},formHasErrors:function(){return this.$editForm.is(".addAboutMeQuestionModal")?0===this.$editForm.find("#aboutMeEditInput").val().length:!this.$editForm.is(".editAboutMeQuestionModal")&&void 0},handleSuccessResponse:function(){jPar.app.myProfile.updateProfileCompletion(),jPar.app.myProfile.aboutMe.updateAboutMeCard(),jPar.wdk.modalbox.hide(),jPar.wdk.toast.show("#aboutmeSaved")},activateTextarea:function(){$j("#aboutMeEditInput").prop("disabled",!1),jPar.app.util.editLayer.setFocusToMainField("#addAboutMeQuestionModal"),jPar.wdk.forms.hideError(this.$editForm.find(".selectQuestionError"))},resetScrollPosition:function(){$j(".js-scrollableContent").scrollTop(0),window.setTimeout(function(){null!==jPar.wdk.modalbox.conf.perfectScrollbarObj&&jPar.wdk.modalbox.conf.perfectScrollbarObj.update()},300)}},sorting:{init:function(){var t=this;t.updateArrowsStatus(),$j("#aboutmeCard").on("click",".moveUp, .moveDown",function(e){t.swapRows(e)})},swapRows:function(e){e.preventDefault(),e.stopPropagation();var t=$j(e.target);if(!t.hasClass("disabled")){var a,r=t.parents("li").first();t.hasClass("moveUp")?(a=r.prev("li"),r.detach().insertBefore(a)):(a=r.next("li"),r.detach().insertAfter(a)),r.addClass("highlight"),this.updateSorting(),this.updateArrowsStatus()}},updateSorting:function(){var e=$j("#aboutMeQuestions"),t=[];e.find("li").each(function(){t.push($j(this).data("questionId"))});var a={questionId:t,_csrf:jPar.wdk.security.getCsrfToken()};$j.ajax({type:"POST",url:e.data("sortingUrl"),cache:!1,async:!1,data:a,traditional:!0,error:function(){jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"})}})},updateArrowsStatus:function(){var e=$j("#aboutMeQuestions");e.find(".moveDown, .moveUp").removeClass("disabled");var t=e.find("li:first .moveUp"),a=e.find("li:last .moveDown"),r=1===e.find("li").length;t.addClass("disabled"),a.addClass("disabled"),r?(t.addClass("noDisplay"),a.addClass("noDisplay")):(t.removeClass("noDisplay"),a.removeClass("noDisplay"))}},deleting:{$editForm:null,questionId:null,init:function(){var a=this;a.$editForm=$j("#editConfirmDeleteQuestionModal"),$j("#aboutmeCard").on("click",".deleteAnswer",function(e){e.preventDefault(),e.stopPropagation();var t=$j(e.currentTarget);a.questionId=t.data("questionId"),jPar.wdk.modalbox.show({modalboxId:a.$editForm.attr("id"),onBeforeClose:function(){return a.resetFormOnAbort(),!0}})}),$j("#yesDoDeleteQuestion").on("click",function(e){e.preventDefault();var t=$j(e.currentTarget);a.deleteAnswer(t)})},deleteAnswer:function(r){var i=this;jPar.app.util.editLayer.hideAllErrors(i.$editForm),jPar.wdk.loadingIndicator.show(r);var e={_csrf:jPar.wdk.security.getCsrfToken(),questionId:jPar.app.myProfile.aboutMe.deleting.questionId};$j.ajax({type:"POST",url:"/profile/deleteAboutQuestion",data:e,success:function(e){jPar.app.util.editLayer.resultViewIsSuccess(e)?(jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"profile_questions",action:"section_edited"}),jPar.wdk.toast.show("#deleteQuestionSuccess"),jPar.app.myProfile.updateProfileCompletion(),jPar.app.myProfile.aboutMe.updateAboutMeCard(),jPar.wdk.modalbox.hide()):jPar.app.util.editLayer.handleInvalidResponse(i.$editForm,e),jPar.wdk.loadingIndicator.hide(r)},error:function(e,t,a){i.$editForm.find(".saveError").addClass("is-visible"),jPar.wdk.loadingIndicator.hide(r),"timeout"!==t&&0!==e.status&&jPar.util.log.error(t+" - "+a,"jPar.app.myProfile.aboutMe delete failed")}})},resetFormOnAbort:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm)}}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{courseOfStudies:{$editForm:null,$editInput:null,freetext:null,init:function(){var t=this;this.$editForm=$j("#editCourseOfStudiesModal"),this.$editInput=$j("#courseOfStudiesEditInput"),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),this.$editInput.on("keyup change",function(e){jPar.util.validate.isNotTabOrShiftKey(e.keyCode)&&t.validateField(),jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))}),this.freetext=$j("#js-currentFreetext").text()},textHasChanged:function(e){return e!==this.freetext},resetFormOnAbort:function(){jPar.app.util.editLayer.resetFreetextForField(this.$editInput),jPar.app.util.editLayer.resetApprovalForField(this.$editInput),jPar.app.util.editLayer.hideAllErrors(this.$editForm)},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r.$editForm),this.textHasChanged($j("#courseOfStudiesEditInput").val())?!1===r.formHasErrors()?(jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),r.freetext=$j("#courseOfStudiesEditInput").val(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"factfile",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})):this.validateField():jPar.wdk.modalbox.hide()},validateField:function(){jPar.util.validate.textfieldIsEmpty(this.$editInput)?jPar.wdk.forms.showError(this.$editForm.find(".emptyError")):jPar.wdk.forms.hideError(this.$editForm.find(".emptyError"))},formHasErrors:function(){return jPar.util.validate.textfieldIsEmpty(this.$editInput)},handleSuccessResponse:function(e){jPar.app.util.editLayer.saveFreetextValueForReset(this.$editInput),this.setDisplayText(),jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,this.$editForm),jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,$j("#courseOfStudies")),jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(){var e=this.$editInput.val();$j("#courseOfStudies span.factfileValue").text(e)}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{educationLevel:{init:function(){var t=this;this.$editForm=$j("#editEducationLevelModal"),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()})},resetFormOnAbort:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm);var e=this.$editForm.find(".currentSavedValue").val();this.$editForm.find('input[type="radio"]').prop("checked",!1),this.$editForm.find('input[value="'+e+'"]').prop("checked",!0)},save:function(){var r=this,t=this.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(this.$editForm),jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:this.$editForm.attr("action"),data:this.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"factfile",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})},handleSuccessResponse:function(){var e=this.$editForm.find('input[type="radio"]:checked');this.$editForm.find(".currentSavedValue").val(e.val());var t=e.find("~ label").text();$j("#educationLevel span.factfileValue").text(t),this.toggleHigherEducationFields(e),jPar.wdk.modalbox.hide()},toggleHigherEducationFields:function(e){var t=$j("#academicDegree"),a=$j("#courseOfStudies"),r=$j("#editAcademicDegreeModal");!0===e.data("higherEducationLevel")?(t.removeClass("noDisplay"),a.removeClass("noDisplay")):(t.addClass("noDisplay"),t.find("span.factfileValue").text(t.data("textNoEntry")),r.find(".currentSavedValue").val(""),jPar.app.myProfile.editLayer.simpleRadioEdit.resetFormOnAbort(r),a.addClass("noDisplay"),a.find("span.factfileValue").text(a.data("textNoEntry")),$j("#courseOfStudiesEditInput").data("currentSavedValue",""),$j("#courseOfStudies .approvalStatusBox, #editCourseOfStudiesModal .approvalStatusBox").data("shownForSavedValue",!1),jPar.app.util.editLayer.hideApprovalStatus($j("#courseOfStudies .approvalStatusBox, #editCourseOfStudiesModal .approvalStatusBox")),jPar.app.myProfile.editLayer.courseOfStudies.resetFormOnAbort())}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{educationLevelAndTitle:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editEducationLevelAndTitleModal"),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()})},resetFormOnAbort:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm),this.$editForm.find('input[type="radio"]').prop("checked",!1),this.$editForm.find('input[value="'+$j("#currentSavedEducationLevel").val()+'"]').prop("checked",!0),this.$editForm.find('input[value="'+$j("#currentSavedTitle").val()+'"]').prop("checked",!0)},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r.$editForm),jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"factfile",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})},handleSuccessResponse:function(){var e=this.$editForm.find('input[name="education"]:checked'),t=this.$editForm.find('input[name="title"]:checked');$j("#currentSavedEducationLevel").val(e.val()),$j("#currentSavedTitle").val(t.val());var a=e.find("~ label").text(),r=t.find("~ label").text();$j("#educationLevelAndTitle span.factfileValue").text(a+", "+r),jPar.wdk.modalbox.hide()}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{kids:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editChildrenModal"),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),t.$editForm.find('input[name="hasChildren"]').on("change",function(){"true"===$j(this).val()?(t.enableKidsNumberInputs(),$j(".no-touchevents #kidsTotal input").trigger("focus")):t.disableKidsNumberInputs()}),t.$editForm.find("input").on("keyup change",function(){!1===t.formIsValid()&&t.validateForm()}),t.$editForm.find("#kidsTotal input, #kidsAtHome input").on("keydown keyup",function(){var e=$j(this);2<e.val().length&&e.val(e.val().substr(0,2))})},disableKidsNumberInputs:function(){$j("#kidsTotal, #kidsAtHome").addClass("is-disabled"),$j("#kidsTotal input, #kidsAtHome input").prop("disabled",!0).val("")},enableKidsNumberInputs:function(){$j("#kidsTotal, #kidsAtHome").removeClass("is-disabled"),$j("#kidsTotal input, #kidsAtHome input").prop("disabled",!1)},resetFormOnAbort:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm);var e=parseInt($j("#currentSavedKidsTotal").val(),10),t=parseInt($j("#currentSavedKidsAtHome").val(),10);this.$editForm.find('input[name="hasChildren"]').prop("checked",!1),0<e?($j("#childrenYes").prop("checked",!0),this.enableKidsNumberInputs(),$j("#kidsTotal input").val(e),$j("#kidsAtHome input").val(t)):($j("#childrenNo").prop("checked",!0),this.disableKidsNumberInputs())},save:function(){var r=this,t=r.$editForm.find("button.saveElement");if(r.validateForm(),this.formIsValid()){jPar.app.util.editLayer.hideAllErrors(r.$editForm),jPar.wdk.loadingIndicator.show(t);var a=0,i=0;$j("#childrenYes").is(":checked")&&(a=parseInt($j("#kidsTotal input").val(),10),i=parseInt($j("#kidsAtHome input").val(),10)),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:{_csrf:jPar.wdk.security.getCsrfToken(),childrenTotal:a,childrenAtHome:i},success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(a,i),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"factfile",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})}},handleSuccessResponse:function(e,t){this.saveValuesForReset(e,t),this.setDisplayText(e,t),jPar.wdk.modalbox.hide()},saveValuesForReset:function(e,t){$j("#currentSavedKidsTotal").val(e),$j("#currentSavedKidsAtHome").val(t)},setDisplayText:function(e,t){var a=$j("#children"),r=a.data("textNoChildren");1===e?r=a.data("textHasChild"):1<e&&(r=a.data("textHasChildren"));var i=r.replace("##total##",e).replace("##athome##",t);$j(".js-display_kids").text(i)},formIsValid:function(){return!1===$j('#kidsTotal .wdk-styledHintBox[class*=" t-error"]').hasClass("is-visible")&&!1===$j('#kidsAtHome .wdk-styledHintBox[class*=" t-error"]').hasClass("is-visible")},validateForm:function(){var e="true"===this.$editForm.find('input[name="hasChildren"]:checked').val(),t=$j("#kidsTotal"),a=$j("#errorKidsTotal"),r=$j("#kidsAtHome"),i=$j("#errorKidsAtHome"),o=parseInt(t.find("input").val(),10),n=parseInt(r.find("input").val(),10);e&&jPar.util.validate.textfieldIsEmpty(t.find("input"))?jPar.wdk.forms.showError(a):jPar.wdk.forms.hideError(a),e&&jPar.util.validate.textfieldIsEmpty(r.find("input"))?jPar.wdk.forms.showError(i):jPar.wdk.forms.hideError(i);var s=!1===jPar.util.validate.isNumber(t.find("input")),l=!1===jPar.util.validate.isNumber(r.find("input"));e&&s?jPar.wdk.forms.showError(a):jPar.wdk.forms.hideError(a),e&&l?jPar.wdk.forms.showError(i):jPar.wdk.forms.hideError(i),e&&o<n&&(jPar.wdk.forms.showError(a),jPar.wdk.forms.showError(i))}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{language:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editLanguageModal"),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()})},resetFormOnAbort:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm),jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm)},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r.$editForm),jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"factfile",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})},handleSuccessResponse:function(){var e=$j("#language .js-display_languages"),t=this.$editForm.find('input[name="language"]:checked'),a="";jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),0<t.length?t.each(function(e){a+=0!==e?", ":"",a+=$j(this).find("~ label").text()}):a=$j("#language").data("textNoEntry"),e.text(a),jPar.wdk.modalbox.hide()}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{pets:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editPetsModal"),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),t.$editForm.find("#freetextPet").on("keyup change",function(){jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))})},resetFormOnAbort:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm),jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),jPar.app.util.editLayer.resetFreetextForField($j("#freetextPet")),jPar.app.util.editLayer.resetApprovalForField($j("#freetextPet"))},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r.$editForm),jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"factfile",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})},handleSuccessResponse:function(e){var t=this.$editForm.find('input[name="pet"]:checked'),a=$j("#freetextPet");this.saveValuesForReset(a),this.setDisplayText(t,a);var r=$j().add(this.$editForm).add($j("#pets"));jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,r),jPar.wdk.modalbox.hide()},saveValuesForReset:function(e){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),jPar.app.util.editLayer.saveFreetextValueForReset(e)},setDisplayText:function(e,t){var a="";0===e.length&&jPar.util.validate.textfieldIsEmpty(t)?a=$j("#pets").data("textNoEntry"):(e.each(function(e){a+=0!==e?", ":"",a+=$j(this).find("~ label").text()}),!1===jPar.util.validate.textfieldIsEmpty(t)&&(a+=0<e.length?", ":"",a+=t.val())),$j("#factfileCard .js-display_pets").text(a)}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{university:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editUniversityModal"),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),t.$editForm.find("#freetextUniversity").on("keyup change",function(){jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))})},resetFormOnAbort:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm),jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),jPar.app.util.editLayer.resetFreetextForField($j("#freetextUniversity")),jPar.app.util.editLayer.resetApprovalForField($j("#freetextUniversity"))},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r.$editForm),jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"factfile",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})},handleSuccessResponse:function(e){var t=$j("#freetextUniversity");this.saveValuesForReset(t),this.setDisplayText(t);var a=$j().add(this.$editForm).add($j("#university"));jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,a),jPar.wdk.modalbox.hide()},saveValuesForReset:function(e){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),jPar.app.util.editLayer.saveFreetextValueForReset(e)},setDisplayText:function(e){var t="";jPar.util.validate.textfieldIsEmpty(e)?t=$j("#university").data("textNoEntry"):!1===jPar.util.validate.textfieldIsEmpty(e)&&(t+=e.val()),$j("#factfileCard .js-display_university").text(t)}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{myName:{$editForm:null,freetext:null,init:function(){var t=this;this.$editForm=$j("#editMyNameModal"),this.freetext=$j(".js-displayMyNameText").text(),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),t.$editForm.find("#myNameEditInput").on("keyup change",function(e){jPar.util.validate.isNotTabOrShiftKey(e.keyCode)&&t.validateMyNameField(),jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))})},capitalizeFirstLetter:function(){var e=$j("#myNameEditInput"),t=$j.trim(e.val()),a=t[0].toUpperCase(),r=t.slice(1);e.val(a+r)},resetFormOnAbort:function(){jPar.app.util.editLayer.resetFreetextForField($j("#myNameEditInput")),jPar.app.util.editLayer.resetApprovalForField($j("#myNameEditInput")),jPar.app.util.editLayer.hideAllErrors(this.$editForm)},textHasChanged:function(e){return e!==this.freetext},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r.$editForm),this.textHasChanged($j("#myNameEditInput").val())?!1===r.formHasErrors()?(jPar.wdk.loadingIndicator.show(t),r.capitalizeFirstLetter(),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),r.freetext=$j("#myNameEditInput").val(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"header",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})):this.validateMyNameField():jPar.wdk.modalbox.hide()},validateMyNameField:function(){0===this.$editForm.find("#myNameEditInput").val().trim().length?jPar.wdk.forms.showError(this.$editForm.find(".emptyError")):jPar.wdk.forms.hideError(this.$editForm.find(".emptyError"))},formHasErrors:function(){return 0===this.$editForm.find("#myNameEditInput").val().trim().length},handleSuccessResponse:function(e){jPar.app.util.editLayer.saveFreetextValueForReset($j("#myNameEditInput")),this.setDisplayText();var t=$j().add(this.$editForm).add($j(".js-myNameOutputWrapper"));jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,t),jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(){var e=$j("#myNameEditInput").val();$j(".js-displayMyNameText").text(e)}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{occupation:{$editForm:null,freetext:null,init:function(){var t=this;this.$editForm=$j("#editOccupationModal"),this.freetext=$j(".occupationText").text(),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),t.$editForm.find("#occupationEditInput").on("keyup change",function(e){jPar.util.validate.isNotTabOrShiftKey(e.keyCode)&&t.validateOccupationField(),jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))})},capitalizeFirstLetter:function(){var e=$j("#occupationEditInput"),t=$j.trim(e.val()),a=t[0].toUpperCase(),r=t.slice(1);e.val(a+r)},resetFormOnAbort:function(){jPar.app.util.editLayer.resetFreetextForField($j("#occupationEditInput")),jPar.app.util.editLayer.resetApprovalForField($j("#occupationEditInput")),jPar.app.util.editLayer.hideAllErrors(this.$editForm)},textHasChanged:function(e){return e!==this.freetext},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r.$editForm),this.textHasChanged($j("#occupationEditInput").val())?!1===r.formHasErrors()?(jPar.wdk.loadingIndicator.show(t),r.capitalizeFirstLetter(),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),r.freetext=$j("#occupationEditInput").val(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"factfile",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})):this.validateOccupationField():jPar.wdk.modalbox.hide()},validateOccupationField:function(){0===this.$editForm.find("#occupationEditInput").val().length?jPar.wdk.forms.showError(this.$editForm.find(".emptyError")):jPar.wdk.forms.hideError(this.$editForm.find(".emptyError"))},formHasErrors:function(){return 0===this.$editForm.find("#occupationEditInput").val().length},handleSuccessResponse:function(e){jPar.app.util.editLayer.saveFreetextValueForReset($j("#occupationEditInput")),this.setDisplayText();var t=$j().add(this.$editForm).add($j("#occupation"));jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,t),jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(){var e=$j("#occupationEditInput").val();$j(".js-displayOccupationText").text(e)}}}),jPar.app.myProfile=jPar.app.myProfile||{},$j.extend(!0,jPar.app.myProfile,{editLayer:{conf:{$editForm:null},init:function(){var t=this;$j("#myProfilePage").on("click keydown",".js-openEditLayer",function(e){jPar.util.validate.isMouseclickEnterOrSpaceKey(e.keyCode)&&(e.preventDefault(),t.openEditLayer(e))}),$j(document).on("wdk:modalbox:isHidden",function(e){t.resetOpenEditForm(e.detail)}),t.myName.init(),t.occupation.init(),t.personalStatement.init(),t.whatMakesMeSpecial.init(),t.factfileCardInit(),t.leisureCardInit(),t.shotfactsCardInit(),t.similarities.init()},factfileCardInit:function(){this.simpleRadioEdit.init(),this.educationLevelAndTitle.init(),this.language.init(),this.kids.init(),this.pets.init(),this.university.init(),this.educationLevel.init(),this.courseOfStudies.init()},shotfactsCardInit:function(){this.friendsDescribeMe.init(),this.bestLifeSkills.init()},leisureCardInit:function(){this.leisure.init(),this.interests.init(),this.sportType.init(),this.sportsLikeToWatchType.init(),this.holiday.init(),this.musicalTaste.init(),this.favoriteCuisine.init(),this.favoriteTVShowsAndMovies.init(),this.favoriteBooks.init()},openEditLayer:function(e){var t=$j(e.currentTarget).data("modalboxSelector");jPar.wdk.modalbox.show({modalboxId:t.replace("#","")});var a=$j(t).find("textarea");if(0<a.length){var r=a.data("currentSavedValue").replace(/<br \/>/g,"\n");a.val(jPar.wdk.security.htmlEntitiesToChars(r))}jPar.app.myProfile.profileMenue.close(),jPar.app.util.editLayer.setFocusToMainField(t)},resetOpenEditForm:function(e){var t=e.$modalboxObj,a=e.$modalboxObj.attr("id"),r=e.$modalboxObj.hasClass("editSimilarities");-1<a.search(/^edit(.*)Modal$/)&&("editOccupationModal"===a?this.occupation.resetFormOnAbort():"editMyNameModal"===a?this.myName.resetFormOnAbort():"editPersonalStatementModal"===a?this.personalStatement.resetFormOnAbort():"editWhatMakesMeSpecialModal"===a?this.whatMakesMeSpecial.resetFormOnAbort():"editEducationLevelAndTitleModal"===a?this.educationLevelAndTitle.resetFormOnAbort():"editLanguageModal"===a?this.language.resetFormOnAbort():"editPetsModal"===a?this.pets.resetFormOnAbort():"editChildrenModal"===a?this.kids.resetFormOnAbort():"editReligionModal"===a?this.simpleRadioEdit.resetFormOnAbort($j(t)):"editEthnicityModal"===a?this.simpleRadioEdit.resetFormOnAbort($j(t)):"editPoliticalViewModal"===a?this.simpleRadioEdit.resetFormOnAbort($j(t)):$j(t).hasClass("simpleRadioEdit")?this.simpleRadioEdit.resetFormOnAbort($j(t)):"editEducationLevelModal"===a?this.educationLevel.resetFormOnAbort():"editCourseOfStudiesModal"===a?this.courseOfStudies.resetFormOnAbort():"editFriendsDescribeMeModal"===a?this.friendsDescribeMe.resetFormOnAbort():"editBestLifeSkillsModal"===a?this.bestLifeSkills.resetFormOnAbort():"editLeisureModal"===a?this.leisure.resetFormOnAbort():"editInterestsModal"===a?this.interests.resetFormOnAbort():"editSportTypeModal"===a?this.sportType.resetFormOnAbort():"editSportsLikeToWatchTypeModal"===a?this.sportsLikeToWatchType.resetFormOnAbort():"editHolidayModal"===a?this.holiday.resetFormOnAbort():"editMusicalTasteModal"===a?this.musicalTaste.resetFormOnAbort():"editCuisineModal"===a?this.favoriteCuisine.resetFormOnAbort():"editFavoriteTVShowsAndMoviesModal"===a?this.favoriteTVShowsAndMovies.resetFormOnAbort():"editFavoriteBooksModal"===a&&this.favoriteBooks.resetFormOnAbort(),r&&this.similarities.resetFormOnAbort($j(t)))}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{favoriteBooks:{$profileElement:null,$displayText:null,displayText:null,$editForm:null,$textInput:null,init:function(){var t=this;this.$profileElement=$j("#favoriteBooks"),this.$displayText=$j(".editFavoriteBooksText"),this.displayText=this.$displayText.text(),this.$editForm=$j("#editFavoriteBooksModal"),this.$textInput=$j("#favoriteBooksInput"),0<this.$editForm.length&&(t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),t.$textInput.on("keyup change",function(){jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))}))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetFreetextForField(this.$textInput),jPar.app.util.editLayer.resetApprovalForField(this.$textInput)},textHasChanged:function(e){return e!==this.displayText},save:function(){var r=this,t=r.$editForm.find("button.saveElement");this.textHasChanged($j("#instrumentInput").val())?(jPar.app.util.editLayer.hideAllErrors(r.$editForm),jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),r.displayText=r.$textInput.val(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"entertainment",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})):jPar.wdk.modalbox.hide()},handleSuccessResponse:function(e){jPar.app.util.editLayer.saveFreetextValueForReset(this.$textInput),this.setDisplayText(this.$textInput);var t=$j().add(this.$editForm).add(this.$profileElement);jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,t),jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(e){jPar.util.validate.textfieldIsEmpty(e)?this.$displayText.text(this.$textInput.data("textNoEntry")):this.$displayText.text(e.val())}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{favoriteCuisine:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editCuisineModal"),0<this.$editForm.length&&(t.$editForm.find("input[type=checkbox]").on("change",function(){t.updateErrorsAndHints()}),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}))},updateErrorsAndHints:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm),this.validateForm()},validateForm:function(){0===this.$editForm.find("input[type=checkbox]:checked").length?jPar.app.util.editLayer.showStickyHint($j("#favoriteCuisine_empty")):jPar.app.util.editLayer.hideStickyHint($j("#favoriteCuisine_empty"))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),this.updateErrorsAndHints()},save:function(){var r=this,t=r.$editForm.find("button.saveElement");r.validateForm(),r.formIsValid()&&(jPar.wdk.loadingIndicator.show(t),jPar.app.util.editLayer.hideAllErrors(r.$editForm),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?r.handleSuccessResponse():(jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e),r.scrollToError())},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a),r.scrollToError()}}))},formIsValid:function(){return!1===$j("#favoriteCuisine_empty").hasClass("is-visible")},handleSuccessResponse:function(){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),this.setDisplayText(),jPar.wdk.brands.forBrands(["ep"])&&jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(){var e=this.$editForm.find("input[type=checkbox]:checked"),t="";0<e.length?e.each(function(e){t+=0!==e?", ":"",t+=$j(this).find("~ label").text()}):t=$j("#favoriteCuisine").data("textNoEntry"),$j("#favoriteCuisine p").text(t)},scrollToError:function(){if(0<this.$editForm.find('.scrollingContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var e=this.$editForm.find(".scrollingContent").prop("scrollHeight");this.$editForm.find(".scrollingContent").animate({scrollTop:e},300)}}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{favoriteTVShowsAndMovies:{$profileElement:null,$displayText:null,displayText:null,$editForm:null,$textInput:null,init:function(){var t=this;this.$profileElement=$j("#favoriteTVShowsAndMovies"),this.$displayText=$j(".editFavoriteTVShowsAndMoviesText"),this.displayText=this.$displayText.text(),this.$editForm=$j("#editFavoriteTVShowsAndMoviesModal"),this.$textInput=$j("#favoriteTVShowsAndMoviesInput"),0<this.$editForm.length&&(t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),t.$textInput.on("keyup change",function(){jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))}))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetFreetextForField(this.$textInput),jPar.app.util.editLayer.resetApprovalForField(this.$textInput)},textHasChanged:function(e){return e!==this.displayText},save:function(){var r=this,t=r.$editForm.find("button.saveElement");this.textHasChanged($j("#instrumentInput").val())?(jPar.app.util.editLayer.hideAllErrors(r.$editForm),jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),r.displayText=r.$textInput.val(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"entertainment",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})):jPar.wdk.modalbox.hide()},handleSuccessResponse:function(e){jPar.app.util.editLayer.saveFreetextValueForReset(this.$textInput),this.setDisplayText(this.$textInput);var t=$j().add(this.$editForm).add(this.$profileElement);jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,t),jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(e){jPar.util.validate.textfieldIsEmpty(e)?this.$displayText.text(this.$textInput.data("textNoEntry")):this.$displayText.text(e.val())}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{holiday:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editHolidayModal"),0<this.$editForm.length&&(t.$editForm.find("input[type=checkbox]").on("change",function(){t.updateErrorsAndHints()}),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}))},updateErrorsAndHints:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm),this.validateForm()},validateForm:function(){0===this.$editForm.find("input[type=checkbox]:checked").length?jPar.app.util.editLayer.showStickyHint($j("#holidayHint_empty")):jPar.app.util.editLayer.hideStickyHint($j("#holidayHint_empty"))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),this.updateErrorsAndHints()},save:function(){var r=this,t=r.$editForm.find("button.saveElement");r.validateForm(),r.formIsValid()&&(jPar.wdk.loadingIndicator.show(t),jPar.app.util.editLayer.hideAllErrors(r.$editForm),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?r.handleSuccessResponse():(jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e),r.scrollToError())},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a),r.scrollToError()}}))},formIsValid:function(){return!1===$j("#holidayHint_empty").hasClass("is-visible")},handleSuccessResponse:function(){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),this.setDisplayText(),jPar.wdk.brands.forBrands(["ep"])&&jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(){var e=this.$editForm.find("input[type=checkbox]:checked"),t="";e.each(function(e){t+=0!==e?", ":"",t+=$j(this).find("~ label").text()}),$j("#holiday p").text(t)},scrollToError:function(){if(0<this.$editForm.find('.scrollingContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var e=this.$editForm.find(".scrollingContent").prop("scrollHeight");this.$editForm.find(".scrollingContent").animate({scrollTop:e},300)}}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{interests:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editInterestsModal"),0<this.$editForm.length&&(t.validateForm(),t.$editForm.find("input[type=checkbox]").on("change",function(){t.updateErrorsAndHints()}),t.$editForm.find("#freetextInterest").on("keyup change",function(){t.updateErrorsAndHints(),jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))}),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}))},updateErrorsAndHints:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm),this.validateForm()},validateForm:function(){this.handleEmpty(),this.handleMaximumReached()},handleEmpty:function(){var e=0===this.$editForm.find("input[type=checkbox]:checked").length,t=$j("#freetextInterest"),a=jPar.util.validate.textfieldIsEmpty(t);!0===e&&!0===a?jPar.app.util.editLayer.showStickyHint($j("#interestHint_empty")):jPar.app.util.editLayer.hideStickyHint($j("#interestHint_empty"))},handleMaximumReached:function(){var e=this.getCheckedInterests(),t=$j("#freetextInterest"),a=!1===jPar.util.validate.textfieldIsEmpty(t);!1===a&&6===e.length||!0===a&&5===e.length?(jPar.app.util.editLayer.showStickyHint($j("#interestHint_allSelected")),this.$editForm.find("input[type=checkbox]").each(function(){var e=!$j(this).is(":checked");$j(this).prop("disabled",e)}),t.prop("disabled",!1===a)):(jPar.app.util.editLayer.hideStickyHint($j("#interestHint_allSelected")),this.$editForm.find("input[type=checkbox]").prop("disabled",!1),t.prop("disabled",!1))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),jPar.app.util.editLayer.resetFreetextForField($j("#freetextInterest")),jPar.app.util.editLayer.resetApprovalForField($j("#freetextInterest")),this.updateErrorsAndHints()},save:function(){var r=this,t=r.$editForm.find("button.saveElement");r.validateForm(),r.formIsValid()&&(jPar.wdk.loadingIndicator.show(t),jPar.app.util.editLayer.hideAllErrors(r.$editForm),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?r.handleSuccessResponse(e):(jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e),r.scrollToError())},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a),r.scrollToError()}}))},formIsValid:function(){return!1===$j("#interestHint_empty").hasClass("is-visible")},handleSuccessResponse:function(e){this.saveValuesForReset(),this.setDisplayText();var t=$j().add(this.$editForm).add($j("#interests"));jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,t),jPar.wdk.brands.forBrands(["ep"])&&jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},saveValuesForReset:function(){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),jPar.app.util.editLayer.saveFreetextValueForReset($j("#freetextInterest"))},setDisplayText:function(){var e=this.getCheckedInterests(),t=$j("#freetextInterest"),a="";0===e.length&&jPar.util.validate.textfieldIsEmpty(t)?a=$j("#interests").data("textNoEntry"):(e.each(function(e){a+=0!==e?", ":"",a+=$j(this).find("~ label").text()}),!1===jPar.util.validate.textfieldIsEmpty(t)&&(a+=0<e.length?", ":"",a+=t.val())),$j("#interests p").text(a)},scrollToError:function(){if(0<this.$editForm.find('.scrollingContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var e=this.$editForm.find(".scrollingContent").prop("scrollHeight");this.$editForm.find(".scrollingContent").animate({scrollTop:e},300)}},getCheckedInterests:function(){return this.$editForm.find("input[type=checkbox]:checked")}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{leisure:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editLeisureModal"),0<this.$editForm.length&&(t.handleMaximumReached(),t.$editForm.find("input[type=checkbox]").on("change",function(){t.updateErrorsAndHints()}),t.$editForm.find("#freetextLeisure").on("keyup change",function(){t.updateErrorsAndHints(),jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))}),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}))},updateErrorsAndHints:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm),this.validateForm(),this.handleMaximumReached()},validateForm:function(){var e=this.getCheckedLeisures();0===e.length&&jPar.util.validate.textfieldIsEmpty($j("#freetextLeisure"))||6<e.length?jPar.app.util.editLayer.showStickyHint($j("#leisureHint_empty")):jPar.app.util.editLayer.hideStickyHint($j("#leisureHint_empty"))},formIsValid:function(){return!1===$j("#leisureHint_empty").hasClass("is-visible")},handleMaximumReached:function(){var e=this.getCheckedLeisures(),t=$j("#freetextLeisure"),a=!1===jPar.util.validate.textfieldIsEmpty(t);!1===a&&6===e.length||!0===a&&5===e.length?(jPar.app.util.editLayer.showStickyHint($j("#leisureHint_allSelected")),this.$editForm.find("input[type=checkbox]").each(function(){var e=!$j(this).is(":checked");$j(this).prop("disabled",e)}),t.prop("disabled",!1===a)):(jPar.app.util.editLayer.hideStickyHint($j("#leisureHint_allSelected")),this.$editForm.find("input[type=checkbox]").prop("disabled",!1),t.prop("disabled",!1))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),jPar.app.util.editLayer.resetFreetextForField($j("#freetextLeisure")),jPar.app.util.editLayer.resetApprovalForField($j("#freetextLeisure")),this.updateErrorsAndHints()},save:function(){var r=this,t=r.$editForm.find("button.saveElement");r.validateForm(),r.formIsValid()&&(jPar.wdk.loadingIndicator.show(t),jPar.app.util.editLayer.hideAllErrors(r.$editForm),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?r.handleSuccessResponse(e):(jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e),r.scrollToError())},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a),r.scrollToError()}}))},handleSuccessResponse:function(e){this.saveValuesForReset(),this.setDisplayText(),jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,$j("#editLeisureModal")),jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,$j("#leisure")),jPar.wdk.brands.forBrands(["ep"])&&jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},saveValuesForReset:function(){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),jPar.app.util.editLayer.saveFreetextValueForReset($j("#freetextLeisure"))},setDisplayText:function(){var e=this.getCheckedLeisures(),t=$j("#freetextLeisure"),a="";e.each(function(e){a+=0!==e?", ":"",a+=$j(this).find("~ label").text()}),!1===jPar.util.validate.textfieldIsEmpty(t)&&(a+=0<e.length?", ":"",a+=t.val()),$j("#leisure p").text(a)},scrollToError:function(){if(0<this.$editForm.find('.scrollingContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var e=this.$editForm.find(".scrollingContent").prop("scrollHeight");this.$editForm.find(".scrollingContent").animate({scrollTop:e},300)}},getCheckedLeisures:function(){return this.$editForm.find("input[type=checkbox]:checked")}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{musicalTaste:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editMusicalTasteModal"),t.$editForm.length&&(t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),t.$editForm.find("#freetextMusicalTaste").on("keyup change",function(){jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))}))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),jPar.app.util.editLayer.resetFreetextForField($j("#freetextMusicalTaste")),jPar.app.util.editLayer.resetApprovalForField($j("#freetextMusicalTaste")),jPar.app.util.editLayer.hideAllErrors(this.$editForm)},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.wdk.loadingIndicator.show(t),jPar.app.util.editLayer.hideAllErrors(r.$editForm),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"entertainment",action:"section_edited"})):(jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e),r.scrollToError())},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a),r.scrollToError()}})},handleSuccessResponse:function(e){this.saveValuesForReset(),this.setDisplayText();var t=$j().add(this.$editForm).add($j("#musicalTaste"));jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,t),jPar.wdk.brands.forBrands(["ep"])&&jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},saveValuesForReset:function(){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),jPar.app.util.editLayer.saveFreetextValueForReset($j("#freetextMusicalTaste"))},setDisplayText:function(){var e=this.$editForm.find("input[type=checkbox]:checked"),t=$j("#freetextMusicalTaste"),a="";0===e.length&&jPar.util.validate.textfieldIsEmpty(t)?a=$j("#musicalTaste").data("textNoEntry"):(e.each(function(e){a+=0!==e?", ":"",a+=$j(this).find("~ label").text()}),!1===jPar.util.validate.textfieldIsEmpty(t)&&(a+=0<e.length?", ":"",a+=t.val())),$j("#musicalTaste .editFavoriteMusicText").text(a)},scrollToError:function(){if(0<this.$editForm.find('.scrollingContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var e=this.$editForm.find(".scrollingContent").prop("scrollHeight");this.$editForm.find(".scrollingContent").animate({scrollTop:e},300)}}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{sportType:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editSportTypeModal"),0<this.$editForm.length&&(t.$editForm.find("input[type=checkbox]").on("change",function(){t.toggleNoEntryState($j(this)),t.updateErrors()}),t.$editForm.find("#freetextSportType").on("keyup change",function(){t.toggleNoEntryState($j(this)),t.updateErrors(),jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))}),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}))},updateErrors:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm),this.validateForm()},toggleNoEntryState:function(e){var t=$j("#sportType_FAVORITE_SPORTS_NO"),a=this.$editForm.find("#freetextSportType");e.is(t)&&t.is(":checked")?(this.$editForm.find("input[type=checkbox]").not(t).prop("checked",!1),a.val(""),jPar.wdk.forms.textElement.updateCounter(a)):t.prop("checked",!1)},validateForm:function(){0===this.$editForm.find("input[type=checkbox]:checked").length&&jPar.util.validate.textfieldIsEmpty($j("#freetextSportType"))?jPar.app.util.editLayer.showStickyHint($j("#sportTypeHint_empty")):jPar.app.util.editLayer.hideStickyHint($j("#sportTypeHint_empty"))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),jPar.app.util.editLayer.resetFreetextForField($j("#freetextSportType")),jPar.app.util.editLayer.resetApprovalForField($j("#freetextSportType")),this.updateErrors()},save:function(){var r=this,t=r.$editForm.find("button.saveElement");r.validateForm(),r.formIsValid()&&(jPar.wdk.loadingIndicator.show(t),jPar.app.util.editLayer.hideAllErrors(r.$editForm),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?r.handleSuccessResponse(e):(jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e),r.scrollToError())},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a),r.scrollToError()}}))},formIsValid:function(){return!1===$j("#sportTypeHint_empty").hasClass("is-visible")},handleSuccessResponse:function(e){this.saveValuesForReset(),this.setDisplayText();var t=$j().add(this.$editForm).add($j("#sportType"));jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,t),jPar.wdk.brands.forBrands(["ep"])&&jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},saveValuesForReset:function(){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),jPar.app.util.editLayer.saveFreetextValueForReset($j("#freetextSportType"))},setDisplayText:function(){var e=this.$editForm.find("input[type=checkbox]:checked"),t=$j("#freetextSportType"),a="";e.each(function(e){a+=0!==e?", ":"",a+=$j(this).find("~ label").text()}),!1===jPar.util.validate.textfieldIsEmpty(t)&&(a+=0<e.length?", ":"",a+=t.val()),$j("#sportType p").text(a)},scrollToError:function(){if(0<this.$editForm.find('.scrollingContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var e=this.$editForm.find(".scrollingContent").prop("scrollHeight");this.$editForm.find(".scrollingContent").animate({scrollTop:e},300)}}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{sportsLikeToWatchType:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editSportsLikeToWatchTypeModal"),0<this.$editForm.length&&(t.$editForm.find("input[type=checkbox]").on("change",function(){t.toggleNoEntryState($j(this)),t.updateErrors()}),t.$editForm.find("#freetextSportsLikeToWatchType").on("keyup change",function(){t.toggleNoEntryState($j(this)),t.updateErrors(),jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))}),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}))},updateErrors:function(){jPar.app.util.editLayer.hideAllErrors(this.$editForm),this.validateForm()},toggleNoEntryState:function(e){var t=$j("#sportsLikeToWatchType_FAVORITE_SPORTS_NO"),a=this.$editForm.find("#freetextSportsLikeToWatchType");e.is(t)&&t.is(":checked")?(this.$editForm.find("input[type=checkbox]").not(t).prop("checked",!1),a.val(""),jPar.wdk.forms.textElement.updateCounter(a)):t.prop("checked",!1)},validateForm:function(){0===this.$editForm.find("input[type=checkbox]:checked").length&&jPar.util.validate.textfieldIsEmpty($j("#freetextSportsLikeToWatchType"))?jPar.app.util.editLayer.showStickyHint($j("#sportsLikeToWatchTypeHint_empty")):jPar.app.util.editLayer.hideStickyHint($j("#sportsLikeToWatchTypeHint_empty"))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),jPar.app.util.editLayer.resetFreetextForField($j("#freetextSportsLikeToWatchType")),jPar.app.util.editLayer.resetApprovalForField($j("#freetextSportsLikeToWatchType")),this.updateErrors()},save:function(){var r=this,t=r.$editForm.find("button.saveElement");r.validateForm(),r.formIsValid()&&(jPar.wdk.loadingIndicator.show(t),jPar.app.util.editLayer.hideAllErrors(r.$editForm),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?r.handleSuccessResponse(e):(jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e),r.scrollToError())},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a),r.scrollToError()}}))},formIsValid:function(){return!1===$j("#sportsLikeToWatchTypeHint_empty").hasClass("is-visible")},handleSuccessResponse:function(e){this.saveValuesForReset(),this.setDisplayText();var t=$j().add(this.$editForm).add($j("#sportsLikeToWatchType"));jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,t),jPar.wdk.brands.forBrands(["ep"])&&jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},saveValuesForReset:function(){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),jPar.app.util.editLayer.saveFreetextValueForReset($j("#freetextSportsLikeToWatchType"))},setDisplayText:function(){var e=this.$editForm.find("input[type=checkbox]:checked"),t=$j("#freetextSportsLikeToWatchType"),a="";e.each(function(e){a+=0!==e?", ":"",a+=$j(this).find("~ label").text()}),!1===jPar.util.validate.textfieldIsEmpty(t)&&(a+=0<e.length?", ":"",a+=t.val()),$j("#sportsLikeToWatchType p").text(a)},scrollToError:function(){if(0<this.$editForm.find('.scrollingContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var e=this.$editForm.find(".scrollingContent").prop("scrollHeight");this.$editForm.find(".scrollingContent").animate({scrollTop:e},300)}}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{personalStatement:{$editForm:null,freetext:null,init:function(){var t=this;this.$editForm=$j("#editPersonalStatementModal"),this.freetext=$j(".personalStatementText").text(),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),t.$editForm.find("#personalStatementEditInput").on("keyup",function(){jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox"))})},resetFormOnAbort:function(){jPar.app.util.editLayer.resetFreetextForField($j("#personalStatementEditInput")),jPar.app.util.editLayer.resetApprovalForField($j("#personalStatementEditInput")),jPar.app.util.editLayer.hideAllErrors(this.$editForm)},textHasChanged:function(e){return e!==this.freetext},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r.$editForm),this.textHasChanged($j("#personalStatementEditInput").val())?(jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),r.freetext=$j("#personalStatementEditInput").val(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"personal_quote",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})):jPar.wdk.modalbox.hide()},handleSuccessResponse:function(e){jPar.app.util.editLayer.saveFreetextValueForReset($j("#personalStatementEditInput")),this.setDisplayText();var t=$j().add(this.$editForm).add($j("#personalStatementCard"));jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,t),jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(){var e=jPar.wdk.security.sanitizeStringForHtml($j("#personalStatementEditInput").val().trim()),t=$j("#personalStatementCard .personalStatementText");if(""!==e){var a=jPar.app.util.replaceLinebreakWithBr(e);t.html(a)}else t.html($j("#personalStatementCard").find(".personalStatementText").data("textNoEntry"))}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{bestLifeSkills:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editBestLifeSkillsModal"),0<this.$editForm.length&&(t.handleMaximumReached(),t.$editForm.find("input[type=checkbox]").on("change",function(){t.handleMaximumReached()}),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}))},handleMaximumReached:function(){5<=this.$editForm.find('input[name="bestLifeSkills"]:checked').length?(jPar.app.util.editLayer.showStickyHint($j("#bestLifeSkillsHint_allSelected")),this.$editForm.find("input[type=checkbox]").each(function(){var e=!$j(this).is(":checked");$j(this).prop("disabled",e)})):(jPar.app.util.editLayer.hideStickyHint($j("#bestLifeSkillsHint_allSelected")),this.$editForm.find("input[type=checkbox]").prop("disabled",!1))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),jPar.app.util.editLayer.hideAllErrors(this.$editForm),jPar.app.myProfile.editLayer.bestLifeSkills.handleMaximumReached()},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.wdk.loadingIndicator.show(t),jPar.app.util.editLayer.hideAllErrors(r.$editForm),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?r.handleSuccessResponse():(jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e),r.scrollToError())},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a),r.scrollToError()}})},handleSuccessResponse:function(){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),this.setDisplayText(),jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(){$j("#shortFactBestLifeSkills .bestLifeSkillsList").empty(),$j("#bestLifeSkillsNoEntry").removeClass("is-visible"),this.$editForm.find('input[type="checkbox"]:checked').each(function(){var e=$j(this).val().trim(),t=$j(this).parent().find("label").text().trim(),a=$j('<li><span class="display_bestLifeSkills'.concat(e,'">').concat(t,"</span></li>"));$j("#shortFactBestLifeSkills .bestLifeSkillsList").append(a)}),0===$j("#shortFactBestLifeSkills .bestLifeSkillsList li").length&&$j("#bestLifeSkillsNoEntry").addClass("is-visible")},scrollToError:function(){if(0<this.$editForm.find('.scrollingContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var e=this.$editForm.find(".scrollingContent").prop("scrollHeight");this.$editForm.find(".scrollingContent").animate({scrollTop:e},300)}}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{friendsDescribeMe:{$editForm:null,init:function(){var t=this;this.$editForm=$j("#editFriendsDescribeMeModal"),0<this.$editForm.length&&(t.handleMaximumReached(),t.$editForm.find("input[type=checkbox]").on("change",function(){t.handleMaximumReached()}),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}))},handleMaximumReached:function(){5<=this.$editForm.find('input[name="howMyFriendsDescribeMe"]:checked').length?(jPar.app.util.editLayer.showStickyHint($j("#friendsDescribeMeHint_allSelected")),this.$editForm.find("input[type=checkbox]").each(function(){var e=!$j(this).is(":checked");$j(this).prop("disabled",e)})):(jPar.app.util.editLayer.hideStickyHint($j("#friendsDescribeMeHint_allSelected")),this.$editForm.find("input[type=checkbox]").prop("disabled",!1))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm(this.$editForm),jPar.app.util.editLayer.hideAllErrors(this.$editForm),jPar.app.myProfile.editLayer.friendsDescribeMe.handleMaximumReached()},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.wdk.loadingIndicator.show(t),jPar.app.util.editLayer.hideAllErrors(r.$editForm),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?r.handleSuccessResponse():(jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e),r.scrollToError())},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a),r.scrollToError()}})},handleSuccessResponse:function(){jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editForm),this.setDisplayText(),jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(){$j("#shortFactFriendsDescribeMe .friendsDescribeMeList").empty(),$j("#friendsDescribeMeNoEntry").removeClass("is-visible"),this.$editForm.find('input[type="checkbox"]:checked').each(function(){var e=$j(this).val().trim(),t=$j(this).parent().find("label").text().trim(),a=$j('<li><span class="display_friendsDescribe'.concat(e,'">').concat(t,"</span></li>"));$j("#shortFactFriendsDescribeMe .friendsDescribeMeList").append(a)}),0===$j("#shortFactFriendsDescribeMe .friendsDescribeMeList li").length&&$j("#friendsDescribeMeNoEntry").addClass("is-visible")},scrollToError:function(){if(0<this.$editForm.find('.scrollingContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var e=this.$editForm.find(".scrollingContent").prop("scrollHeight");this.$editForm.find(".scrollingContent").animate({scrollTop:e},300)}}}}),jPar.app.myProfile=jPar.app.myProfile||{},$j.extend(!0,jPar.app.myProfile.editLayer,{similarities:{init:function(){var t=this;$j(".editSimilarities").on("submit",function(e){e.preventDefault(),t.save($j(this))}),0<$j(".showSimilaritiesWithTileDesign").length&&$j('.editModalLayer .wdk-form-toggles input[type="checkbox"]').on("change",function(){t.toggleIsSelected($j(this))})},resetFormOnAbort:function(e){0<$j(".showSimilaritiesWithTileDesign").length?e.find("input[type=checkbox]").each(function(){var e=Boolean($j(this).data("currentSavedStatus"));$j(this).prop("checked",e),!0===$j(this).prop("checked")?$j(this).parents(".similarityItemCard").addClass("is-selected"):$j(this).parents(".similarityItemCard").removeClass("is-selected")}):jPar.app.util.editLayer.resetCheckboxesInForm(e),jPar.app.util.editLayer.hideAllErrors(e)},trackLifestyleChanges:function(e){var t=e.find("ul").data("categoryName"),a=[];e.find("ul li input:checked").parents("li").each(function(){a.push($j(this).data("itemName"))});var r=[];$j('#similaritiesCard ul[data-category-name="'.concat(t,'"] li:not(.defaultCategoryIcon)')).each(function(){r.push($j(this).data("itemName"))});var i=a.filter(function(e){return!r.includes(e)}),o=r.filter(function(e){return!a.includes(e)});0<o.length&&(o=o.toString(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"".concat(t),action:"remove_item",targetId:"".concat(o)})),0<i.length&&(i=i.toString(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"".concat(t),action:"add_item",targetId:"".concat(i)}))},save:function(a){var t=this;jPar.wdk.loadingIndicator.show(a.find("button.saveElement"));var e=a.attr("action"),r=jPar.wdk.security.getCsrfToken(),i=a.serializeArray(),o=[];$j.each(i,function(e,t){o.push(parseInt(t.name))}),jPar.app.util.editLayer.hideAllErrors(a),$j.ajax({type:"POST",url:e,contentType:"application/json",data:JSON.stringify(o),headers:{"X-CSRF-TOKEN":r},success:function(e){t.trackLifestyleChanges(a),jPar.wdk.loadingIndicator.hide(a.find("button.saveElement")),!0===e.success?(jPar.wdk.toast.show("#similaritiesSaved"),jPar.app.util.editLayer.saveCheckboxValuesForReset(a),0<$j(".showSimilaritiesWithTileDesign").length?t.renderUpdatedCategory(a):t.setDisplayTextDeprecated(a),jPar.wdk.modalbox.hide(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"lifestyle",action:"section_edited"})):(jPar.app.util.editLayer.handleInvalidResponse(a,e),jPar.app.util.editLayer.scrollToError(a))},error:function(e,t){jPar.wdk.loadingIndicator.hide(a.find("button.saveElement")),jPar.app.util.editLayer.handleNetworkErrorOnSubmit(a,t),jPar.app.util.editLayer.scrollToError(a)}})},toggleIsSelected:function(e){e.parents(".similarityItemCard").hasClass("is-selected")?e.parents(".similarityItemCard").removeClass("is-selected"):e.parents(".similarityItemCard").addClass("is-selected")},renderUpdatedCategory:function(e){var t=e.find("input[type=checkbox]:checked"),a=e.find(".similarityContainer").attr("data-items-total-number"),r=e.data("similaritiesCategory"),i="",o=function(){i+='<li class="'.concat(r,' similarityItemCard defaultCategoryIcon">'),i+='<div class="similarityItemCardContent bg-icon_add_circle_filled">',i+='<i class="bgIcon bg-'.concat(e.attr("data-category-default-icon-name"),'"></i>'),i+="</div>",i+="</li>"};0<t.length?(t.each(function(){i+='<li class="'.concat(r,' similarityItemCard" data-item-name="').concat($j(this).parents(".similarityItemCard").attr("data-item-name"),'">'),i+='<div class="similarityItemCardContent">',i+='<i class="'.concat($j(this).parents(".similarityItemCardContent").find("i").attr("class"),'"></i>'),i+='<span class="similarityItemName">'.concat($j(this).find("~ label").text(),"</span>"),i+="</div>",i+="</li>"}),a-t.length!=0&&o()):o(),$j("#".concat(r," ul li")).remove(),$j("#".concat(r," ul")).append(i)},setDisplayTextDeprecated:function(e){var t=e.find("input[type=checkbox]:checked"),a=e.data("similaritiesCategory"),r="";0<t.length?t.each(function(){r+='<li data-item-name="'.concat($j(this).parents("li").attr("data-item-name"),'">'),r+=$j(this).find("~ label").text(),r+="</li>"}):(r+='<li class="defaultCategoryIcon">',r+=$j("#".concat(a)).data("textNoEntry"),r+="</li>"),$j("#".concat(a," ul li")).remove(),$j("#".concat(a," ul")).append(r)}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{simpleRadioEdit:{init:function(){var t=this,e=$j("form.simpleRadioEdit");e.on("change",function(){jPar.wdk.forms.hideError($j(this).find(".formNotValid"))}),e.on("submit",function(e){e.preventDefault(),t.validateForm($j(this))})},validateForm:function(e){1===e.find('input[type="radio"]:checked').length?this.save(e):jPar.wdk.forms.showError(e.find(".formNotValid"))},resetFormOnAbort:function(e){jPar.app.util.editLayer.hideAllErrors(e);var t=e.find(".currentSavedValue").val();e.find('input[type="radio"]').prop("checked",!1),e.find('input[value="'+t+'"]').prop("checked",!0)},save:function(r){var t=this,a=r.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r),jPar.wdk.loadingIndicator.show(a),$j.ajax({type:"POST",url:r.attr("action"),data:r.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(a),jPar.app.util.editLayer.resultViewIsSuccess(e)?(t.handleSuccessResponse(r),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"factfile",action:"section_edited"})):jPar.app.util.editLayer.handleInvalidResponse(r,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r,e,t,a)}})},handleSuccessResponse:function(e){var t=e.find('input[type="radio"]:checked'),a=e.find(".currentSavedValue"),r="";a.val(t.val());var i=t.find("~ label").is("[data-special-text-to-show]");r=i?t.find("~ label").data("specialTextToShow"):t.find("~ label").text();var o=a.data("updatedField");$j(o).each(function(){$j(this).text(r)}),jPar.wdk.modalbox.hide(),jPar.app.myProfile.updateProfileCompletion()}}}),jPar.app.myProfile.editLayer=jPar.app.myProfile.editLayer||{},$j.extend(!0,jPar.app.myProfile.editLayer,{whatMakesMeSpecial:{$editForm:null,freetext:null,init:function(){var t=this;this.$editForm=$j("#editWhatMakesMeSpecialModal"),this.freetext=$j(".whatMakesMeSpecialText").text(),t.$editForm.on("submit",function(e){e.preventDefault(),t.save()}),t.$editForm.find("#whatMakesMeSpecialEditInput").on("keyup change",function(){jPar.app.util.editLayer.hideApprovalStatus(t.$editForm.find(".approvalStatusBox")),t.validateForm()})},textHasChanged:function(e){return e!==this.freetext},resetFormOnAbort:function(){jPar.app.util.editLayer.resetFreetextForField($j("#whatMakesMeSpecialEditInput")),jPar.app.util.editLayer.resetApprovalForField($j("#whatMakesMeSpecialEditInput")),jPar.app.util.editLayer.hideAllErrors(this.$editForm)},save:function(){var r=this,t=r.$editForm.find("button.saveElement");jPar.app.util.editLayer.hideAllErrors(r.$editForm),r.removeLineBreaksAndWhitespace(),r.validateForm(),this.textHasChanged($j("#whatMakesMeSpecialEditInput").val())?!1===r.formHasErrors()&&(jPar.wdk.loadingIndicator.show(t),$j.ajax({type:"POST",url:r.$editForm.attr("action"),data:r.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),jPar.app.util.editLayer.resultViewIsSuccess(e)?(r.handleSuccessResponse(e),r.freetext=$j("#whatMakesMeSpecialEditInput").val()):jPar.app.util.editLayer.handleInvalidResponse(r.$editForm,e)},error:function(e,t,a){jPar.app.util.editLayer.handleNetworkErrorOnSubmit(r.$editForm,e,t,a)}})):jPar.wdk.modalbox.hide()},removeLineBreaksAndWhitespace:function(){var e=$j("#whatMakesMeSpecialEditInput"),t=e.val();t=(t=(t=$j.trim(t)).replace(/\r?\n/g," ")).replace(/ +/g," "),e.val(t)},validateForm:function(){var e=$j("#whatMakesMeSpecialEditInput");jPar.util.validate.hasMinimumWordsFilled(e,7)?jPar.wdk.forms.hideError($j("#whatMakesMeSpecialTooShortError")):jPar.wdk.forms.showError($j("#whatMakesMeSpecialTooShortError"))},formHasErrors:function(){return $j("#whatMakesMeSpecialTooShortError").hasClass("is-visible")},handleSuccessResponse:function(e){jPar.app.util.editLayer.saveFreetextValueForReset($j("#whatMakesMeSpecialEditInput")),this.setDisplayText(),jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,this.$editForm),jPar.app.util.editLayer.showApprovalStatusIfNeeded(e,$j("#whatMakesMeSpecialCard")),jPar.app.myProfile.updateProfileCompletion(),jPar.wdk.modalbox.hide()},setDisplayText:function(){var e=jPar.wdk.security.sanitizeStringForHtml($j("#whatMakesMeSpecialEditInput").val().trim());$j("#whatMakesMeSpecialCard .whatMakesMeSpecialText").html(e)}}}),jPar.app.myProfile=jPar.app.myProfile||{},$j.extend(!0,jPar.app.myProfile,{profileMenue:{init:function(){var t=this;$j(".openProfilemenu, #closeProfileMenu").on("click",function(e){e.preventDefault(),$j("html").hasClass("has-openProfileMenu")?t.close():t.open()}),$j(".js-editBgImage").on("click",function(e){e.preventDefault(),t.backgroundImage.showEdit($j(this))})},open:function(){var a=this;$j("html").addClass("has-openProfileMenu"),$j("#profileMenuList").attr("aria-hidden",!1).removeAttr("inert"),$j("#profileMenu > a").attr("aria-expanded","true"),$j("#topNavi, #tabContents, #footerUnified, .headerWrapper2, #profileTabNavi, #profilePicLink").attr("inert","true"),$j("#pageWrapper").on("click.myProfileMenu",function(e){var t=$j(e.target);t.is("#profileMenuList")||t.parents("#profileMenuList").length||t.is(".openProfilemenu")||(e.preventDefault(),a.close())})},close:function(){$j("html").removeClass("has-openProfileMenu"),$j("#pageWrapper").off(".myProfileMenu"),$j("#profileMenuList").attr("aria-hidden",!0).attr("inert","true"),$j("#profileMenu > a").attr("aria-expanded","false"),$j("#topNavi, #tabContents, #footerUnified, .headerWrapper2, #profileTabNavi, #profilePicLink").removeAttr("inert")},backgroundImage:{conf:{$editForm:null,initialImgUrl:"",initialImgClass:""},showEdit:function(){var e=this,t=$j("#editBgImage");jPar.wdk.loadingIndicator.show(t),document.activeElement.blur(),jPar.wdk.modalbox.show({modalboxId:"#editBackgroundImageModal",onSuccess:function(){jPar.wdk.loadingIndicator.hide(t),e.initEdit(),jPar.app.myProfile.profileMenue.close()},onBeforeClose:function(){return e.resetUnsavedImage(),!0}})},initEdit:function(){var t=this;t.conf.$editForm=$j("#editBackgroundImage"),this.saveCurrentImageForReset(),t.conf.$editForm.find(".backgroundImgList li").on("click",function(e){e.preventDefault(),t.selectImg($j(this))}),t.conf.$editForm.on("submit",function(e){e.preventDefault(),t.saveImg()})},saveCurrentImageForReset:function(){var e=$j("#bgImgBox");this.conf.initialImgUrl=e.css("backgroundImage"),this.conf.initialImgClass=e.attr("class")},resetUnsavedImage:function(){var e=$j("#bgImgBox");e.css("backgroundImage",this.conf.initialImgUrl),e.attr("class",this.conf.initialImgClass)},selectImg:function(e){var t=e.data("imageId"),a=$j("#bgImgBox"),r=this.conf.$editForm.data("imgBasepath")+t+"_pic.jpg";this.conf.$editForm.find(".backgroundImgList li").removeClass("active"),e.addClass("active"),a.attr("class","img_"+t.replace("/","-")),a.css("backgroundImage","url("+r+")"),$j("#selectedPicInput").val(t)},saveImg:function(){var r=this,t=r.conf.$editForm.find("button.saveElement");jPar.wdk.loadingIndicator.show(t),r.hideAllErrors(),$j.ajax({type:"POST",url:r.conf.$editForm.attr("action"),data:r.conf.$editForm.serialize(),success:function(e){jPar.wdk.loadingIndicator.hide(t),r.isValidSuccessResponse(e)?(r.saveCurrentImageForReset(),jPar.wdk.modalbox.hide(),jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"own_profile",subcategory:"header",action:"section_edited"})):r.handleInvalidResponse(e)},error:function(e,t,a){r.handleNetworkErrorOnSubmit(e,t,a)}})},isValidSuccessResponse:function(e){try{return"object"===_typeof(e)&&void 0!==e.success&&!0===e.success}catch(e){return!1}},handleInvalidResponse:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):(jPar.wdk.forms.showError(this.conf.$editForm.find(".saveError")),jPar.util.log.error($j("body").attr("id"),"editBackgroundImage errorOnSubmit - reallyBadError"),this.scrollToError())},handleNetworkErrorOnSubmit:function(e,t,a){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):(jPar.app.util.editLayer.handleNetworkErrorOnSubmit(this.conf.$editForm,e,t,a),this.scrollToError())},hideAllErrors:function(){this.conf.$editForm.find(".wdk-styledHintBox").removeClass("is-visible")},scrollToError:function(){if(0<this.conf.$editForm.find('.wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var e=this.conf.$editForm.find(".scrollingContent").prop("scrollHeight");this.conf.$editForm.find(".scrollingContent").animate({scrollTop:e},300)}}}}}),jPar.app.myProfile=jPar.app.myProfile||{},$j.extend(!0,jPar.app.myProfile,{tabNavigation:{init:function(){var a=this;jPar.app.profilePages.tabNaviUtil.swiper.init(),$j('#profileTabNavi a[href="#"]').on("click",function(e){e.preventDefault();var t=$j(this).parent();!1===t.is(".active")&&a.switchTab(t)}),a.updatePageFromUrl(),jPar.app.util.initPopState(function(){a.updatePageFromUrl()}),!0===$j("#profileTabNavi").data("scrollToTabNavi")&&jPar.app.profilePages.tabNaviUtil.scrollToTabNavi()},switchTab:function(e,t){var a=!1;void 0!==t&&!0===t.preventPushstate&&(a=!0),jPar.app.profilePages.tabNaviUtil.showTab(e),e.is("#photoTab")&&jPar.app.myProfile.photoToolRelated.initPhotoTool(),e.is("#testresultTab")&&(jPar.wdk.brands.forBrands(["ps","eh"])&&jPar.app.myProfile.testresultTabPsEh.init(),jPar.wdk.brands.forBrands(["ep"])&&jPar.app.myProfile.testresultTabEP.init()),!1===a&&this.setPushState(e)},setPushState:function(e){0<$j("html.history").length&&(e.is("#profileTab")?history.pushState(null,null,"/profile/factfile/overview"):e.is("#photoTab")?history.pushState(null,null,"/profile/photoTool"):e.is("#testresultTab")&&history.pushState(null,null,"/profile/testresult"))},updatePageFromUrl:function(){var e=document.location.href;-1<e.indexOf("profile/factfile/overview")?this.switchTab($j("#profileTab"),{preventPushstate:!0}):-1<e.indexOf("profile/photoTool")?this.switchTab($j("#photoTab"),{preventPushstate:!0}):-1<e.indexOf("profile/testresult")&&this.switchTab($j("#testresultTab"),{preventPushstate:!0})}}}),jPar.app.myProfile=jPar.app.myProfile||{},$j.extend(!0,jPar.app.myProfile,{testresultTabEP:{init:function(){var e=this;jPar.app.profilePages.matchingDiagram.init(),$j(window).on("scroll touchmove",function(){e.personalAnalysisGraph()}),e.personalAnalysisGraph(),$j(".js-openMotiveModal, .js-openPrincipleModal").on("click",function(e){e.preventDefault();var t=$j(this).data("modalbox");jPar.wdk.modalbox.show({modalboxId:"#"+t})}),jPar.Tracking.trackVirtualPage("profile/TESTRESULT_TAB")},personalAnalysisGraph:function(){if(0<$j(".personalAnalysisGraph").length&&$j(".personalAnalysisGraph").isOnScreen()){var t=$j(".personalAnalysisGraph").find(".barGroup");if(0<t.length){var a=0;!function e(){$j(t[a]).addClass("animate"),++a<t.length&&setTimeout(e,100)}()}}}}}),jPar.app.myProfile=jPar.app.myProfile||{},$j.extend(!0,jPar.app.myProfile,{testresultTabPsEh:{init:function(){$j(".js-openRestartQuestionaireConfirmModal").on("click",function(e){e.preventDefault(),jPar.wdk.modalbox.show({modalboxId:"#restartQuestionaireConfirmModal"})}),$j(".js-openMatchingExplanationModal").on("click",function(e){e.preventDefault();var t=$j(this).data("modalbox")+"Modal";jPar.wdk.modalbox.show({modalboxId:"#"+t})}),$j(".js-toggleOpenClose a").off("click"),$j(".js-toggleOpenClose a").on("click",function(e){e.preventDefault();var t=$j(this).parents(".testresultScoringInfo"),a=t.find(".infoText");t.toggleClass("is-opening"),t.removeClass("is-openDone"),a.slideToggle(function(){$j(this).parents(".testresultScoringInfo").addClass("is-openDone")})}),0<$j("#matchingWheel").length&&jPar.util.loadScript("chartjs_combined",function(){jPar.app.profilePages.matchingWheel.init()}),this.initSubTabs()},initSubTabs:function(){var a=this;$j("#matchingSubTabs a").on("click",function(e){e.preventDefault();var t=$j(this).parent();a.showTab(t)})},showTab:function(e){$j("#matchingSubTabs li, #subTabContents > div").removeClass("active"),e.addClass("active"),$j("#"+e.attr("id")+"Content").addClass("active")}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{welcomePage:{init:function(){try{jPar.wdk.cardDeck.init(),jPar.wdk.forms.init(),this.firstStepsSlider.init(),this.initMsgList(),this.initPartnerSuggestionList(),jPar.wdk.countdownClock.start("#bannerInContent"),this.idSecureInit()}catch(e){jPar.util.log.error(e,"jPar.app.welcomePage.init: Init failed")}},idSecureInit:function(){$j("#cliIdCheck.secured").on("click",function(e){e.preventDefault()})},initMsgList:function(){$j(".messageListCard .js-linkToProfile").on("click",function(e){e.preventDefault();var t=$j(this).parents(".messageItem").data("profileLink");window.location.href=t}),$j("#messageCard .answerButton button").on("click",function(e){e.preventDefault(),location.href=$j(this).data("answerUrl")})},initPartnerSuggestionList:function(){$j("#partnerSuggestionCard .linkToDistance").on("click",function(e){e.preventDefault(),location.href=$j(this).data("href")}),0<$j("#partnerSuggestionCard .sendHelloButton").length&&this.helloMsg.init()},firstStepsSlider:{conf:{swiperObj:null},init:function(){if(0<$j("#firstStepsSlider").length){if("undefined"==typeof Swiper)return;this.conf.swiperObj=new Swiper("#firstStepsSlider",{keyboardControl:!0,pagination:".swiper-pagination",paginationClickable:!0,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",speed:300})}}},earlyBirdLayer:{open:function(){var e=this;0<$j("#earlyBirdLayer").length&&""!==$j.trim($j("#earlyBirdLayer article").html())&&(e.respImage.init(),jPar.wdk.modalbox.show({modalboxId:"#earlyBirdLayer",onSuccess:function(){$j("#earlyBirdLayer .modalboxContent").css("maxWidth",$j("#ps_modalwidth").html()+"px"),0<$j("#ps_modalheadline").length?$j("#earlyBirdLayer h3").html($j("#ps_modalheadline").html()):$j("#earlyBirdLayer h3").html($j("#personal_modalheadline").html()),e.startCountdown(),$j(".closeModalBox").on("click",function(e){e.preventDefault(),jPar.wdk.modalbox.hide()})}}))},startCountdown:function(){if($j("#addCountdownHere").length&&$j("#countdownWrapper").length){$j("#addCountdownHere").html($j("#countdownWrapper").html()),$j("#countdownWrapper").remove();try{0<$j("#countdown").length&&$j("#countdown").countdown({timestamp:new Date(parseInt($j("#countdown").data("countdownEndTs"),10)),currentServerTime:new Date(parseInt($j("#countdown").data("countdownStartTs"),10))})}catch(e){jPar.util.log.error(e,"jPar.app.welcomePage.earlyBirdLayer.startCountdown")}}},respImage:{cache:{showClass:""},init:function(){$j(".js-respImage").length&&(this.updateImage(),$j(window).on("resize.respImage",this.updateImage))},updateImage:function(){var e=jPar.app.welcomePage.earlyBirdLayer.respImage.cache,t=jPar.wdk.screensize.isBreakpoint(["S","M"])?"sm":"lxl";if(t!==e.showClass){e.showClass=t;var a=$j(".js-respImage");a.attr("src",a.data(t))}}}}}}),jPar.app.basiccriteria=jPar.app.basiccriteria||{},$j.extend(!0,jPar.app.basiccriteria,{cardCriterias:{init:function(){this.ageAndHeight.init(),this.smoker.init(),this.kids.init(),this.wishToHaveChildren.init(),this.religion.init(),this.ethnicity.init(),this.income.init(),this.education.init()},scrollToError:function(e){if(0<e.find('.js-scrollableContent .wdk-styledHintBox[class*=" t-error"].is-visible').first().length){var t=e.find(".js-scrollableContent").prop("scrollHeight");e.find(".js-scrollableContent").animate({scrollTop:t},300)}},ageAndHeight:{init:function(){this.initHeightToggle(),this.initAgeToggle()},initHeightToggle:function(){var t=this,a=parseInt($j("#height").data("min-range")),e=parseInt($j("#heightFrom").val(),10);t.updateToOptions(e,$j("#heightTo"),a),$j("#heightFrom").on("change",function(){var e=parseInt($j("#heightFrom").val(),10);t.updateToOptions(e,$j("#heightTo"),a)})},initAgeToggle:function(){var t=this,e=parseInt($j("#ageFrom").val(),10);t.updateToOptions(e,$j("#ageTo"),4),$j("#ageFrom").on("change",function(){var e=parseInt($j("#ageFrom").val(),10);t.updateToOptions(e,$j("#ageTo"),4)})},updateToOptions:function(a,e,r){e.prepend(e.data("parkedOptions")),e.find("option").each(function(){var e=$j(this),t=parseInt(e.attr("value"),10);t<a+r-1&&0!==t?(e.prop("disabled",!0),e.prop("selected",!1)):e.prop("disabled",!1)});var t=e.find("option[disabled]");e.data("parkedOptions",t),t.remove()}},smoker:{init:function(){var t=this;$j("#editSmokerModal .saveElement").on("click",function(e){e.preventDefault(),t.setDisplayValue()})},setDisplayValue:function(){var e=$j("#editSmokerModal input:checked + label"),t="";0<e.length?(jPar.wdk.forms.hideError($j("#smokerError")),e.each(function(e){t+=0!==e?", ":"",t+=$j(this).text().trim()}),$j("#smoker .displayValue").text(t),jPar.app.util.editLayer.saveCheckboxValuesForReset($j("#editSmokerModal")),jPar.wdk.modalbox.hide()):jPar.wdk.forms.showError($j("#smokerError"))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm($j("#editSmokerModal")),jPar.wdk.forms.hideError($j("#smokerError"))}},kids:{selectedOptionId:null,init:function(){var t=this;this.selectedOptionId=$j("#editKidsModal input:checked").attr("id"),$j("#editKidsModal .saveElement").on("click",function(e){e.preventDefault(),t.setDisplayValue()})},setDisplayValue:function(){var e=$j("#editKidsModal input:checked + label").text().trim();$j("#kids .displayValue").text(e),this.selectedOptionId=$j("#editKidsModal input:checked").attr("id"),jPar.wdk.modalbox.hide()},resetFormOnAbort:function(){$j("#editKidsModal #"+this.selectedOptionId).prop("checked",!0)}},wishToHaveChildren:{selectedOptionId:null,init:function(){var t=this;this.selectedOptionId=$j("#editWishToHaveChildrenModal input:checked").attr("id"),$j("#editWishToHaveChildrenModal .saveElement").on("click",function(e){e.preventDefault(),t.setDisplayValue()})},setDisplayValue:function(){var e=$j("#editWishToHaveChildrenModal input:checked + label").text().trim();$j("#wishToHaveChildren .displayValue").text(e),this.selectedOptionId=$j("#editWishToHaveChildrenModal input:checked").attr("id"),jPar.wdk.modalbox.hide()},resetFormOnAbort:function(){$j("#editWishToHaveChildrenModal #"+this.selectedOptionId).prop("checked",!0)}},religion:{init:function(){if(0<$j("#religion").length){var t=this;t.checkAnyIfAllSelected(),$j(document).on("wdk:modalbox:isOpened",function(e){"editReligionModal"===e.detail.$modalboxObj.attr("id")&&t.checkAnyIfAllSelected()}),$j("#editReligionModal .saveElement").on("click",function(e){e.preventDefault(),t.setDisplayValue()}),$j("#editReligionModal input").on("change",function(e){t.toggleCheckboxes(e)})}},checkAnyIfAllSelected:function(){!0===($j("#editReligionModal input").length-1===$j("#editReligionModal input:checked").length)&&$j("#anyReligion").prop("checked",!0)},toggleCheckboxes:function(e){var t=$j("#editReligionModal input");"anyReligion"===$j(e.currentTarget).attr("id")?t.each(function(){!0===$j("#anyReligion").prop("checked")?$j(this).prop("checked",!0):$j(this).prop("checked",!1)}):$j("#editReligionModal #anyReligion").prop("checked",!1)},setDisplayValue:function(){var e=$j("#editReligionModal input:checked + label"),t="";0<e.length?(jPar.wdk.forms.hideError($j("#religionError")),$j("#editReligionModal input + label").length===e.length?t=$j("#editReligionModal #anyReligion + label").text().trim():e.each(function(e){t+=0!==e?", ":"",t+=$j(this).text().trim()}),$j("#religion .displayValue").text(t),jPar.app.util.editLayer.saveCheckboxValuesForReset($j("#editReligionModal")),jPar.wdk.modalbox.hide()):(jPar.wdk.forms.showError($j("#religionError")),jPar.app.basiccriteria.cardCriterias.scrollToError($j("#editReligionModal")))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm($j("#editReligionModal")),jPar.wdk.forms.hideError($j("#religionError"))}},ethnicity:{init:function(){if(this.$editForm=$j("#editEthnicityModal"),0<$j("#ethnicity").length){var t=this;t.checkAnyIfAllSelected(),$j(document).on("wdk:modalbox:isOpened",function(e){"editEthnicityModal"===e.detail.$modalboxObj.attr("id")&&t.checkAnyIfAllSelected()}),$j("#editEthnicityModal .saveElement").on("click",function(e){e.preventDefault(),t.setDisplayValue()}),$j("#editEthnicityModal input").on("change",function(e){t.toggleCheckboxes(e)})}},checkAnyIfAllSelected:function(){!0===($j("#editEthnicityModal input").length-1===$j("#editEthnicityModal input:checked").length)&&$j("#anyEthnicity").prop("checked",!0)},toggleCheckboxes:function(e){var t=$j("#editEthnicityModal input");"anyEthnicity"===$j(e.currentTarget).attr("id")?t.each(function(){!0===$j("#anyEthnicity").prop("checked")?$j(this).prop("checked",!0):$j(this).prop("checked",!1)}):$j("#editEthnicityModal #anyEthnicity").prop("checked",!1)},setDisplayValue:function(){var e=$j("#editEthnicityModal input:checked + label"),t="";0<e.length?(jPar.wdk.forms.hideError($j("#ethnicityError")),$j("#editEthnicityModal input + label").length===e.length?t=$j("#editEthnicityModal #anyEthnicity + label").text().trim():e.each(function(e){t+=0!==e?", ":"",t+=$j(this).text().trim()}),$j("#ethnicity .displayValue").text(t),jPar.app.util.editLayer.saveCheckboxValuesForReset($j("#editEthnicityModal")),jPar.wdk.modalbox.hide()):(jPar.wdk.forms.showError($j("#ethnicityError")),jPar.app.basiccriteria.cardCriterias.scrollToError($j("#editEthnicityModal")))},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm($j("#editEthnicityModal")),jPar.wdk.forms.hideError($j("#ethnicityError"))}},income:{selectedOptionId:null,init:function(){var t=this;this.selectedOptionId=$j("#editIncomeModal input:checked").attr("id"),$j("#editIncomeModal .saveElement").on("click",function(e){e.preventDefault(),t.setDisplayValue()})},setDisplayValue:function(){var e=$j("#editIncomeModal input:checked + label").text().trim();$j("#income .displayValue").text(e),this.selectedOptionId=$j("#editIncomeModal input:checked").attr("id"),jPar.wdk.modalbox.hide()},resetFormOnAbort:function(){$j("#editIncomeModal #"+this.selectedOptionId).prop("checked",!0)}},education:{selectedOptionId:null,init:function(){var t=this;this.selectedOptionId=$j("#editEducationModal input:checked").attr("id"),$j("#editEducationModal .saveElement").on("click",function(e){e.preventDefault(),t.setDisplayValue()})},setDisplayValue:function(){var e=$j("#editEducationModal input:checked + label").text().trim();$j("#education .displayValue").text(e),this.selectedOptionId=$j("#editEducationModal input:checked").attr("id"),jPar.wdk.modalbox.hide()},resetFormOnAbort:function(){$j("#editEducationModal #"+this.selectedOptionId).prop("checked",!0)}}}}),jPar.app.basiccriteria=jPar.app.basiccriteria||{},$j.extend(!0,jPar.app.basiccriteria,{countrySearch:{$editModal:null,init:function(){var t=this;t.$editModal=$j("#editCountrySearchModal"),t.$editModal.find(".modalCountries button").on("click",function(e){e.preventDefault(),t.countryAccordeon.openOrCloseCountry(e)}),this.countryAccordeon.updateStatesCount(),t.$editModal.find(".modalStates input").on("change",function(e){t.allStatesChecker.updateStatus(e),t.countryAccordeon.updateStatesCount(),t.validate()}),t.$editModal.find(".saveElement").on("click",function(e){e.preventDefault(),t.hasCheckedStates()&&t.setDisplayValue()})},countryAccordeon:{openOrCloseCountry:function(e){var t=$j(e.currentTarget),a=t.parents("li").find(".modalStates");t.parents("li").hasClass("is-open")?(this.closeAllCountries(),t.attr("aria-expanded",!1),a.attr("aria-hidden",!0),a.slideUp(200)):(this.closeAllCountries(),t.parents("li").toggleClass("is-open"),t.attr("aria-expanded",!0),a.attr("aria-hidden",!1),a.slideDown(200,function(){jPar.wdk.modalbox.updatePerfectScrollbar()}),jPar.app.basiccriteria.countrySearch.allStatesChecker.checkTogglerIfNeeded(t))},closeAllCountries:function(){var e=$j("#editCountrySearchModal").find(".modalCountries > li");e.removeClass("is-open"),e.find(".modalStates").slideUp(200)},updateStatesCount:function(){$j("#editCountrySearchModal").find(".modalCountries > li").each(function(e,t){var a=$j(t),r=a.find("li:not(.allStatesChecker) input:checked").length,i=0<r;a.find(".statesCountWrapper").attr("aria-hidden",!i),i?(a.addClass("has-checkedStates"),a.find(".statesCount").text(r),1===r?(a.addClass("is-singleState"),a.removeClass("is-multiStates"),a.find(".multiStates").attr("aria-hidden",!0),a.find(".singleState").attr("aria-hidden",!1)):(a.removeClass("is-singleState"),a.addClass("is-multiStates"),a.find(".multiStates").attr("aria-hidden",!1),a.find(".singleState").attr("aria-hidden",!0))):a.removeClass("has-checkedStates")})}},allStatesChecker:{updateStatus:function(e){var t=$j(e.currentTarget),a=0<t.parents(".allStatesChecker").length,r=t.parents("li.is-open").find("button");a&&this.toggleAllStates(t),this.checkTogglerIfNeeded(r)},toggleAllStates:function(e){var t=e.prop("checked"),a=e.parents(".modalStates").find("input");t?a.prop("checked",!0):a.prop("checked",!1)},checkTogglerIfNeeded:function(e){e.parents("li").find("li:not(.allStatesChecker) input").length===e.parents("li").find("li:not(.allStatesChecker) input:checked").length?e.parents("li").find(".allStatesChecker input").prop("checked",!0):e.parents("li").find(".allStatesChecker input").prop("checked",!1)}},validate:function(){this.hasCheckedStates()?jPar.app.util.editLayer.hideStickyHint($j("#noCountrySelected")):jPar.app.util.editLayer.showStickyHint($j("#noCountrySelected"))},hasCheckedStates:function(){return 0<$j(".modalCountries > li.has-checkedStates").length},setDisplayValue:function(){var n=$j("#countrySearch .displayValue");n.empty();var s=$j('label[for="allOtherStates_OO"]');this.$editModal.find(".modalCountries > li").each(function(e,t){var a=$j(t).find("li:not(.allStatesChecker) input:checked + label");if(0<a.length){var r=$j(t).find("button .countryName").text()+":",i="";a.each(function(e){i+=0<e?", ":" ",i+=$j(this).text().trim()}),!!(0<s.length&&$j(a).is(s))&&(r=r.substr(0,r.indexOf(":")),i="");var o=$j("<p>").append($j("<strong>").text(r)).append(i);n.append(o)}}),jPar.app.util.editLayer.saveCheckboxValuesForReset(this.$editModal),jPar.wdk.modalbox.hide()},resetFormOnAbort:function(){jPar.app.util.editLayer.resetCheckboxesInForm(this.$editModal),this.countryAccordeon.updateStatesCount(),this.validate(),this.countryAccordeon.closeAllCountries()}}}),jPar.app.basiccriteria=jPar.app.basiccriteria||{},$j.extend(!0,jPar.app.basiccriteria,{distanceSearch:{$editModal:null,init:function(){var t=this;t.$editModal=$j("#editDistanceSearchModal"),t.validate.$editModal=t.$editModal,this.switchCountryDistanceSearch(),$j("#cardCountry input[type=radio]").on("change",function(){t.switchCountryDistanceSearch()}),this.fixIosFlickering(),t.$editModal.find(".saveElement").on("click",function(e){e.preventDefault(),t.validate.validateAll(),t.validate.formIsValid()&&t.setDisplayValue()})},switchCountryDistanceSearch:function(){var e=$j("#cardCountry .formElementRow"),t=$j("#cardCountry .js-countryDistanceToggle:checked"),a=t.parents(".formElementRow");e.removeClass("active"),e.find(".displayToggle").slideUp(200),a.addClass("active"),a.find(".displayToggle").slideDown(200),this.fixIosRadioIsNotFilledAfterFullscreenModalbox(t);var r=jPar.util.validate.selectBoxHasValue($j("#distanceCountry"),"-1");$j("#distanceSearch").hasClass("active")&&r&&$j("#openDistanceSearchButton").trigger("click")},validate:{$editModal:null,validateAll:function(){this.validateFrontend(),this.formIsValid()&&this.validateZipInBackend()},isValidForPageSubmit:function(){return!1===this.isCountryEmpty()&&!1===this.isZipEmpty()},validateFrontend:function(){this.hideAllErrors(),this.validateCountry(),this.validateZip()},validateCountry:function(){this.isCountryEmpty()?jPar.wdk.forms.showError(this.$editModal.find("#noCountrySelectedError")):jPar.wdk.forms.hideError(this.$editModal.find("#noCountrySelectedError"))},isCountryEmpty:function(){return jPar.util.validate.selectBoxHasValue($j("#distanceCountry"),"-1")},validateZip:function(){this.isZipEmpty()?jPar.wdk.forms.showError(this.$editModal.find("#emptyZipError")):jPar.wdk.forms.hideError(this.$editModal.find("#emptyZipError"))},isZipEmpty:function(){return jPar.util.validate.textfieldIsEmpty(this.$editModal.find("#distanceZip"))},validateZipInBackend:function(){var t=this;$j.ajax({type:"POST",url:t.$editModal.data("validateUrl"),async:!1,data:{country:$j("#distanceCountry").val(),zip:$j("#distanceZip").val(),distance:$j("#distanceRadius").val(),_csrf:jPar.wdk.security.getCsrfToken()},success:function(e){!1===t.isValidZip(e)&&t.handleErrorCodes(e)},error:function(){jPar.wdk.forms.showError(t.$editModal.find(".saveError"))}})},isValidZip:function(e){try{return"object"===_typeof(e)&&void 0!==e.success&&!0===e.success}catch(e){return!1}},handleErrorCodes:function(e){var t=void 0!==e.success&&!1===e.success;jPar.util.network.hasValidSessionAndCsrfToken(e)&&t?jPar.wdk.forms.showError($j("#INVALID_ZIP")):jPar.wdk.forms.showError(this.$editModal.find(".sessionExpired"))},formIsValid:function(){return!1===jPar.wdk.forms.hasVisibleErrors(this.$editModal)},hideAllErrors:function(){this.$editModal.find('.wdk-styledHintBox[class*=" t-error"].is-visible').each(function(){$j(this).parents(".has-error").removeClass("has-error")}),this.$editModal.find('.wdk-styledHintBox[class*=" t-error"]').removeClass("is-visible")}},setDisplayValue:function(){var e=this.$editModal.find("#distanceCountry option:selected").text(),t=this.$editModal.find("#distanceCountry").val(),a=this.$editModal.find("#distanceZip").val(),r=this.$editModal.find("#distanceRadius option:selected").text(),i=this.$editModal.find("#distanceRadius").val();$j("#distanceCountry").data("currentSavedValue",t),$j("#distanceZip").data("currentSavedValue",a),$j("#distanceRadius").data("currentSavedValue",i),$j("#displayCountry").text(e),$j("#displayZip").text(jPar.wdk.security.sanitizeStringForHtml(a)),$j("#displayRadius").html(r.replace("<","&lt;")),jPar.wdk.forms.hideError($j("#distanceSearchNotFilled")),jPar.wdk.modalbox.hide()},resetFormOnAbort:function(){this.validate.hideAllErrors(),this.fixIosRadioIsNotFilledAfterFullscreenModalbox($j("#cardCountry input.js-countryDistanceToggle:checked"));var e=$j("#editDistanceSearchModal"),t=e.find("#distanceCountry").data("currentSavedValue");e.find("#distanceCountry").val(t);var a=e.find("#distanceZip").data("currentSavedValue");e.find("#distanceZip").val(a);var r=e.find("#distanceRadius").data("currentSavedValue");e.find("#distanceRadius").val(r)},isIos:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},fixIosFlickering:function(){this.isIos()&&this.$editModal.data("minSizeModalstyle","ALWAYS_FULLSCREEN")},fixIosRadioIsNotFilledAfterFullscreenModalbox:function(e){this.isIos()&&(e.prop("checked",!1),e.css("color"),e.prop("checked",!0))}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{basiccriteria:{init:function(){try{var t=this;jPar.wdk.cardDeck.init(),jPar.wdk.forms.init(),this.cardCriterias.init(),this.countrySearch.init(),this.distanceSearch.init(),$j(".js-gotoPayment").on("click",function(e){e.preventDefault();var t=$j(this).find(".wdk-button").attr("href");window.location.href=t}),$j("#basiccriteriaPage .js-openEditLayer").on("click keyup",function(e){jPar.util.validate.isMouseclickEnterOrSpaceKey(e.keyCode)&&(e.preventDefault(),t.openEditLayer(e))}),$j(document).on("wdk:modalbox:isHidden",function(e){t.resetOpenEditForm(e.detail)}),$j("#topNavi #pvl > a, #topNavi #pvl li.active").on("click",function(e){e.preventDefault(),$j("#basiccriteriaForm").trigger("submit")}),$j("#basiccriteriaForm").on("submit",function(e){t.validatePageSubmit(e)})}catch(e){jPar.util.log.error(e,"jPar.app.basiccriteria.init: Init failed")}},validatePageSubmit:function(e){var t=!1===this.distanceSearch.validate.isValidForPageSubmit();if($j("#distanceSearch").hasClass("active")&&t){e.preventDefault();var a=$j("#distanceSearchNotFilled");jPar.wdk.forms.showError(a),jPar.util.scrollToElement(a)}else{!1===Boolean($j("#allOtherStates_OO").prop("checked"))&&$j("#allOtherStates_OO").prop("disabled",!0)}},openEditLayer:function(e){var t=$j(e.currentTarget).data("modalboxSelector");jPar.wdk.modalbox.show({modalboxId:t})},resetOpenEditForm:function(e){var t=e.$modalboxObj.attr("id");"editKidsModal"===t?this.cardCriterias.kids.resetFormOnAbort():"editWishToHaveChildrenModal"===t?this.cardCriterias.wishToHaveChildren.resetFormOnAbort():"editIncomeModal"===t?this.cardCriterias.income.resetFormOnAbort():"editSmokerModal"===t?this.cardCriterias.smoker.resetFormOnAbort():"editReligionModal"===t?this.cardCriterias.religion.resetFormOnAbort():"editEthnicityModal"===t?this.cardCriterias.ethnicity.resetFormOnAbort():"editEducationModal"===t?this.cardCriterias.education.resetFormOnAbort():"editDistanceSearchModal"===t?this.distanceSearch.resetFormOnAbort():"editCountrySearchModal"===t&&this.countrySearch.resetFormOnAbort()}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{listPages:{init:function(){jPar.wdk.cardDeck.init(),this.favorite.init(),$j("body").is("#partnerSuggestionListPage")&&(this.sorting.init(),jPar.app.nameAndPhotoOptinLayer.init(),jPar.wdk.countdownClock.start("#bannerInContent"),this.filterBox.init(),this.initLinkToDistance(),0<$j(".supercardList").length&&jPar.app.listPages.supercard.init())},favorite:{init:function(){var t=this;document.querySelectorAll(".favoriteToggle").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.onClickFavorite(e)})})},onClickFavorite:function(e){var t=this,a=e.currentTarget;jPar.util.vibrate(),jPar.wdk.loadingIndicator.show(a),jPar.app.ajaxCommands.favoriteToggle(a).then(function(e){"addFavorite"===e?t.handleAddFavorite(a):"removeFavorite"===e&&t.handleRemoveFavorite(a)},function(e){t.handleReject(a,e.message)})},handleAddFavorite:function(e){jPar.wdk.loadingIndicator.hide(e),e.classList.add("is-animated"),e.classList.add("is-favorite"),e.setAttribute("aria-pressed","true"),e.addEventListener(jPar.util.prefixedAnimationEndEvent,function(){e.classList.remove("is-animated")},{once:!0})},handleRemoveFavorite:function(e){jPar.wdk.loadingIndicator.hide(e),e.classList.add("is-animated"),e.classList.remove("is-favorite"),e.setAttribute("aria-pressed","false"),e.addEventListener(jPar.util.prefixedAnimationEndEvent,function(){e.classList.remove("is-animated")},{once:!0}),null!==document.querySelector("#favoritesListPage")&&window.location.reload()},handleReject:function(e,t){jPar.wdk.loadingIndicator.hide(e),"successFalse"===t&&jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),"sessionExpired"===t&&jPar.util.network.reloadForSessionExpired(),"browserTimeout"===t&&jPar.wdk.toast.show("#timeoutNotification"),"genericError"===t&&jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"})}},initLinkToDistance:function(){document.querySelectorAll(".linkToDistance").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),location.href=this.closest(".linkToDistance").dataset.href})})},filterBox:{init:function(){if(0<$j("#filterOptions").length){var t=this;$j("#searchFilterForm select").on("change",function(e){e.preventDefault(),t.selectFilter()}),$j("#searchFilterForm").on("submit",function(e){e.preventDefault(),t.startFilter()}),$j("#deactivateFilter").on("click",function(e){e.preventDefault(),t.resetFilter()})}},selectFilter:function(){0<$j("#searchFilterForm").find('select option:selected[value!=""]').length?this.getNewFilterCount():this.resetFilter()},startFilter:function(){0===$j("#filterOptions .is-premiumFeature").length&&(window.location.href=$j("#searchFilterForm").attr("action")+"?action=applyAndFilter")},resetFilter:function(){window.location.href=$j("#searchFilterForm").attr("action")+"?action=removeFilter"},getNewFilterCount:function(){var t=this,e=$j("#searchFilterForm").data("hitsCountUrl"),a=$j("#searchFilterForm").serialize();$j.ajax({type:"POST",url:e,cache:!1,async:!0,data:a,success:function(e){"object"===_typeof(e)&&void 0!==e.hitsForAll?t.handleSuccess(e):t.handleError()},error:function(){t.handleError()}})},handleSuccess:function(e){jPar.wdk.forms.hideError($j("#filterError")),$j("#filteredSuggestions .js-updateSuggestionCount").text(e.hitsForAll),$j("#filteredSuggestions").removeClass("noDisplay"),0===e.hitsForAll?($j("#startFiltering").prop("disabled",!0),$j("#deactivateFilter").prop("disabled",!1)):(0<$j("#filterOptions .is-premiumFeature").length&&$j("#filterOptions .is-premiumFeature").addClass("is-visible"),$j("#startFiltering, #deactivateFilter").prop("disabled",!1))},handleError:function(){jPar.wdk.forms.showError($j("#filterError")),$j("#filteredSuggestions").addClass("noDisplay"),$j("#startFiltering, #deactivateFilter").prop("disabled",!1)}},sorting:{init:function(){var t=this;$j("#sortButton").on("click",function(){t.openSortingModal(this)}),$j("#sortingModal .saveElement").on("click",function(e){e.preventDefault(),t.saveSorting()}),$j("#sortingModal .is-premiumFeature").on("click",function(){window.location=$j("#sortingModal .is-premiumFeature .wdk-button").attr("href")}),$j("#sortingModal .js-closeModalbox").on("click",function(){$j("#sortingModal")[0].reset()})},openSortingModal:function(){jPar.wdk.modalbox.show({modalboxId:"sortingModal"})},saveSorting:function(){var e=$j("#sortingModal");jPar.wdk.loadingIndicator.show(e.find(".saveElement"));var t,a=e.find("input:checked").val();t=""!==a?e.attr("action")+a:e.data("basememberUrl"),window.location.href=t}}}}),jPar.app.listPages=jPar.app.listPages||{},$j.extend(!0,jPar.app.listPages,{supercard:{init:function(){this.profileRejection.init(),this.doTracking(),this.resetCardsIfOutOfViewport(),this.swiping.init(),jPar.app.messenger.initSupercard(),document.querySelectorAll(".js-writeTextMessage").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var t=e.target.closest("li").dataset.partnerUserId;jPar.app.messenger.conversationArea.loadMessageForUser(t),document.querySelector("#conversationArea").classList.add("is-visible")})})},swiping:{cardWidth:0,init:function(){var t=this,e=!0===jPar.wdk.screensize.isBreakpoint(["S"]),a=null!==document.querySelector("html.touchevents"),r=1<document.querySelectorAll(".supercardList li:first-of-type section").length;e&&a&&r&&(this.cardWidth=document.querySelector(".supercardList li:first-of-type section.active").offsetWidth,document.querySelectorAll(".supercardList .scrollWrapper").forEach(function(e){e.addEventListener("scroll",function(e){t.setActiveCard(e)},{passive:!0})}))},setActiveCard:function(e){var t=e.currentTarget,a=t.scrollLeft,r=0*this.cardWidth+this.cardWidth/2;if(1*this.cardWidth+this.cardWidth/2<=a){var i=t.querySelector("section:nth-of-type(3)");!1===i.classList.contains("active")&&(this.removeActive(t),i.classList.add("active"))}else if(r<=a){var o=t.querySelector("section:nth-of-type(2)");!1===o.classList.contains("active")&&(this.removeActive(t),o.classList.add("active"))}else if(0<=a){var n=t.querySelector("section:nth-of-type(1)");!1===n.classList.contains("active")&&(this.removeActive(t),n.classList.add("active"))}},removeActive:function(e){e.querySelectorAll("section.active").forEach(function(e){e.classList.remove("active")})}},resetCardsIfOutOfViewport:function(){if("IntersectionObserver"in window){var t=new IntersectionObserver(function(e){var t=e[0];if(!1===t.isIntersecting){t.target.scrollLeft=0;var a=t.target.querySelector("section");if(null!==a.querySelector(".rejectionLayer")){var r=a.querySelector(".rejectionLayer");a.classList.remove("has-rejectionLayer"),r.setAttribute("aria-hidden","true"),r.setAttribute("inert","true"),r.querySelector("h4").removeAttribute("role"),r.querySelector("h4").removeAttribute("aria-live"),r.querySelector("h4").removeAttribute("aria-atomic"),$j("body").off("click.rejectProfile")}}});document.querySelectorAll(".supercardList li .scrollWrapper").forEach(function(e){t.observe(e)})}},profileRejection:{init:function(){var t=this;0<$j(".supercardList").length&&($j("button.openRejectProfile").on("click",function(e){e.preventDefault(),e.stopPropagation(),t.showRejectionLayer(e),t.closeLayerOnPageInteraction()}),$j(".rejectionLayer").on("click",function(e){e.preventDefault(),e.stopPropagation()}),$j(".rejectionLayer .closeRejectionLayer").on("click",function(e){e.preventDefault(),t.closeRejectionLayerOnClick(e)}),$j(".rejectionLayer .doRejection").on("click",function(e){e.preventDefault(),t.doRejection(e)}))},showRejectionLayer:function(e){$j(".supercardList .supercardDiscovery").removeClass("has-rejectionLayer"),$j(".supercardList .supercardDiscovery .rejectionLayer .closeRejectionLayer").removeClass("has-buttonFullWidth"),jPar.wdk.forms.hideError($j(".rejectionLayer .genericErrorBox"));var t=$j(e.currentTarget).parents(".supercardDiscovery"),a=t.find(".rejectionLayer");t.addClass("has-rejectionLayer"),a.attr("aria-hidden","false").removeAttr("inert"),a.find(".closeRejectionLayer").focus(),a.find("h4").attr("role","alert").attr("aria-live","assertive").attr("aria-atomic","true"),t.css("color")},closeLayerOnPageInteraction:function(){var t=this;$j("body").on("click.rejectProfile",function(e){$j(e.target).is(".rejectionLayer")||$j(e.target).parents(".rejectionLayer").length||t.closeRejectionLayerOnClick(e)})},closeRejectionLayerOnClick:function(e){$j(".supercardList li .supercardDiscovery").removeClass("has-rejectionLayer"),$j(e.currentTarget).parents(".supercardDiscovery").find(".rejectionLayer").attr("aria-hidden","true").attr("inert","true"),$j(e.currentTarget).find("h4").removeAttr("role").removeAttr("aria-live").removeAttr("aria-atomic"),$j(e.currentTarget).parents(".supercardDiscovery").find(".openRejectProfile").focus(),$j("body").off("click.rejectProfile")},doRejection:function(e){var t=this,a=$j(e.currentTarget).parents("li").data("partnerUserId");jPar.wdk.loadingIndicator.show($j(e.currentTarget)),jPar.app.ajaxCommands.rejectSuggestion(a).then(function(){t.handleSuccess(e)},function(e){t.handleError(e)})},handleSuccess:function(e){if(jPar.wdk.loadingIndicator.hide($j(e.currentTarget)),jPar.wdk.screensize.isBreakpoint(["S","M"])){var t=$j(e.currentTarget).parents("li");t.one("transitionend",function(){window.setTimeout(function(){jPar.app.shellLayout.loadAppShellContent(document.location.pathname+document.location.search,{gotoStoredScrollPosition:!0})},400)}),t.addClass("has-rejectAnimation")}else jPar.app.shellLayout.loadAppShellContent(document.location.pathname+document.location.search,{gotoStoredScrollPosition:!0})},handleError:function(e){jPar.wdk.loadingIndicator.hide($j(".doRejection")),"browserTimeout"===e?jPar.wdk.toast.show("#timeoutNotification"):"sessionExpired"===e?jPar.util.network.reloadForSessionExpired():jPar.wdk.forms.showError($j(".has-rejectionLayer .rejectionLayer .genericErrorBox"))}},doTracking:function(){$j(".supercardList .supercardDiscovery").on("click",function(){jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"supercards",subcategory:"discovery_supercard",action:"click",targetId:"card_discovery_supercard"})})}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{nameAndPhotoOptinLayer:{init:function(){0<$j("html.localstorage").length&&(0<$j("#nameAndPhotoOptinModal").length&&!0===this.isCounterReached()&&!0===this.isReachedInterval()&&this.showOptinLayer())},showOptinLayer:function(){var e=this;jPar.wdk.modalbox.show({modalboxId:"nameAndPhotoOptinModal",onSuccess:function(){localStorage.setItem("lastTimeOptinLayerShown",Date.now()),localStorage.setItem("pvlCounter",0),$j("#nameAndPhotoOptinModal button[type=submit]").on("click",function(){e.sendOptin()})}})},sendOptin:function(){var t=this,a=$j("#nameAndPhotoOptinModal button[type=submit]");jPar.wdk.loadingIndicator.show(a),jPar.wdk.hintbox.removeClassIsVisible($j("#serverErrorMessage")),$j.ajax({type:"POST",url:"/profile/saveFirstNameAndUnblurredPhotoConsent",cache:!1,data:{_csrf:jPar.wdk.security.getCsrfToken()},success:function(e){jPar.wdk.loadingIndicator.hide(a),!0===t.isValidSuccessJson(e)?jPar.wdk.modalbox.show({modalboxId:"nameAndPhotoOptinAccepted"}):(localStorage.removeItem("lastTimeOptinLayerShown"),t.handleInvalidResponse(e))},error:function(e,t){jPar.wdk.loadingIndicator.hide(a),localStorage.removeItem("lastTimeOptinLayerShown"),"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):jPar.wdk.hintbox.addClassIsVisible($j("#serverErrorMessage"))}})},isValidSuccessJson:function(e){try{return"object"===_typeof(e)&&void 0!==e.success&&!0===e.success}catch(e){return!1}},handleInvalidResponse:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):jPar.wdk.hintbox.addClassIsVisible($j("#serverErrorMessage"))},isReachedInterval:function(){var e=parseInt(localStorage.getItem("lastTimeOptinLayerShown")),t=parseInt($j("#nameAndPhotoOptinModal").attr("data-optin-interval").replace(".",""));return!(null!==e&&!isNaN(e))||Date.now()>e+t},isCounterReached:function(){var e=parseInt(localStorage.getItem("pvlCounter"));return null===e||isNaN(e)?localStorage.setItem("pvlCounter",1):localStorage.setItem("pvlCounter",e+1),2<=parseInt(localStorage.getItem("pvlCounter"))}}}),jPar.app.messenger=jPar.app.messenger||{},jPar.app.messenger.contactArea=jPar.app.messenger.contactArea||{},$j.extend(!0,jPar.app.messenger.contactArea,{endlessScrolling:{loadPreviousContactsAlreadyActive:!1,loadNextsContactsAlreadyActive:!1,isFillViewAlreadyActive:!1,init:function(){this.setEndlessScrollEventListener(),$j(window).on("unload",function(){this.isFillViewAlreadyActive=!0,this.loadPreviousContactsAlreadyActive=!0,this.loadNextsContactsAlreadyActive=!0,$j(window).scrollTop(0),$j("#contactList").scrollTop(0)}),void 0===jPar.app.util.getGetParamFromUrl("partnerUserId")&&this.fillViewportWithContacts()},setEndlessScrollEventListener:function(){var e=this;$j(document).off("scroll.endlessScroll"),$j("#contactList").off("scroll.endlessScroll"),jPar.wdk.screensize.isBreakpoint(["S","M"])?$j(document).on("scroll.endlessScroll",function(){e.fillViewportWithContacts()}):jPar.wdk.screensize.isBreakpoint(["L","XL"])&&$j("#contactList").on("scroll.endlessScroll",function(){e.fillViewportWithContacts()})},fillViewportWithContacts:function(){var t=this;return!0===this.isFillViewAlreadyActive?new Promise(function(e){return e()}):(this.isFillViewAlreadyActive=!0,new Promise(function(e){t.fillView().then(function(){t.isFillViewAlreadyActive=!1,e()})}))},fillView:function(){var r=this;return new Promise(function(t){var e=new Promise(function(e){return e()});r.isLoadNextContactsNeeded()&&(e=r.loadNextContacts());var a=new Promise(function(e){return e()});r.isLoadPreviousContactsNeeded()&&(a=r.loadPreviousContacts()),Promise.all([e,a]).then(function(){var e=new Promise(function(e){return e()});(r.isLoadNextContactsNeeded()||r.isLoadPreviousContactsNeeded())&&(e=r.fillView()),e.then(function(){t()})})})},isLoadNextContactsNeeded:function(){var e=!1,t=!(jPar.wdk.screensize.isBreakpoint(["S","M"])&&$j("body").hasClass("has-conversationAreaOpenInitialForSM")),a=!1===$j("#hasMoreContacts").hasClass("noDisplay");if(jPar.wdk.screensize.isBreakpoint(["S","M"])){var r=$j(window).height();e=a&&$j(window).scrollTop()+r+60>$j("#hasMoreContacts").offset().top}else if(jPar.wdk.screensize.isBreakpoint(["L","XL"])){var i=$j("#contactList").height();e=a&&i>$j("#hasMoreContacts").position().top}return t&&e},loadNextContacts:function(){var t=this,r=this;return new Promise(function(a){if(!t.loadNextsContactsAlreadyActive){t.loadNextsContactsAlreadyActive=!0;var e=$j(".contactswrapper .innerListWrapper").children("a.contactItem").length;$j.ajax({type:"GET",url:"/messenger/contactsnext?lastPosition="+(e-1),success:function(e){if(!0===jPar.util.network.hasValidSessionAndCsrfToken(e)){var t=$j($j.parseHTML(e.trim())).filter("a");r.offscreenRenderingForContactList(function(){0===t.length?$j("#hasMoreContacts").addClass("noDisplay"):(t.each(function(){jPar.app.messenger.contactArea.removeContact($j(this).data("partnerUserId")),$j(".contactswrapper .innerListWrapper").append($j(this))}),jPar.wdk.screensize.isBreakpoint(["L","XL"])&&jPar.app.messenger.contactArea.setActiveContact(jPar.app.messenger.activePartnerUserId))})}else jPar.util.network.reloadIfResponseInvalid(e);r.loadNextsContactsAlreadyActive=!1,a()},error:function(e,t,a){"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),""!==a&&0!==e.status&&jPar.util.log.error(e.status+" - "+a,"Messenger: updateContactList loadNextContacts failed")),r.loadNextsContactsAlreadyActive=!1}})}})},isLoadPreviousContactsNeeded:function(){var e=$j(".contactswrapper .dummy").last();if(void 0!==e&&0<e.length){var t=!1;if(jPar.wdk.screensize.isBreakpoint(["S","M"])){var a=e.offset().top+e.outerHeight();t=$j(window).scrollTop()+10<a}else if(jPar.wdk.screensize.isBreakpoint(["L","XL"])){t=10<e.position().top+e.outerHeight()}return t}return!1},loadPreviousContacts:function(){var t=this,i=this;return new Promise(function(r){if(t.loadPreviousContactsAlreadyActive)r();else{t.loadPreviousContactsAlreadyActive=!0;var e=$j(".contactswrapper .dummy").children().length;$j.ajax({type:"GET",url:"/messenger/contactsprevious?firstPosition="+e,success:function(e){if(!0===jPar.util.network.hasValidSessionAndCsrfToken(e)){var t=$j.parseHTML(e.trim()),a=$j(t.reverse()).filter("a");i.offscreenRenderingForContactList(function(){$j(a).each(function(){jPar.app.messenger.contactArea.removeContact($j(this).data("partnerUserId")),$j(".contactswrapper .innerListWrapper .dummy").last().remove();var e=$j(".contactswrapper .innerListWrapper .dummy").last();0<e.length?e.after($j(this)):$j(".contactswrapper .innerListWrapper").prepend($j(this))})}),jPar.wdk.screensize.isBreakpoint(["L","XL"])&&jPar.app.messenger.contactArea.setActiveContact(jPar.app.messenger.activePartnerUserId)}else jPar.util.network.reloadIfResponseInvalid(e);i.loadPreviousContactsAlreadyActive=!1,r()},error:function(e,t,a){"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),""!==a&&0!==e.status&&jPar.util.log.error(e.status+" - "+a,"Messenger: updateContactList loadPreviousContacts failed")),i.loadPreviousContactsAlreadyActive=!1}})}})},updateContactlistForActiveContact:function(a){var r=this;return new Promise(function(e,t){0<$j(".contactswrapper .dummy").length?($j(".innerListWrapper a").remove(),jPar.wdk.screensize.isBreakpoint(["S","M"])?$j(document).scrollTop(0):$j("#contactList").scrollTop(0),$j("#hasMoreContacts").removeClass("noDisplay"),r.fillViewportWithContacts().then(function(){e()}).catch(function(){t(new Error("Error"))})):jPar.app.messenger.contactArea.updateContactItem(jPar.app.messenger.activePartnerUserId).then(function(){a&&jPar.app.messenger.contactArea.putContactOnTopOfList(jPar.app.messenger.activePartnerUserId)}).then(function(){jPar.app.messenger.contactArea.setActiveContact(jPar.app.messenger.activePartnerUserId,!0),e()}).catch(function(){t(new Error("Error"))})})},replaceContactWithDummyOnTopOfContactList:function(a){this.offscreenRenderingForContactList(function(){jPar.app.messenger.contactArea.removeContact(a);var e=$j("#dummyContactTemplate").html();$j("#contactList .innerListWrapper").prepend(e),$j("#contactList .innerListWrapper a").first().data("partnerUserId",a);var t=$j(".emptyPlaceholderWrapper");0<t.length&&t.remove()})},offscreenRenderingForContactList:function(e){var t=$j("#contactList").find(".contactswrapper");t.hide(),e(),t.css("color"),t.show(),null!==jPar.app.messenger.contactArea.perfectScrollbarInstance&&jPar.app.messenger.contactArea.perfectScrollbarInstance.update()}}}),jPar.app.messenger=jPar.app.messenger||{},$j.extend(!0,jPar.app.messenger,{contactArea:{perfectScrollbarInstance:null,init:function(){$j("body").on("click","#contactList a.contactItem",function(e){e.preventDefault();var t=$j(this).data("partnerUserId");jPar.app.messenger.conversationArea.loadMessageForUser(t),jPar.app.messenger.profileArea.resetProfileArea()}),this.endlessScrolling.init(),jPar.wdk.screensize.isBreakpoint(["L","XL"])&&0<$j("html.no-touchevents").length&&(jPar.app.messenger.contactArea.perfectScrollbarInstance=new PerfectScrollbar("#contactList")),this.listenForMessageUpdates()},listenForMessageUpdates:function(){var a=this;document.querySelector("#conversationArea").addEventListener("messengerConversationArea:loadMessageForUser",function(e){var t=document.querySelector('#contactList [data-partner-user-id="'+e.detail.partnerUserId+'"]');"requestStarted"===e.detail.status?(jPar.wdk.loadingIndicator.show(t),0===t.length&&window.location.replace("/messenger?partnerUserId="+e.detail.partnerUserId)):"validResponse"===e.detail.status?(jPar.wdk.loadingIndicator.hide(t),a.setActiveContact(e.detail.partnerUserId,!0)):"requestFailed"===e.detail.status&&jPar.wdk.loadingIndicator.hide(t)}),document.querySelector("#conversationArea").addEventListener("messengerConversationArea:updateMessageCount",function(e){a.updateMessageCounters(e.detail.partnerUserId,-e.detail.currentReadMessageCount)}),document.querySelector("#conversationArea").addEventListener("messengerConversationArea:sendMessage",function(){a.endlessScrolling.updateContactlistForActiveContact(!0)})},updateMessageCounters:function(e,t){if(!$j("#contactArea").data("isSupportUser")){var a=$j('#contactList [data-partner-user-id="'+e+'"]'),r=a.find(".messageTextAndCount .count"),i=r.text();r.text(i-t),parseInt(r.text())<=0&&(a.addClass("is-read"),r.hide())}},updateContactItem:function(r){var i=this;return void 0!==r?new Promise(function(a){$j.ajax({type:"GET",url:"/messenger/contact?partnerId="+r,success:function(e){if(jPar.util.network.hasValidSessionAndCsrfToken(e)){var t=$j('.contactItem[data-partner-user-id="'+r+'"]');1===t.length&&(t.replaceWith(e),i.setActiveContact(jPar.app.messenger.activePartnerUserId,!0),jPar.app.messenger.pubNub.processReadByReceiverForContactList(),a())}},error:function(e){0!==e.status&&403!==e.status&&jPar.util.log.error("partnerId: "+r+" - "+e.status,"Messenger: updateContactItem (singleContact) failed")}})}):new Promise(function(){jPar.util.log.error("Messenger: updateContactItem failed","Messenger: updateContactItem failed. partnerId is undefined (BUG-10680) Caught_3")})},putContactOnTopOfList:function(a){var r=this;return new Promise(function(e){var t=$j('.contactItem[data-partner-user-id="'+a+'"]');$j("#contactList .contactswrapper .innerListWrapper").prepend(t),r.endlessScrolling.fillViewportWithContacts().then(function(){return e()})})},setActiveContact:function(e,t){jPar.app.messenger.activePartnerUserId=e;var a=$j("[data-partner-user-id="+jPar.app.messenger.activePartnerUserId+"]");0<a.length&&($j("#contactList a.is-active").removeClass("is-active").attr("aria-pressed","false"),a.addClass("is-active").attr("aria-pressed","true"),t&&(this.scrollActiveContactIntoViewport(),this.endlessScrolling.fillViewportWithContacts()))},removeContact:function(t){$j(".contactswrapper .innerListWrapper").children().filter("a").each(function(){var e=$j(this).data("partnerUserId");if(t===e)return $j(this).remove(),jPar.util.log.devConsole("Contact removed from DOM: "+e),!1})},scrollActiveContactIntoViewport:function(){var e=!1===$j("body").hasClass("has-conversationAreaOpen");if(void 0!==jPar.app.messenger.activePartnerUserId&&e){var t=$j("[data-partner-user-id="+jPar.app.messenger.activePartnerUserId+"]");if(!1===t.isOnScreen(function(e){return 130<=e.top&&280<=e.bottom}))if(jPar.wdk.screensize.isBreakpoint(["S","M"]))0<t.length&&void 0!==t.position()&&$j(document).scrollTop(t.position().top);else{var a=-1*($j("#contactList")[0].offsetTop-t[0].offsetTop);$j("#contactList").scrollTop(a)}}}}}),jPar.app.messenger=jPar.app.messenger||{},$j.extend(!0,jPar.app.messenger,{conversationArea:{init:function(){var t=this;jPar.app.partnerProfile.profileMenue.init(),$j("body").on("click","#conversationArea .backToContacts",function(e){e.preventDefault(),t.backToContacts()}),$j("body").on("click","#conversationArea #loadOlderMessages",function(e){e.preventDefault(),t.loadOlderMessages(e)}),$j("body").on("click","#conversationArea .preventClickOnProfileLink",function(e){e.preventDefault()}),$j("body").on("click","#profileInfo",function(e){e.preventDefault(),jPar.app.messenger.profileArea.openProfileArea()})},backToContacts:function(){$j("#contactList a.is-active").removeClass("is-active"),$j("body").removeClass("has-conversationAreaOpen has-conversationAreaOpenInitialForSM"),$j("#messagesList").removeClass("is-visible"),jPar.app.messenger.contactArea.scrollActiveContactIntoViewport(jPar.app.messenger.activePartnerUserId),0<$j("html.history").length&&history.pushState(null,null,"/messenger")},loadMessageForActivePartner:function(){jPar.app.messenger.conversationArea.loadMessageForUser(jPar.app.messenger.activePartnerUserId)},loadMessageForUser:function(r,t){var a=this;document.querySelector("#conversationArea").dispatchEvent(new CustomEvent("messengerConversationArea:loadMessageForUser",{detail:{status:"requestStarted",partnerUserId:r}})),$j.ajax({type:"GET",url:"/messenger/conversation?chiffre="+r,success:function(e){!0===jPar.util.network.hasValidSessionAndCsrfToken(e)?"string"==typeof e&&-1<e.indexOf("messagesList")?(jPar.app.messenger.activePartnerUserId=r,jPar.app.messenger.messageInteractions.delete.endDeleteMode(),$j("#conversationArea").html(e),jPar.wdk.screensize.isBreakpoint(["S","M"])?$j("body").addClass("has-conversationAreaOpen"):0<$j("html.no-touchevents").length&&new PerfectScrollbar("#messagesList"),jPar.app.messenger.messageInteractions.initForNewMessageList(),a.addClassIfClickElementBelow(),a.showMessagesList(),jPar.app.messenger.conversationArea.scrollListToFirstNewMessage(),jPar.app.messenger.pubNub.processReadByReceiverForMessageList(),document.querySelector("#conversationArea").dispatchEvent(new CustomEvent("messengerConversationArea:loadMessageForUser",{detail:{status:"validResponse",partnerUserId:r,options:t}})),document.querySelector("#conversationArea").dispatchEvent(new CustomEvent("messengerConversationArea:updateMessageCount",{detail:{partnerUserId:r,currentReadMessageCount:a.getCurrentReadMessageCount()}}))):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),jPar.util.log.error("PartnerUser: "+jPar.app.util.getGetParamFromUrl("partnerUserId")+" - "+e,"Messenger: No valid data from Ajax Call. Could not load Conversation for PartnerUser (BUG-10680)")):jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){document.querySelector("#conversationArea").dispatchEvent(new CustomEvent("messengerConversationArea:loadMessageForUser",{detail:{status:"requestFailed",partnerUserId:r}})),418===e.status?jPar.util.pwa.offline.triggerOfflineAttention(!0):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),"timeout"!==t&&0!==e.status&&jPar.util.log.error(t+" - "+a+" - partnerUserId: "+r,"Messenger: Could not load Conversation for PartnerUser (Ajax Error)"))}})},loadOlderMessages:function(e){var a=this,r=$j(e.currentTarget);jPar.wdk.loadingIndicator.show(r);var t=$j("#messagesList").data("olderMessagesUrl"),i=$j("#messagesList .messageRow").first().data("messageTimestamp");$j.ajax({type:"GET",url:t+"&timestamp="+i,success:function(e){if(jPar.wdk.loadingIndicator.hide(r),!0===jPar.util.network.hasValidSessionAndCsrfToken(e)){var t=$j("#messagesList")[0].scrollHeight;$j("#messagesList #loadOlderMessages").remove(),$j("#messagesList > ul").prepend(e),a.cleanupDateGroups(),jPar.app.messenger.messageInteractions.swiperInMessages.init(),a.removeAllButLastTextPremiumTeaser(),a.addClassIfClickElementBelow(),a.setNewScrollPosition(t),document.querySelector("#conversationArea").dispatchEvent(new CustomEvent("messengerConversationArea:updateMessageCount",{detail:{partnerUserId:jPar.app.messenger.activePartnerUserId,currentReadMessageCount:a.getCurrentReadMessageCount()}})),jPar.app.messenger.messageInteractions.trackPicturePremiumTeaser.view(),jPar.util.log.ui("Messenger","messageList","Older Messages loaded")}else jPar.util.network.reloadIfResponseInvalid(e)},error:function(e,t,a){jPar.wdk.loadingIndicator.hide(r),"timeout"===t?jPar.wdk.toast.show("#timeoutNotification"):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),0!==e.status&&403!==e.status&&jPar.util.log.error(e.status+" - "+a,"Messenger: loadOlderMessages failed"))}})},loadNewerMessages:function(t){var a=this,r=$j("#messagesList").data("newerMessagesUrl"),e=$j("#messagesList li.messageRow").last().data("messageTimestamp");void 0===e&&(e=0),$j.ajax({type:"GET",url:r+"&timestamp="+e,success:function(e){!0===jPar.util.network.hasValidSessionAndCsrfToken(e)&&($j("#messagesList > ul").append(e),$j("#messagesList .messageRow[data-is-new-message=true]").addClass("fade-in").data("isNewMessage",!1),a.cleanupDateGroups(),jPar.app.messenger.messageInteractions.swiperInMessages.init(),a.removeAllButLastTextPremiumTeaser(),a.addClassIfClickElementBelow(),a.scrollListToBottom(),a.updateOtherMessageButtons(e),a.updateMessagingBox(),$j("#allMessagesDeleted").hide(),"function"==typeof t&&t())},error:function(e,t,a){"timeout"===t||0!==e.status&&403!==e.status&&jPar.util.log.error(e.status+" - "+a+" - url: "+r,"Messenger: loadNewerMessages failed")}})},removeAllButLastTextPremiumTeaser:function(){$j('li[id^="msg_"] .is-premiumFeature:not(:last)').remove()},updateOtherMessageButtons:function(e){-1===e.indexOf('data-message-type="text"')&&$j.ajax({type:"GET",url:$j("#otherMessageButtons").data("reloadUrl"),cache:!1,success:function(e){-1<e.indexOf("otherMessageButtonsInner")&&$j("#otherMessageButtonsInner").replaceWith(e)},error:function(){}})},updateMessagingBox:function(){var e=$j("#messagesList");if(void 0!==e.attr("data-is-annoyance-limit-reached")){e.removeAttr("data-is-annoyance-limit-reached"),$j("#messagingBox").addClass("is-allowedToSendMessage");var t=$j("#messagingBox textarea"),a=t.data("purchase-url");(""===a||void 0===a)&&t.prop("readonly",!1)}},showMessagesList:function(){$j("#messagesList").css("color"),$j("#messagesList").addClass("is-visible")},addClassIfClickElementBelow:function(){$j("#messagesList .messageActions").prev().addClass("has-clickElementBelow"),$j("#messagesList li .messageContent").removeClass("has-premiumElementBelow"),$j("#messagesList .is-premiumFeature").prev().addClass("has-premiumElementBelow")},scrollListToFirstNewMessage:function(){if(0<$j(".messageRow[data-is-new-message=true]").length){var e=$j(".messageRow[data-is-new-message=true]").first().offset();jPar.wdk.screensize.isBreakpoint(["S","M"])?$j(document).scrollTop(e.top-50):$j("#messagesList").scrollTop(e.top-166)}else this.scrollListToBottom(),jPar.util.setFocusOnFirstFocusableElement($j("#messageInteractions").find("*"))},scrollListToBottom:function(){var e=$j("#messagesList")[0].scrollHeight;jPar.wdk.screensize.isBreakpoint(["S","M"])?$j(document).scrollTop(e):$j("#messagesList").scrollTop(e)},setNewScrollPosition:function(e){var t=$j("#messagesList")[0].scrollHeight-e,a=$j("#messagesList").scrollTop()+t;jPar.wdk.screensize.isBreakpoint(["S","M"])?$j(document).scrollTop(a):$j("#messagesList").scrollTop(a)},cleanupDateGroups:function(){$j("#messagesList h5").each(function(){var e=$j(this),t=e.nextAll("h5"),a=0===e.next().length,r=!e.next().is('li[id^="msg_"]');if(a||r)e.remove();else{var i=0<t.length,o=e.html()===t.first().html();i&&o&&t.first().remove()}})},getCurrentReadMessageCount:function(){var t=0;return $j('#messagesList .messageRow[data-is-new-message="true"].is-partnerMessage').each(function(){var e=$j(this);0===e.find(".is-blurredText").length&&(e.attr("data-is-new-message","false"),t++)}),-t},toggleLayoutOnResize:function(e){if(jPar.wdk.screensize.isBreakpoint(["M"])&&"S"!==e){var t=jPar.app.messenger.activePartnerUserId;void 0!==t&&jPar.app.messenger.conversationArea.loadMessageForUser(t)}else jPar.wdk.screensize.isBreakpoint(["L"])&&"XL"!==e&&$j("body").removeClass("has-conversationAreaOpen")}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{messenger:{activePartnerUserId:void 0,lastScreenSize:null,init:function(){this.setEventForUnhandledRejection(),this.lastScreenSize=jPar.wdk.screensize.getCurrentScreenSize(),this.activePartnerUserId=jPar.app.util.getGetParamFromUrl("partnerUserId"),this.contactArea.init(),this.conversationArea.init(),this.messageInteractions.init(),this.pubNub.init(),this.profileArea.init(),this.historyState.init(),this.showNotifications(),jPar.wdk.countdownClock.start("#bannerInContent"),this.setResizeEvent(),this.loadWdcCombined()},initSupercard:function(){this.setEventForUnhandledRejection(),this.conversationArea.init(),this.messageInteractions.init(),this.pubNub.init(),this.loadWdcCombined()},historyState:{init:function(){var e=this;e.updatePageFromUrl(),jPar.app.util.initPopState(function(){e.updatePageFromUrl()},".messenger"),e.onUpdateUrlEvent()},onUpdateUrlEvent:function(){var t=this;document.querySelector("#conversationArea").addEventListener("messengerConversationArea:loadMessageForUser",function(e){"validResponse"===e.detail.status&&t.updateUrl(e.detail.partnerUserId,e.detail.options)})},updateUrl:function(e,t){var a=jPar.app.util.getGetParamFromUrl("partnerUserId"),r=-1<document.location.href.indexOf("partnerUserId");if(!1===r||r&&a!==e){var i=!1;void 0!==t&&!0===t.preventPushstate&&(i=!0),0<$j("html.history").length&&!1===i&&history.pushState(null,null,"/messenger?partnerUserId="+e)}},updatePageFromUrl:function(){jPar.app.messenger.profileArea.resetProfileArea(),0<$j(".icebreakerResultModal.is-open").length&&jPar.wdk.modalbox.hide();var e=jPar.app.util.getGetParamFromUrl("partnerUserId");-1<document.location.href.indexOf("partnerUserId")?jPar.app.messenger.conversationArea.loadMessageForUser(e,{preventPushstate:!0}):jPar.wdk.screensize.isBreakpoint(["S","M"])&&($j("#contactList a.is-active").removeClass("is-active"),$j("body").removeClass("has-conversationAreaOpen"))}},showNotifications:function(){jPar.app.util.getGetParamFromUrl("rejected")&&jPar.wdk.toast.show("#rejectContactSuccessful"),jPar.app.util.getGetParamFromUrl("deleted")&&jPar.wdk.toast.show("#deleteContactSuccessful")},setResizeEvent:function(){var e=this;$j(window).on("resize",function(){jPar.wdk.screensize.getCurrentScreenSize()!==e.lastScreenSize&&(e.contactArea.endlessScrolling.setEndlessScrollEventListener(),e.conversationArea.toggleLayoutOnResize(e.lastScreenSize),e.lastScreenSize=jPar.wdk.screensize.getCurrentScreenSize(),"L"!==e.lastScreenSize&&"XL"!==e.lastScreenSize||jPar.app.messenger.contactArea.scrollActiveContactIntoViewport(jPar.app.messenger.activePartnerUserId)),e.messageInteractions.swiperInMessages.init()})},setEventForUnhandledRejection:function(){window.addEventListener("unhandledrejection",function(e){e.preventDefault(),"TypeError: Failed to fetch"===e.reason.stack||void 0!==e&&(void 0!==e.reason&&void 0!==e.reason.stack&&""!==e.reason.stack?jPar.util.log.error(e.reason.stack,"Messenger: unhandledrejection (event.reason.stack) Caught_2"):void 0!==e.reason&&void 0!==e.reason.message&&jPar.util.log.error(e.reason.message,"Messenger: unhandledrejection (event.reason.message) Caught_2"))})},loadWdcCombined:function(){!0!==window.isWdcCombinedLoading&&(window.isWdcCombinedLoading=!0,jPar.util.loadScript("wdc_combined"))}}}),jPar.app.messenger.messageInteractions=jPar.app.messenger.messageInteractions||{},$j.extend(!0,jPar.app.messenger.messageInteractions,{delete:{init:function(){this.setEventsForProfileMenu(),this.setModalEvents(),this.setEventsForInDeleteMode()},setEventsForProfileMenu:function(){$j("body").on("click","#profileMenuList #deleteMessages",function(e){e.preventDefault(),jPar.app.partnerProfile.profileMenue.close(),$j("#conversationArea").addClass("is-deleteMode")}),$j("body").on("click","#profileMenuList #deleteMessageHistory",function(e){e.preventDefault(),jPar.app.partnerProfile.profileMenue.close(),jPar.wdk.modalbox.show({modalboxId:"askDeleteMessageHistoryModal"})})},setModalEvents:function(){var t=this;$j("body").on("click","#askDeleteMessageHistoryModal .reallyDeleteMessageHistory",function(e){e.preventDefault(),t.reallyDeleteMessageHistory(e)}),$j("body").on("click","#askDeleteMessagesModal .reallyDeleteMessages",function(e){e.preventDefault(),t.reallyDeleteMessages(e)})},setEventsForInDeleteMode:function(){var t=this;$j("body").on("click","#conversationArea header #abortDeleteMode",function(e){e.preventDefault(),t.endDeleteMode()}),$j("body").on("click","#conversationArea .deleteCheckbox input",function(){t.updateSelectedMessageCount(),t.toggleDeleteButton(),t.updateToggleAllButton()}),$j("body").on("click","#conversationArea .deleteAllCheckbox input",function(){t.toggleSelectAll(),t.updateSelectedMessageCount(),t.toggleDeleteButton()}),$j("body").on("click","#conversationArea #askDeleteMessages:not(.disabled)",function(e){e.preventDefault(),jPar.wdk.modalbox.show({modalboxId:"askDeleteMessagesModal"})})},endDeleteMode:function(){$j("#conversationArea .deleteCheckbox input").prop("checked",!1),$j("#conversationArea").removeClass("is-deleteMode")},reallyDeleteMessages:function(e){var t=this,r=$j(e.currentTarget),a=$j(e.currentTarget).hasClass("editDraft"),i=0<$j(e.currentTarget).parents("#askDeleteDraftModal").length,o=this.getCheckedMessageIds();!1===a&&jPar.wdk.loadingIndicator.show(r),$j.ajax({type:"POST",url:"/messenger/delete",data:{_csrf:jPar.wdk.security.getCsrfToken(),partnerId:jPar.app.messenger.activePartnerUserId,messageIds:o},success:function(e){jPar.wdk.loadingIndicator.hide(r),!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):(t.updateTopNaviCounterAfterDelete(!0),!1===a&&(jPar.wdk.modalbox.hide(),!0===i?jPar.app.messenger.messageInteractions.conf.showDeleteDraftSuccess=!0:jPar.app.messenger.messageInteractions.conf.showDeleteSuccess=!0,t.endDeleteMode()),jPar.app.messenger.conversationArea.loadMessageForActivePartner(),jPar.app.messenger.contactArea.updateContactItem(jPar.app.messenger.activePartnerUserId))},error:function(e,t,a){jPar.wdk.loadingIndicator.hide(r),"timeout"===t?jPar.wdk.forms.showError($j(".requestTimeoutDeleteMessages")):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),0!==e.status&&403!==e.status&&jPar.util.log.error(e.status+" - "+a,"Messenger: deleteMessage failed"))}})},getCheckedMessageIds:function(){var a="";return $j("#conversationArea .deleteCheckbox input:checked").each(function(e){var t="";0<e&&(t=","),a+=t+$j(this).val()}),a},reallyDeleteMessageHistory:function(e){var t=this,r=$j(e.currentTarget);jPar.wdk.loadingIndicator.show(r),$j.ajax({type:"POST",url:"/messenger/delete/all",data:{_csrf:jPar.wdk.security.getCsrfToken(),partnerId:jPar.app.messenger.activePartnerUserId},success:function(e){jPar.wdk.loadingIndicator.hide(r),!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.util.network.reloadIfResponseInvalid(e):(jPar.wdk.modalbox.hide(),t.updateTopNaviCounterAfterDelete(!1),jPar.app.messenger.conversationArea.loadMessageForActivePartner(),jPar.app.messenger.contactArea.updateContactItem(jPar.app.messenger.activePartnerUserId),jPar.app.messenger.messageInteractions.conf.showDeleteSuccess=!0,jPar.util.log.ui("Messenger","delete","deleteMessageHistory called"))},error:function(e,t,a){jPar.wdk.loadingIndicator.hide(r),"timeout"===t?jPar.wdk.forms.showError($j("#requestTimeoutDeleteMessageHistory")):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),0!==e.status&&403!==e.status&&jPar.util.log.error(e.status+" - "+a,"Messenger: deleteMessageHistory failed"))}})},toggleSelectAll:function(){var e=0<$j("#conversationArea .deleteAllCheckbox input:checked").length,t=$j("#conversationArea .deleteCheckbox input");e?t.prop("checked",!0):t.prop("checked",!1)},toggleDeleteButton:function(){0<$j("#conversationArea .deleteCheckbox input:checked").length?$j("#askDeleteMessages").removeClass("disabled"):$j("#askDeleteMessages").addClass("disabled")},updateToggleAllButton:function(){var e=$j("#conversationArea .deleteAllCheckbox input"),t=$j("#conversationArea .deleteCheckbox input");t.filter(":checked").length<t.length?e.prop("checked",!1):e.prop("checked",!0)},updateSelectedMessageCount:function(){var e=0;$j("#conversationArea .deleteCheckbox input").each(function(){$j(this).prop("checked")&&e++}),$j("#deleteActions .selectedCount").text(e)},updateTopNaviCounterAfterDelete:function(t){var a=0;$j(".messageRow.is-partnerMessage").each(function(){var e=0<$j(this).find(".messageText.is-blurredText").length;t?0<$j(this).find(".deleteCheckbox input:checked").length&&e&&a++:e&&a++}),document.querySelector("#conversationArea").dispatchEvent(new CustomEvent("messengerConversationArea:updateMessageCount",{detail:{partnerUserId:jPar.app.messenger.activePartnerUserId,currentReadMessageCount:-a}}))}}}),jPar.app.messenger.messageInteractions=jPar.app.messenger.messageInteractions||{},$j.extend(!0,jPar.app.messenger.messageInteractions,{draft:{myUserId:null,init:function(){var t=this;this.myUserId=$j("#domPageVars").data("userId"),$j("body").on("click","#messagesList .editDraft",function(e){e.preventDefault(),t.startEditDraft(e)}),$j("body").on("click","#messagesList .deleteDraft",function(e){e.preventDefault(),t.openAskDeleteDraftModal(e)}),$j("body").on("click","#askDeleteDraftModal .reallyDeleteMessages",function(e){e.preventDefault(),jPar.app.messenger.messageInteractions.delete.reallyDeleteMessages(e)})},prefillTextrareaWithLocalStorage:function(){var e=0===$j("#messagingBox textarea[readonly]").length;if(0<$j("html.localstorage").length&&e){var t=localStorage.getItem(this.myUserId+"_draft_for_"+jPar.app.messenger.activePartnerUserId);null!==t&&($j("#messagingBox").find("textarea").val(t),this.simulateRealUserInput(),$j("#allMessagesDeleted").hide())}},startEditDraft:function(e){var t=$j(e.currentTarget);this.fillTextarea(t),this.saveInLocalStorage(),this.simulateRealUserInput(),this.deleteDraftFromServer(t,e),jPar.util.log.ui("Messenger","messageList","Edit Draft")},fillTextarea:function(e){var t=e.parents(".messageRow").find(".messageText p"),a="";0<t.find(".subject").length&&(a=t.find(".subject")[0].innerHTML+"<br>");var r=t.find(".body")[0].innerHTML,i=jPar.app.util.replaceBrWithLinebreak(a+r);$j("#messagingBox").find("textarea").val(i)},saveInLocalStorage:function(){0<$j("html.localstorage").length&&(0<$j("#messagingBox").find("textarea").val().length?localStorage.setItem(this.myUserId+"_draft_for_"+jPar.app.messenger.activePartnerUserId,$j("#messagingBox").find("textarea").val()):this.deleteDraftFromLocalStorage())},simulateRealUserInput:function(){jPar.util.putCursorAtEnd($j("#writeMessageForm textarea")),window.setTimeout(function(){$j("#writeMessageForm textarea").trigger("click"),$j("#writeMessageForm textarea").trigger("keyup")},100)},openAskDeleteDraftModal:function(e){$j(e.currentTarget).parents(".messageRow").find(".deleteCheckbox input").prop("checked",!0),jPar.wdk.modalbox.show({modalboxId:"askDeleteDraftModal"})},deleteDraftFromLocalStorage:function(){0<$j("html.localstorage").length&&localStorage.removeItem(this.myUserId+"_draft_for_"+jPar.app.messenger.activePartnerUserId)},deleteDraftFromServer:function(e,t){var a=e.parents(".messageRow");a.find(".deleteCheckbox input").prop("checked",!0),a.one("transitionend",function(){jPar.app.messenger.messageInteractions.delete.reallyDeleteMessages(t)}),a.addClass("has-hideAnimation")}}}),jPar.app.messenger=jPar.app.messenger||{},$j.extend(!0,jPar.app.messenger,{messageInteractions:{conf:{showDeleteSuccess:!1,showDeleteDraftSuccess:!1},mouseX:0,mouseY:0,init:function(){this.setEventsForTextMessaging(),this.setEventsForImageRelease(),this.setEventsForSmile(),this.setEventsForRejection(),this.setEventsForIcebreaker(),this.eventsForPremiumFeatures(),this.draft.init(),this.delete.init(),this.favorite.init(),$j("body").on("click","#messagingErrors .wdk-styledHintBox.is-visible .closeX",function(e){e.preventDefault(),$j(this).parents(".wdk-styledHintBox").removeClass("is-visible").attr("inert","true").attr("aria-hidden","true")})},eventsForPremiumFeatures:function(){var a=this;$j("body").on("click",".messageContent.has-premiumElementBelow:not(.is-imageReleaseBubble)",function(){var e=$j(".is-premiumFeature").attr("href");void 0!==e&&(window.location.href=e)}),$j("body").on("mousedown",".messageContent.has-premiumElementBelow.is-imageReleaseBubble",function(e){a.mouseX=e.clientX,a.mouseY=e.clientY}).on("mouseup",".messageContent.has-premiumElementBelow",function(e){if(Math.abs(a.mouseX-e.clientX)<5&&Math.abs(a.mouseY-e.clientY)<5){var t=$j(".is-premiumFeature").attr("href");void 0!==t&&(a.trackPicturePremiumTeaser.click(),window.location.href=t)}}),$j("body").on("click","#pictureTeaser a",function(){a.trackPicturePremiumTeaser.click()})},initForNewMessageList:function(){jPar.wdk.forms.init("#writeMessageForm"),this.draft.prefillTextrareaWithLocalStorage(),this.conf.showDeleteSuccess?(jPar.wdk.toast.show("#deleteSuccess"),this.conf.showDeleteSuccess=!1):this.conf.showDeleteDraftSuccess&&(jPar.wdk.toast.show("#deleteDraftSuccess"),this.conf.showDeleteDraftSuccess=!1),this.swiperInMessages.init(),this.showIcebreakerResultModalbox(),this.initUiLogging(),this.setInitialTextareaHeight(),this.trackPicturePremiumTeaser.view()},swiperInMessages:{init:function(){void 0!==dragscroll&&dragscroll.reset()}},showIcebreakerResultModalbox:function(){if(0<$j("html.localstorage").length&&null!==localStorage.getItem("openIcebreakerInMessenger")){var e=localStorage.getItem("openIcebreakerInMessenger"),t=$j('[data-icebreaker-id="'+e+'"]');if(0<t.length){t.trigger("click");var a=document.location.pathname+document.location.search;history.pushState(null,null,"".concat(a,"&icebreakerOpen=true")),localStorage.removeItem("openIcebreakerInMessenger")}}},initUiLogging:function(){$j(".openProfilemenu").on("click",function(){$j("html").hasClass("has-openProfileMenu")||jPar.util.log.ui("Messenger","profileMenu","menu open clicked")}),$j("#profileMenuList #giveAlias").on("click",function(){jPar.util.log.ui("Messenger","profileMenu","giveAlias clicked")}),$j("#profileMenuList #editAlias").on("click",function(){jPar.util.log.ui("Messenger","profileMenu","editAlias clicked")}),$j("#profileMenuList #unreleasePhotos").on("click",function(){jPar.util.log.ui("Messenger","profileMenu","unreleasePhotos clicked")}),$j("#profileMenuList #deleteMessages").on("click",function(){jPar.util.log.ui("Messenger","profileMenu","deleteMessages clicked")}),$j("#profileMenuList #deleteMessageHistory").on("click",function(){jPar.util.log.ui("Messenger","profileMenu","deleteMessageHistory clicked")}),$j("#profileMenuList #rejectContact").on("click",function(){jPar.util.log.ui("Messenger","profileMenu","rejectContact clicked")}),$j("#profileMenuList #rejectProfile").on("click",function(){jPar.util.log.ui("Messenger","profileMenu","rejectProfile clicked")}),$j("#profileMenuList #removeContact").on("click",function(){jPar.util.log.ui("Messenger","profileMenu","removeContact clicked")}),$j("#profileMenuList #reportProfile").on("click",function(){jPar.util.log.ui("Messenger","profileMenu","reportProfile clicked")})},setInitialTextareaHeight:function(){var e=$j("#writeMessageForm textarea").prop("scrollHeight");$j("#writeMessageForm textarea").css("height",e+"px")},setEventsForTextMessaging:function(){var t=this;$j("body").on("click","#writeMessageForm textarea",function(){t.handleMessagingNotAllowedReasons($j(this))}),jPar.wdk.screensize.isBreakpoint(["S"])&&($j("body").on("focus","#writeMessageForm textarea",function(){$j("#otherMessageButtons").addClass("noDisplay")}),$j("body").on("blur","#writeMessageForm textarea",function(){$j("#otherMessageButtons").removeClass("noDisplay")})),$j(".ios body").on("focus","#writeMessageForm textarea",function(){jPar.wdk.screensize.isBreakpoint(["S","M"])&&$j(".has-conversationAreaOpen #messageInteractions, .has-conversationAreaOpenInitialForSM  #messageInteractions").css("position","absolute")}),$j(".ios body").on("blur","#writeMessageForm textarea",function(){jPar.wdk.screensize.isBreakpoint(["S","M"])&&$j(".has-conversationAreaOpen #messageInteractions, .has-conversationAreaOpenInitialForSM  #messageInteractions").css("position","fixed")}),$j("body").on("click","#writeMessageForm textarea[readonly]",function(){$j(this)[0].blur()}),$j("body").on("input keyup","#writeMessageForm textarea",function(){t.toggleSendButton(),t.draft.saveInLocalStorage()}),$j("body").on("click","#writeMessageForm #sendTextMessage",function(e){e.preventDefault(),t.sendText()}),$j("body").on("input","#writeMessageForm textarea",function(){t.setHeightForTextarea($j(this))})},setEventsForImageRelease:function(){var t=this;$j("body").on("click","#sendImageRelease",function(){t.sendImageRelease()}),$j("body").on("click","#messagesList a.releaseImage",function(){t.sendImageRelease()}),$j("body").on("click","#messagesList .is-partnerMessage .js-openGallery",function(e){jPar.wdk.screensize.isBreakpoint(["L","XL"])?(e.preventDefault(),jPar.app.messenger.profileArea.openProfileAreaWithGallery(!0)):void 0!==$j(this).data("linkForSm")&&($j(this)[0].hasAttribute("href")?($j(this).attr("href",$j(this).data("linkForSm")),$j(this).removeAttr("data-link-for-sm")):document.location.href=$j(this).data("linkForSm"))}),$j("body").on("click","#imageUnreleaseButton",function(e){e.preventDefault(),t.sendImageUnrelease(),jPar.app.partnerProfile.profileMenue.close()})},setEventsForSmile:function(){var e=this;$j("body").on("click","#sendSmile",function(){e.sendSmile()}),$j("body").on("click","#messagesList #sendSmileBack",function(){e.sendSmileBack()})},setEventsForRejection:function(){$j("body").on("click","#messagesList .removeContact",function(e){e.preventDefault(),jPar.app.partnerProfile.profileMenue.removeContact()})},setEventsForIcebreaker:function(){$j("body").on("click","#messageInteractions .js-sendIcebreaker",function(e){e.preventDefault(),jPar.app.sharedFeatures.icebreaker.play.openLayer(e)}),$j("body").on("click","#messagesList .js-answerIcebreaker",function(e){e.preventDefault(),jPar.app.sharedFeatures.icebreaker.play.openLayer(e)}),$j("body").on("click","#messagesList .js-resultIcebreaker",function(e){e.preventDefault(),jPar.app.sharedFeatures.icebreaker.result.openLayer(e)})},handleMessagingNotAllowedReasons:function(e){var t=void 0!==e.data("purchaseUrl"),a="true"===$j("#messagesList").attr("data-is-annoyance-limit-reached"),r=0<$j(".profileCompleteness").length;if(t)window.location.href=e.data("purchaseUrl");else if(a)jPar.wdk.modalbox.show({modalboxId:"annoyanceLimitPerContactModalbox"});else if(r)jPar.wdk.modalbox.show({modalboxId:"profileCompletenessLayer"});else{var i=$j("#messagesList").height(),o=$j("#messagesList").scrollTop(),n=$j("#messagesList").height();$j("#messagesList").scrollTop(o+i-n)}},toggleSendButton:function(){var e=$j("#sendTextMessageDisabled"),t=$j("#sendTextMessage");!1===jPar.util.validate.textfieldIsEmpty($j("#writeMessageForm textarea"))?(t.removeClass("noDisplay"),e.addClass("noDisplay")):(t.addClass("noDisplay"),e.removeClass("noDisplay"))},setHeightForTextarea:function(e){!1===e.prop("readonly")&&(e.css("height","5px"),e.css("height",e.prop("scrollHeight")+"px"))},sendText:function(){var e=$j("#writeMessageForm");!1===jPar.util.validate.textfieldIsEmpty($j("#writeMessageForm textarea"))&&this.sendMessage(e)},sendImageRelease:function(){this.sendMessage($j("#writeImageReleaseForm"))},sendImageUnrelease:function(){this.sendMessage($j("#writeImageUnreleaseForm"))},sendSmile:function(){this.sendMessage($j("#writeSmileForm"))},sendSmileBack:function(){this.sendMessage($j("#writeSmileBackForm"))},sendMessage:function(t){var a=this,r=t.find("button"),i=t.find("[name=partnerChiffre]").val();this.resetNonBlockingErrors($j("#messagingErrors")),jPar.wdk.loadingIndicator.show(r),$j.ajax({type:"POST",url:t.attr("action"),data:t.serialize(),success:function(e){a.isValidSuccessResponse(e)?(jPar.wdk.loadingIndicator.stopTimer(),"writeMessageForm"===t.attr("id")&&a.draft.deleteDraftFromLocalStorage(),jPar.app.messenger.conversationArea.loadMessageForActivePartner(),document.querySelector("#conversationArea").dispatchEvent(new CustomEvent("messengerConversationArea:sendMessage",{detail:{status:"validResponse",partnerUserId:i}}))):(jPar.wdk.loadingIndicator.hide(r),a.handleErrorCodes(e))},error:function(e,t,a){jPar.wdk.loadingIndicator.hide(r),403===e.status?location.reload():"timeout"===t?jPar.wdk.forms.showError($j("#requestTimeout")):(jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),""!==a&&jPar.util.log.error(e.status+" - "+a,"Messenger: sendMessage errorThrown"))}})},isValidSuccessResponse:function(e){try{return"object"===_typeof(e)&&void 0!==e.writeMessageResponse&&!0===e.writeMessageResponse.success}catch(e){return jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error(e,"jPar.app.messenger.messageInteractions: sendMessage Ajax-Success-Handling failed"),!1}},hasErrorCodes:function(e){return void 0!==e.writeMessageResponse&&0<e.writeMessageResponse.errorCodes.length},handleErrorCodes:function(e){jPar.util.network.hasValidSessionAndCsrfToken(e)&&this.hasErrorCodes(e)?this.showErrorsForCodes(e.writeMessageResponse.errorCodes):this.handleInvalidResponse(e)},showErrorsForCodes:function(e){jQuery.each(e,function(e,t){0<$j("#"+t).length?jPar.wdk.forms.showError($j("#"+t)):(jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error("errorCode: "+t,"Messenger: sendMessage unknown errorCode"))})},handleInvalidResponse:function(e){!1===jPar.util.network.hasValidSessionAndCsrfToken(e)?jPar.wdk.forms.showError($j("#sessionExpiredOnSend")):!1===this.hasErrorCodes(e)?(jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error(JSON.stringify(e),"Messenger: sendMessage no errorCodes provided (BUG-10680) Caught_6")):(jPar.wdk.forms.showError($j("#panicIDontKnowWhatHappenedError")),jPar.util.log.error("errorOnSubmit - reallyBadError","Messenger: sendMessage reallyBadError"))},resetNonBlockingErrors:function(e){e.find('.wdk-styledHintBox[class*=" t-error"]').not(".js-submitBlocking").each(function(){jPar.wdk.forms.hideError($j(this))})},favorite:{init:function(){var t=this;$j("body").on("click","#removeFavoriteMessengerProfile, #favoriteMessengerProfile",function(e){e.preventDefault(),e.stopPropagation(),t.onClickFavorite(e)})},onClickFavorite:function(e){var t=this,a=e.target;jPar.wdk.loadingIndicator.show(a),jPar.app.ajaxCommands.favoriteToggle(a).then(function(e){"addFavorite"===e?t.handleAddFavorite(a):"removeFavorite"===e&&t.handleRemoveFavorite(a)},function(e){t.handleReject(a,e.message)})},handleAddFavorite:function(e){jPar.wdk.loadingIndicator.hide(e),document.querySelector("#conversationArea #conversationHeader").classList.add("is-favorite"),document.querySelector("#contactList .contactItem.is-active").classList.add("is-favorite"),document.querySelector("#favoriteMessengerButton").classList.add("is-favorite"),jPar.wdk.toast.show("#favoriteProfileSuccess"),jPar.app.partnerProfile.profileMenue.close()},handleRemoveFavorite:function(e){jPar.wdk.loadingIndicator.hide(e),document.querySelector("#conversationArea #conversationHeader").classList.remove("is-favorite"),document.querySelector("#contactList .contactItem.is-active").classList.remove("is-favorite"),document.querySelector("#favoriteMessengerButton").classList.remove("is-favorite"),jPar.wdk.toast.show("#unfavoriteProfileSuccess"),jPar.app.partnerProfile.profileMenue.close()},handleReject:function(e,t){jPar.wdk.loadingIndicator.hide(e),"successFalse"===t&&jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"}),"sessionExpired"===t&&jPar.util.network.reloadForSessionExpired(),"browserTimeout"===t&&jPar.wdk.toast.show("#timeoutNotification"),"genericError"===t&&jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"})}},trackPicturePremiumTeaser:{view:function(){null!==document.getElementById("pictureTeaser")&&jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"communication",subcategory:"chat_screen",action:"view",targetId:"teaser_blurred_pictures"})},click:function(){jPar.util.customEvent.trigger("pegLogger-logWebAppEvents",{category:"communication",subcategory:"chat_screen",action:"click",targetId:"teaser_blurred_pictures"})}}}}),jPar.app.messenger=jPar.app.messenger||{},$j.extend(!0,jPar.app.messenger,{profileArea:{init:function(){var t=this;$j("body").on("click",".profileInfoClose",function(e){e.preventDefault(),t.resetProfileArea()}),$j(window).on("message",function(e){var t=e.originalEvent.data;"likeOnPartnerProfile"===t?jPar.app.messenger.conversationArea.loadMessageForActivePartner():"partnerProfilePage"===t.domLoaded?jPar.wdk.loadingIndicator.hide($j(".profileAreaWrapper")):"loginPage"===t.domLoaded?location.replace(window.location.href):t.redirect&&location.replace(t.redirect)})},loadProfile:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=$j("#conversationHeader").attr("href");$j("#profileArea .profileInfoHeader").attr("href",t);var a=t+"&openedInMessenger";jPar.wdk.loadingIndicator.show($j(".profileAreaWrapper")),e&&(a+="&showGallery"),$j("#profileArea iframe")[0].contentWindow.frames.location.replace(a)},showProfileArea:function(){$j("html").addClass("openProfileArea"),jPar.util.log.ui("Messenger","profileInfo","opened")},hideProfileArea:function(){$j("html").removeClass("openProfileArea")},resetProfileArea:function(){$j("#profileArea iframe").attr("src","about:blank"),this.hideProfileArea()},openProfileArea:function(){this.showProfileArea(),this.loadProfile()},openProfileAreaWithGallery:function(){this.showProfileArea(),this.loadProfile(!0)}}}),jPar.app.messenger=jPar.app.messenger||{},$j.extend(!0,jPar.app.messenger,{pubNub:{pubNubConnection:null,notProcessedReadByReceiverId:null,init:function(){var e=this,t=$j("#contactArea").data("pubNubSubscriberKey");null===this.pubNubConnection&&t&&jPar.util.loadScript("pubnub_combined",function(){e.pubNubConnection=new PubNub({subscribeKey:t,ssl:!0,heartbeatInterval:0,suppressLeaveEvents:!0}),e.onSubscribe()})},onSubscribe:function(){var i=this,e=$j("#contactArea").data("pubNubChannelId");this.pubNubConnection.subscribe({channels:[e]}),this.pubNubConnection.addListener({status:function(e){0<$j("#messengerPage").length&&("PNConnectedCategory"===e.category||"PNAccessDeniedCategory"===e.category&&jPar.util.log.error(e.category,"PubNubError"))},message:function(e){var t="RECEIVED"===e.message.messengerAppNotificationType,a="REJECTION_MESSAGE_WITHOUT_TEXT"===e.message.messengerAppNotificationType,r="READ_BY_RECEIVER"===e.message.messengerAppNotificationType;t?i.handleMessageReceived(e):r?i.handleMessageReadByReceiver(e):a&&i.handleMessageSilentRejection(e)}})},handleMessageReceived:function(e){if(void 0!==e.message.chiffre){var t=e.message.chiffre,a=$j('.contactItem[data-partner-user-id="'+t+'"]'),r=0<a.length,i=a.hasClass("is-active");0<$j("#messengerPage").length?r&&i?this.updateActiveContact(e,!0,t):!1!==r&&!1!==i||(jPar.app.messenger.contactArea.endlessScrolling.replaceContactWithDummyOnTopOfContactList(t),this.addTotalCounterPlusOne(t),jPar.app.messenger.contactArea.endlessScrolling.fillViewportWithContacts()):this.addTotalCounterPlusOne(t)}else jPar.util.log.error("PubNubError:","PubNubError: handleMessageReceived has no chiffre")},handleMessageSilentRejection:function(e){var t=void 0!==e.message.chiffre;if(0<$j("#messengerPage").length)if(t){var a=e.message.chiffre,r=$j('.contactItem[data-partner-user-id="'+a+'"]'),i=0<r.length,o=r.hasClass("is-active");i&&o?this.updateActiveContact(e,!1,a):i&&jPar.app.messenger.contactArea.updateContactItem(a)}else jPar.util.log.error("PubNubError:","PubNubError: handleMessageReceived has no chiffre")},updateActiveContact:function(a,e,r){var i=this;jPar.app.messenger.conversationArea.loadNewerMessages(function(){jPar.app.messenger.contactArea.endlessScrolling.updateContactlistForActiveContact(e).then(function(){i.specialCounterForActiveUser(a),i.showMessageReceivedAnimation({partnerUserId:r,contactIsActive:!0});var e="RECEIVED"===a.message.messengerAppNotificationType,t=0<$j("#messagesList .removeContact").length;e&&t&&jPar.app.messenger.conversationArea.loadMessageForActivePartner()})})},specialCounterForActiveUser:function(e){var t=e.message.messageId,a=e.message.chiffre;if(0<$j("#messagesList #msg_"+t).find(".is-blurredText").length)this.addTotalCounterPlusOne(a);else{var r=$j('.contactItem[data-partner-user-id="'+a+'"] .messageTextAndCount');0===r.find(".count").length&&r.append('<span class="count">1</span>')}},showMessageReceivedAnimation:function(e){0===$j('#messagesList [data-is-new-message="true"]').find(".is-blurredText").length&&$j('.contactItem[data-partner-user-id="'+e.partnerUserId+'"]').one("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(){$j(this).removeClass("has-newMessageReceived"),e.contactIsActive&&$j(this).find(".count").remove()}).addClass("has-newMessageReceived")},handleMessageReadByReceiver:function(e){var t=e.message.messageId;0<$j("#messengerPage").length&&(t?(0<$j("#contactList a[data-last-message-id="+t+"]").length?this.setMessageInContactsAsRead(t):this.notProcessedReadByReceiverId=t,0<$j("#messagesList #msg_"+t).length?this.setMessageInMessagelistAsRead(t):this.notProcessedReadByReceiverId=t):jPar.util.log.error("PubNubError:","PubNubError: handleMessageReadByReceiver has no messageId"))},setMessageInContactsAsRead:function(e){$j("#contactList a[data-last-message-id="+e+"]").find(".messageTextAndCount").removeClass("has-sentIcon").addClass("has-readByReceiverIcon")},setMessageInMessagelistAsRead:function(e){$j("#messagesList #msg_"+e).find(".metaInfos").removeClass("has-sentIcon").addClass("has-readByReceiverIcon")},processReadByReceiverForMessageList:function(){this.setMessageInMessagelistAsRead(this.notProcessedReadByReceiverId)},processReadByReceiverForContactList:function(){this.setMessageInContactsAsRead(this.notProcessedReadByReceiverId)},addTotalCounterPlusOne:function(e){document.querySelector("#conversationArea").dispatchEvent(new CustomEvent("messengerConversationArea:updateMessageCount",{detail:{partnerUserId:e,currentReadMessageCount:1}}))}}}),jPar.app=jPar.app||{},$j.extend(!0,jPar.app,{legalPages:{init:function(){var t=this;jPar.wdk.cardDeck.init(),this.regForm.init(),this.initTOC(),this.initSendMailToCustomerService(),this.helpAccordeon.init(),$j("#languageSelector").on("click",function(e){jPar.app.legalPages.languageSelector.switchLanguage(e)}),$j(".js-stopTracking").on("click",function(e){e.preventDefault(),t.setStopTrackingCookie()}),this.prepareUrlForWebapi(),this.iosAppTracking.init(),this.andrioidAppTracking.init()},andrioidAppTracking:{init:function(){0<$j("#androidAppTracking").length&&($j(".js-triggerAndroidAppTrackingOption").on("click",function(e){e.preventDefault(),jPar.util.log.devConsole("Android.openTrackingSettings.postMessage()");try{void 0!==Android&&void 0!==Android.showTrackingCheckbox&&!0===Android.showTrackingCheckbox()&&Android.openTrackingSettings()}catch(e){jPar.util.log.error(e,"Funktioniert nur innerhalb einer Android App")}}),$j(".js-toggleAppTrackingState").on("click",function(){var e=!0===$j(this).prop("checked");jPar.util.log.devConsole("Android.openTrackingSettings.postMessage(): "+e);try{void 0!==Android&&void 0!==Android.showTrackingCheckbox&&!0===Android.showTrackingCheckbox()&&(e?Android.trackingSwitchChanged(!0):Android.trackingSwitchChanged(!1))}catch(e){jPar.util.log.error(e,"Funktioniert nur innerhalb einer Android App")}}))}},iosAppTracking:{init:function(){0<$j("#iosAppTracking").length&&($j(".js-triggerIosAppTrackingOption").on("click",function(e){e.preventDefault(),jPar.util.log.devConsole("window.webkit.messageHandlers.openTrackingSettings.postMessage()"),void 0!==window.webkit&&void 0!==window.webkit.messageHandlers&&window.webkit.messageHandlers.openTrackingSettings.postMessage(null)}),$j(".js-toggleAppTrackingState").on("click",function(){var e=!0===$j(this).prop("checked");jPar.util.log.devConsole("window.webkit.messageHandlers.trackingSwitchChanged.postMessage: "+e),void 0!==window.webkit&&void 0!==window.webkit.messageHandlers&&(e?window.webkit.messageHandlers.trackingSwitchChanged.postMessage(!0):window.webkit.messageHandlers.trackingSwitchChanged.postMessage(!1))}))},setTrackingSwitchEnabled:function(e){!0===e?$j(".js-toggleAppTrackingState").prop("checked",!0):!1===e&&$j(".js-toggleAppTrackingState").prop("checked",!1)}},initTOC:function(){$j('#content a[href*="#"]:not([href="#"])').on("click",function(e){var t=$j(this.hash);if(t.length){e.preventDefault();var a=jPar.wdk.screensize.isBreakpoint(["S","M"])?40:100;jPar.util.scrollToElement(t,-a)}})},initSendMailToCustomerService:function(){$j(".js-sendMailToCustomerService").on("click",function(e){e.preventDefault();var t=$j(".js-sendMailToCustomerService").data("mailto"),a=$j(".js-sendMailToCustomerService").data("subject"),r=$j("#aboutUsPage .legalTextBox").data("chiffre");0===r.length?window.location.href="mailto:"+t+"?subject="+a:window.location.href="mailto:"+t+"?subject="+a+" - "+r})},setStopTrackingCookie:function(){var e=new Date,t=new Date(e.getTime()+15768e7),a=document.location.host,r=a.lastIndexOf("parship"),i=a.substring(r,a.length);document.cookie="tfvEnabled=true; expires="+t.toGMTString()+"; domain=."+i+";path=/",null!==getCookie("tfvEnabled")?jPar.wdk.toast.show("#tfvEnabledNotification"):jPar.wdk.modalbox.show({modalboxId:"errorModalbox500"})},prepareUrlForWebapi:function(){0<$j(".isInApp").length&&$j.each($j('a[href$="/privacypolicy"]'),function(){var e=$j(this).attr("href");e+="?app=true",$j(this).attr("href",e)})},helpAccordeon:{init:function(){var e=this;$j(".helpAccordeon .helpSection h3").on("click",function(){e.openHelpSection($j(this).parents(".helpSection"))})},openHelpSection:function(e){if(e.hasClass("active"))e.removeClass("active"),e.find(".helpSectionContent").slideUp(400);else{var t=$j(".helpAccordeon .helpSection.active");t.find(".helpSectionContent").slideUp(400),t.removeClass("active"),e.addClass("active"),e.find(".helpSectionContent").slideDown(400)}}}}}),$j.extend(!0,jPar.app.legalPages,{languageSelector:{switchLanguage:function(e){e.stopPropagation();var t=$j("#languageBox");t.hasClass("show")&&!$j(e.target).parents("#languageBox").length?(t.removeClass("show"),t.fadeOut(),$j("body, #formWrapper").off("click.languageBox")):(t.addClass("show"),t.fadeIn(),$j("body, #formWrapper").on("click.languageBox",function(e){$j(e.target).is("#languageBox")||$j(e.target).parents("#languageBox").length||(t.removeClass("show"),t.fadeOut(),$j("body, #formWrapper").off("click.languageBox"))}))}}}),jPar.app=jPar.app||{},jPar.app.legalPages=jPar.app.legalPages||{},$j.extend(!0,jPar.app.legalPages,{regForm:{orientationPermissionEnabled:!1,init:function(){var e=this;0<$j("#regFormCard").length&&(jPar.wdk.forms.init(),this.toggleEmailNoticeBox(),jPar.wdk.passwordRestrictionBox.init(),this.orientationPermission.init(),$j("#regFormCard input[type=radio]").on("change.preselectEsSex",function(){e.handleSex($j(this))}),this.submit.init())},handleSex:function(e){var t=this;jPar.wdk.brands.forBrands(["ps","ep"])?(t.preselectEsSex(e),$j("#regFormCard input[type=radio]").off(".preselectEsSex"),this.submit.validateMysexEssex(),$j('#regFormCard #mysexEssexRow input[type="radio"]').on("change",function(){t.submit.validateMysexEssex()})):t.validateEsSex(),t.orientationPermissionEnabled&&t.orientationPermission.showOrientationPermissionText()},validateEsSex:function(){2===$j("form input[type=radio]:checked").length&&jPar.wdk.forms.hideError($j("#regsexError"))},toggleEmailNoticeBox:function(){var e=$j("#regFormCard #regFormEmail"),t=$j("#regFormCard #emailNoticeBox");e.on("focus",function(){t.fadeIn(400)}),e.on("blur",function(){t.fadeOut(400)})},preselectEsSex:function(e){var t=e.attr("name"),a=e.val(),r=$j("#regFormCard form");"mysex"===t?"1"===a&&r.is(".gay")||"0"===a&&r.is(".hetero")?r.find("#essexW").prop("checked",!0):r.find("#essexM").prop("checked",!0):"1"===a&&r.is(".gay")||"0"===a&&r.is(".hetero")?r.find("#mysexW").prop("checked",!0):r.find("#mysexM").prop("checked",!0)},orientationPermission:{init:function(){if("undefined"!=typeof pegExternalModifier){var t=this;$j(document).on("orientationPermission-status",function(e){e.detail.isEnabled&&t.enableOrientationPermission(e.detail.checkboxText)}),pegExternalModifier.orientationPermission.init()}else jPar.util.log.error("orientationPermission","pegExternalModifier is not defined on domLoaded")},enableOrientationPermission:function(e){jPar.app.legalPages.regForm.orientationPermissionEnabled=!0,this.setEventlistener(),$j("#orientationPermission p").html(e),$j('#orientationPermission input[name="consentToStoreSexualOrientation"]').prop("value",!0),$j("#regFormCard form").removeClass("is-formWithoutSteps").addClass("is-step1Visible")},setEventlistener:function(){var t=this;$j("#regFormCard #gotoNextStep a").on("click",function(e){e.preventDefault(),jPar.app.legalPages.regForm.submit.validateMysexEssex(),!1===jPar.app.legalPages.regForm.submit.formHasErrors()&&t.showOrientationPermissionText()}),$j("#regFormCard #gotoLastStep a").on("click",function(e){e.preventDefault(),t.showLoginDataStep()})},showOrientationPermissionText:function(){$j("#regFormCard form").removeClass("is-step1Visible").addClass("is-step2Visible")},showLoginDataStep:function(){jPar.app.legalPages.regForm.submit.validateMysexEssex(),!1===jPar.app.legalPages.regForm.submit.formHasErrors()&&$j("#regFormCard form").removeClass("is-step1Visible is-step2Visible").addClass("is-step3Visible")}},submit:{init:function(){var t=this,e=$j("#regFormCard form");e.on("submit",function(e){t.validateAll(),t.formHasErrors()&&e.preventDefault()}),e.find("#regFormEmail").on("keyup change",function(){$j("#regEmailError").hasClass("is-visible")&&t.validateEmail()}),e.find("#regFormPassword").on("focus",function(){var e=$j("#regPasswordEmptyError"),t=$j("#regPasswordNotValidError");jPar.wdk.forms.hideError(e),jPar.wdk.forms.hideError(t)})},validateAll:function(){this.validateMysexEssex(),this.validateEmail(),this.validatePassword()},validateMysexEssex:function(){var e=jPar.util.validate.radioIsSelected($j('input[name="mysex"]')),t=jPar.util.validate.radioIsSelected($j('input[name="essex"]')),a=$j("#regsexError");!1===e||!1===t?jPar.wdk.forms.showError(a):jPar.wdk.forms.hideError(a)},validateEmail:function(){var e=$j("#regEmailError");!1===jPar.util.validate.isEmailAddress($j("#regFormEmail"))?jPar.wdk.forms.showError(e):jPar.wdk.forms.hideError(e)},validatePassword:function(){var e=$j("#regFormPassword"),t=$j("#regPasswordEmptyError"),a=$j("#regPasswordNotValidError");jPar.util.validate.textfieldIsEmpty(e)?jPar.wdk.forms.showError(t):(jPar.wdk.forms.hideError(t),jPar.wdk.passwordRestrictionBox.checkPasswordRestrictions(),!1===jPar.wdk.passwordRestrictionBox.isPasswordValid()?jPar.wdk.forms.showError(a):jPar.wdk.forms.hideError(a))},formHasErrors:function(){return jPar.wdk.forms.hasVisibleErrors($j("#regFormCard"))}}}});